# Security Control Inventory

| Control ID | Description | Implementation | Test Coverage | Doc Reference |
|------------|-------------|----------------|---------------|---------------|
| SEC-001 | Spreadsheet formula sanitisation for CSV/Excel outputs | `src/elspeth/plugins/outputs/_sanitize.py`, `src/elspeth/plugins/outputs/csv_file.py` | `tests/test_sanitize_utils.py`, `tests/test_outputs_csv.py`, `tests/test_outputs_excel.py` | `docs/architecture/security-controls.md` §Update 2025-10-12: Output Sanitisation |
| SEC-002 | Prompt shielding middleware to block or mask disallowed terms | `src/elspeth/plugins/llms/middleware.py` (`PromptShieldMiddleware`) | `tests/test_llm_middleware.py` | `docs/architecture/security-controls.md` §Update 2025-10-12: Middleware Safeguards |
| SEC-003 | Azure Content Safety screening with configurable severity handling | `src/elspeth/plugins/llms/middleware.py` (`AzureContentSafetyMiddleware`) | `tests/test_llm_middleware.py` | `docs/architecture/security-controls.md` §Update 2025-10-12: Middleware Safeguards |
| SEC-004 | Azure ML telemetry logging (requests, retries, baseline diffs) | `src/elspeth/plugins/llms/middleware_azure.py` | `tests/test_llm_middleware.py`, `tests/test_suite_runner_integration.py` | `docs/architecture/audit-logging.md` §Update 2025-10-12: Azure Telemetry |
| SEC-005 | HMAC signing of bundled artifacts with manifest metadata | `src/elspeth/plugins/outputs/signed.py`, `src/elspeth/core/security/signing.py` | `tests/test_outputs_signed.py`, `tests/test_security_signing.py` | `docs/architecture/security-controls.md` §Update 2025-10-12: Artifact Signing |
| SEC-006 | Artifact dependency ordering and security-level enforcement | `src/elspeth/core/pipeline/artifact_pipeline.py` | `tests/test_artifact_pipeline.py`, `tests/test_sink_chaining.py` | `docs/architecture/architecture-overview.md`, `docs/architecture/security-controls.md` §Update 2025-10-12: Artifact Clearance |
| SEC-007 | Adaptive rate limiting and utilisation-based throttling | `src/elspeth/core/controls/rate_limit.py`, `src/elspeth/core/controls/registry.py` | `tests/test_controls.py`, `tests/test_controls_registry.py`, `tests/test_experiments.py` | `docs/architecture/security-controls.md` §Rate Limiting & Cost Controls |
| SEC-008 | Threshold-based early-stop governance | `src/elspeth/plugins/experiments/early_stop.py`, `src/elspeth/core/experiments/runner.py` | `tests/test_experiment_runner_integration.py`, `tests/test_suite_runner_integration.py` | `docs/architecture/security-controls.md` §Retry, Error Handling & Observability |
| SEC-009 | Analytics reporting sink capturing retry/cost/baseline evidence | `src/elspeth/plugins/outputs/analytics_report.py` | `tests/test_outputs_analytics_report.py`, `tests/test_suite_reporter.py` | `docs/architecture/audit-logging.md` §Added 2025-10-12 – Extended Telemetry Streams, `docs/architecture/security-controls.md` §Rate Limiting & Cost Controls |
| SEC-010 | Configuration validation and preflight enforcement | `src/elspeth/core/validation/validators.py`, `src/elspeth/core/config/schema.py` | `tests/test_validation_settings.py`, `tests/test_validation_suite.py` | `docs/architecture/configuration-security.md` §Update 2025-10-12: Loader Safeguards, `docs/architecture/security-controls.md` §Input Validation |
| SEC-011 | Visual analytics artifacts rendered as self-contained PNG/HTML with embedded metadata | `src/elspeth/plugins/outputs/visual_report.py` | `tests/test_outputs_visual.py` | `docs/architecture/security-controls.md` §Update 2025-10-12: Output Sanitisation, `docs/reporting-and-suite-management.md` §Update 2025-10-12: Visual Analytics Sink |
| SEC-012 | Azure Environment middleware logging suite inventories, baseline comparisons, and retry exhaustion events | `src/elspeth/plugins/llms/middleware_azure.py` | `tests/test_llm_middleware.py`, `tests/test_suite_runner_integration.py` | `docs/architecture/audit-logging.md` §Update 2025-10-12: Azure Telemetry, `docs/architecture/security-controls.md` §Update 2025-10-12: Middleware Safeguards |

## Update History
- 2025-10-12 – Update 2025-10-12: Refreshed control references to new documentation sections and added Azure Environment telemetry control entry.
