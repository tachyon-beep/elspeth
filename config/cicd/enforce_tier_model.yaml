version: 1
defaults:
  fail_on_stale: true
  fail_on_expired: true
per_file_rules:
- pattern: contracts/schema.py
  rules:
  - R1
  - R5
  reason: SchemaConfig.from_dict() parses user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: contracts/contract_records.py
  rules:
  - R5
  reason: Violation type dispatch requires isinstance() for polymorphic serialization of ContractViolation subclasses
  expires: null
- pattern: contracts/type_normalization.py
  rules:
  - R5
  reason: Type normalization requires isinstance() for polymorphic serialization of numeric types
  expires: null
- pattern: cli.py
  rules:
  - R1
  - R3
  - R4
  - R5
  - R6
  reason: CLI handles user input, env vars, and external system checks (Tier 3)
  expires: null
- pattern: mcp/server.py
  rules:
  - R1
  reason: MCP tool arguments are external client data (Tier 3) - defensive access is correct
  expires: null
- pattern: plugins/sources/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Source plugins ingest external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/config_base.py
  rules:
  - R1
  - R5
  reason: Plugin config parsing handles user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: plugins/llm/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: LLM API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/azure/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Azure API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: telemetry/exporters/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Telemetry services are external (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: engine/expression_parser.py
  rules:
  - R5
  reason: AST-based expression parser requires isinstance() for node type dispatch - fundamental to safe expression evaluation
  expires: null
- pattern: core/templates.py
  rules:
  - R5
  reason: Jinja2 template AST walker requires isinstance() for node type traversal - fundamental to field extraction
  expires: null
- pattern: core/config.py
  rules:
  - R1
  - R5
  - R6
  reason: Configuration loading parses user YAML (Tier 3) - defensive type checking and optional field access required
  expires: null
- pattern: core/security/*
  rules:
  - R1
  reason: Security utilities access optional environment variables (Tier 3) - defensive access for missing keys
  expires: null
allow_hits:
- key: core/landscape/_node_state_recording.py:R5:NodeStateRecordingMixin:complete_node_state:fp=449fbf004664406f
  owner: architecture
  reason: Type narrowing after DB update - discriminated union requires isinstance to verify terminal state
  safety: Raises AuditIntegrityError if wrong state - explicit failure, not masking
  expires: null
- key: core/landscape/_error_recording.py:R6:ErrorRecordingMixin:record_validation_error:fp=4f08618bc36aa9af
  owner: architecture
  reason: Tier-3 boundary - row_data may contain NaN/Infinity which are not canonically serializable
  safety: Falls back to repr() with logging - audit trail preserved with metadata
  expires: null
- key: contracts/schema_contract_factory.py:R1:create_contract_from_config:fp=0fe7a31adc9f24b3
  owner: feature
  reason: Intentional identity fallback - fields without resolution mapping use normalized name as original name
  safety: Fallback to same value is correct behavior, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:record_accept:fp=a183521ba11a8ee6
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:should_trigger:fp=bac17c66d1886d99
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/executors.py:R4:SinkExecutor:write:fp=201686a0f89ee0a3
  owner: architecture
  reason: 'Post-durability callbacks: checkpoint callback fails after durable sink write'
  safety: Logged with error - sink artifact exists but checkpoint failed, resume will replay
  expires: null
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=fb2d667d2fd74891
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/url.py:R6:SanitizedWebhookUrl:from_raw_url:fp=d1d4c7a6b6f8a842
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R6:_normalize_value:fp=8ef8fcd777ae4ddf
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=2cb2abe67276b404
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=55f64c33dbec338e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R6:AuditedHTTPClient:_filter_request_headers:fp=c5c171afc5be7b56
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/rate_limit/limiter.py:R6:RateLimiter:try_acquire:fp=b1dd92e33abe1b6f
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/metrics.py:R7:MetricsRecorder:close:fp=cae006971eb80032
  owner: architecture
  reason: Suppressing ProgrammingError on already-closed connections during shutdown
  safety: Connection objects may be closed by their owning thread before close() runs
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R6:_find_metrics_databases:fp=2bcfbfc1388cd9d8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: cli_helpers.py:R2:instantiate_plugins_from_config:fp=fd01cc3b45761df9
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=c5f4c4f695cabe87
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=3125065ec11fe578
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R5:RowWaiter:wait:fp=98c907e643e5e178
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:_get_batch_adapter:fp=52906cd002ae2775
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:_get_batch_adapter:fp=1887f62f9cbff678
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:execute_transform:fp=7ca704465d0c2661
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=3c2fc1b9b9bf76c6
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=f90bccc331c84a40
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=54c52809564ace0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=53b05808daecec9e
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=413111018c707c54
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_rows:fp=00745130c0fe339a
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_tokens:fp=1888089faaecfe0a
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=0c505357d01d10fb
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=57f6b998f618a29b
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffer_count:fp=d428978c93102fa2
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:fp=e51db81b7a4d271e
  owner: P2-2026-02-02
  reason: Pattern is .get() followed by explicit None check raising RuntimeError
  safety: RuntimeError raised immediately if batch_id is None - explicit failure, not silent
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:fp=a65001cca6850efe
  owner: P2-2026-02-02
  reason: Version check for checkpoint format - None from missing key triggers ValueError
  safety: ValueError raised for missing or wrong version - explicit validation pattern
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_batch_id:fp=38f4b68e63998042
  owner: P2-2026-02-02
  reason: Testing/inspection method that needs to work with partial setups; returns None if no batch exists
  safety: Documented as "primarily for testing" - production uses checkpoint state
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_restored_state:fp=8627e66761644859
  owner: P2-2026-02-02
  reason: Checkpoint recovery lookup - returns None if no state was restored for node
  safety: Designed API contract - None is valid return for nodes without restored state
  expires: null
- key: engine/executors.py:R5:AggregationExecutor:restore_from_checkpoint:fp=22da0f93e716feaf
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=864f8798598aa264
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=3817cd2e5ac65a61
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=a300ae0fe73eeee2
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=ac3b6fcee8eeed57
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=411616af5f2ca497
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=932619974f1d8566
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/validation.py:R5:validate_route_destinations:fp=b681c5049ba16d78
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access correct attributes
  safety: isinstance() check selects code path for GateProtocol-specific name lookup; no bug hiding
  expires: '2026-05-02'
- key: engine/orchestrator/validation.py:R5:validate_transform_error_sinks:fp=3f2acca1f0db538b
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish for _on_error access
  safety: isinstance() check selects code path for TransformProtocol-specific attributes; no bug hiding
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=b85d02518fc6a7b8
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: isinstance() check selects code path for TransformProtocol-specific attributes; no bug hiding
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=676ffdfd58f8b374
  owner: architecture
  reason: Tier 3 boundary - quarantine path handles non-dict source rows (e.g. malformed CSV lines)
  safety: 'isinstance() coerces external source data at trust boundary; wraps non-dict in {_raw: ...} for audit'
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R5:Orchestrator:_process_resumed_rows:fp=890f3742684b0465
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: isinstance() check selects code path for TransformProtocol-specific attributes; no bug hiding
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=e45664affb8b9f5c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=7817e2533f29b3b3
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_drain_work_queue:fp=8d67892f8bcf88cd
  owner: architecture
  reason: Type dispatch on _process_single_token return (RowResult | list[RowResult] | None)
  safety: isinstance() discriminates documented union return type; no bug hiding
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=302e2e66d8f5696b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=7de2e8bd8e5f0b4f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/processor.py:R1:RowProcessor:_notify_coalesce_of_lost_branch:fp=fc6941785707f946
  owner: architecture
  reason: dict.get() is correct - not all branch names have a coalesce point mapping; returns None for non-coalescing branches
  safety: None return triggers early exit, no silent fallback
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_export_loop:fp=a8166fc10299a912
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:_export_loop:fp=d0ce3c8d47c10203
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_export_loop:fp=43b9fc24d17edf57
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_dispatch_to_exporters:fp=205648209571e6bf
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_dispatch_to_exporters:fp=7df5bc18c458067b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=b0eb5eeb6c39c018
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=4f85d27ac43efe91
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:flush:fp=2bd83495c312d0cc
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=2b852f9149cdfce5
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:close:fp=0fc8092d4e145c14
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R1:validate_row:fp=0f6fa60e1ef14cec
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R3:_type_name:fp=e5ac6075b25c4cd5
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R5:_is_union_type:fp=0cfbacff868ef7c0
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/transform_contract.py:R5:_is_union_type:fp=a9ba219b5d0e0a54
  owner: architecture
  reason: Type annotation introspection - required to detect Union/Optional types
  safety: Code reviewed - same pattern as data.py:_is_union_type
  expires: '2026-05-02'
- key: contracts/audit.py:R5:_validate_enum:fp=f48a15b1272c5363
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/audit.py:R5:TokenOutcome:__post_init__:fp=14670c8c83113873
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R9:_discover_in_file:fp=77f2deccecaa5aea
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:_discover_in_file:fp=f42969a5d77096b3
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:get_plugin_description:fp=0806b3aad609f380
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/base.py:R1:BaseGate:__init__:fp=d557713317a8b557
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/utils.py:R5:get_nested_field:fp=65234e1b71a7a0fc
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_source_config:fp=3bd8f6558f2b54b2
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_transform_config:fp=b60f09b21ed871b6
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/events.py:R1:EventBus:emit:fp=9291c1b6dd51107b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=735ac69d4aadbe9f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=136394dfb22a90ee
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R6:extract_jinja2_fields_with_names:fp=f6a3eb1805fd5f66
  owner: architecture
  reason: Contract resolution attempt - KeyError means field not in contract, handled as unresolved
  safety: Returns explicit resolved=False state, never silently drops - legitimate boundary handling
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=b40305f2a4c95243
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=d097732d7e19e600
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=a07e49d3a99eb425
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=d273c00e914f4675
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=25263724f0ed5aa5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=36ee3c1a855d74b5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=2eec034d080cdca1
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=2fc596ea6a6d848c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=a33b825cdbdf307b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=5d42d4dc61674323
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=848a6c78692ac91c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_for_canonical:fp=67673a677c3127f2
  owner: P1-2026-02-05-typecheck
  reason: PipelineRow type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required to convert PipelineRow to dict for RFC8785 compliance
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=6528210ee55b1344
  owner: P1-2026-02-05-typecheck
  reason: Dict type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=08b99fa8c7162ddb
  owner: P1-2026-02-05-typecheck
  reason: List/tuple type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=6d388e3fcd965f6e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=d2118151a6b5f1ac
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=ca79520b4ff39c0a
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=05c1490e2d921cbc
  owner: architecture
  reason: Framework-boundary type narrowing — transforms list contains both TransformProtocol and GateProtocol instances despite type annotation. GateProtocol does not define _on_error, so isinstance is
    required to skip gates when adding divert edges.
  safety: Gates skipped cleanly — only TransformProtocol instances get _on_error checked
  expires: '2026-05-06'
- key: core/dag.py:R1:ExecutionGraph:warn_divert_coalesce_interactions:fp=c81c02216396a4c0
  owner: architecture
  reason: NetworkX edge data dict access — framework boundary, not our Pydantic model
  safety: All edges have label attribute (set by add_edge); non-fatal warning method
  expires: '2026-05-06'
- key: core/dag.py:R1:ExecutionGraph:warn_divert_coalesce_interactions:fp=90bcaf3308b04c54
  owner: architecture
  reason: Coalesce name may not exist in graph if config references invalid name
  safety: Returns None and skips gracefully; non-fatal warning method
  expires: '2026-05-06'
- key: core/dag.py:R1:ExecutionGraph:warn_divert_coalesce_interactions:fp=e954b8a1e024cb9c
  owner: architecture
  reason: NetworkX edge data dict access — framework boundary, not our Pydantic model
  safety: All edges have label attribute; non-fatal warning method
  expires: '2026-05-06'
- key: core/dag.py:R6:ExecutionGraph:warn_divert_coalesce_interactions:fp=346633e1a338aa9e
  owner: architecture
  reason: Expected control flow — gate may not be reachable from coalesce on spine subgraph
  safety: NetworkXNoPath is expected outcome of shortest_path; skips gracefully
  expires: '2026-05-06'
- key: core/dag.py:R1:ExecutionGraph:_get_schema_config_from_node:fp=a18d11bcb212bdda
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R5:ExecutionGraph:_get_schema_config_from_node:fp=cba6088fa71ace2d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R1:ExecutionGraph:_get_required_fields:fp=d244c5a98fc1ec95
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/dag.py:R5:ExecutionGraph:_get_required_fields:fp=7f047273b9464f6c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=799383f3318c92d0
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=805b2168b55f994d
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=45d7f91fa3e95728
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=da53fb5f17aab8ee
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=0d867cb3140ddc37
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=0725e49f88fcd8cc
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:ErrorInjectionConfig:parse_range:fp=2657656f67c463e5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:load_preset:fp=f06b9c172dbf8e15
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:_deep_merge:fp=62cd2711bdcee5fd
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:_deep_merge:fp=771fcc2b1f364873
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R5:PresetBank:from_jsonl:fp=a86816a07f74c3f6
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=319727597ad71ac9
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=e27542ac4ab46102
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=0fa0eec2f5837ed3
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=d04051587b9b4e1c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=216d32a283dd211a
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=ae7b944c3352fb61
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=7032350ebd1e2d01
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=0edfa9b30664cb15
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=fb007fb57e761ed1
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=3e5f449fe83d3c46
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=b8f580c3d8818c70
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=8bd668fa1c1402bd
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/cli.py:R6:_version_callback:fp=e2b51655e4d22702
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/cli.py:R6:show_config:fp=ed8499ffbc8fd80e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R1:create_server:call_tool:fp=e1b2cc34d0a57eea
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R4:create_server:call_tool:fp=e2c9b6f8afcfe19a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/_helpers.py:R5:coerce_enum:fp=7aabb8ce0df1d1fd
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=8565df78b19e294d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=a2f12ee54e9a5c94
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=defdcd762186d8cf
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=ecef37c8d956459c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=4183ff6b263eafc5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=e8f56396e9180b8a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=9ad878d6e0a07d07
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=3473fbeb60dce788
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=99034a7ce01af9db
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=2045980afb19da73
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=7323a806122add1b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/database_sink.py:R1:DatabaseSink:__init__:fp=cb728c1a23ed45e2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/json_sink.py:R5:JSONSink:validate_output_target:fp=8dc25260f8a13296
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/batch_replicate.py:R5:BatchReplicate:process:fp=f513c50d96f3295a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:process:fp=9160e4e0b95ed5e8
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=af2344f0f0f5938f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=840bd57450114a00
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=bc395c6a768847b9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=ae444b17b823e17a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/json_explode.py:R5:JSONExplode:process:fp=cf5a7341961534e0
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_normalization_collisions:fp=5d89837a5521627f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_mapping_collisions:fp=a1371511b3dee8c6
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=923431e7c7c800eb
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=bbe24a28f3c7d484
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_process_and_complete:fp=dc75c0a50ecb9961
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=e4406b514a797107
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=a85655eb9d5dce08
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:_release_loop:fp=eccdfd781f52ed76
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=e05a82665f12ff8a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=68ee805887eb3173
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:evict_submission:fp=9e733ee9d7f79f4f
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_filter_request_headers:fp=8c35c9e302cece59
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=5bdbfe7db9e32163
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=695415b2ec4d8fee
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R9:AzureContentSafety:_process_row:fp=b18b4272385d82ff
  owner: architecture
  reason: Cleanup/pop with default — HTTP client cleanup may race with error paths
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_process_single_with_state:fp=8404ee8567c3b226
  owner: architecture
  reason: Tier 3 boundary — validates row field is str before sending to Azure API
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=9bb006a32eb07a28
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for content scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=1617ec4ae04857b6
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for content scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R1:AzureContentSafety:_analyze_content:fp=9cbec0737e033ad0
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure API response to check unknown categories
  safety: Unknown categories logged, only mapped categories used. MalformedResponseError raised if expected categories missing.
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_analyze_content:fp=132e9c8653a9a14b
  owner: architecture
  reason: Tier 3 boundary — validates severity type from Azure API response is int
  safety: MalformedResponseError raised if type wrong, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R9:AzurePromptShield:_process_row:fp=5555041200ea3e5a
  owner: architecture
  reason: Cleanup/pop with default — HTTP client cleanup may race with error paths
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_process_single_with_state:fp=69fe83d9ba6aa6e9
  owner: architecture
  reason: Tier 3 boundary — validates row field is str before sending to Azure API
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=6756f72f855a6bcf
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=71955a9599f4811d
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=5ebfe1bb3a77f354
  owner: architecture
  reason: Tier 3 boundary — validates Azure response structure before parsing
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=ec7bffed1b84a52f
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure API response to extract userPromptAnalysis
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=9e2efc70e9c2a9dc
  owner: architecture
  reason: Tier 3 boundary — validates userPromptAnalysis is dict from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=3b3f342da93a70a8
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure response to extract attackDetected field
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=c841d2c305e52b38
  owner: architecture
  reason: Tier 3 boundary — validates attackDetected is bool from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=40253c1ac93c9dee
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure response to extract documentsAnalysis
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=f580cd433ba3ceaa
  owner: architecture
  reason: Tier 3 boundary — validates documentsAnalysis is list from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=7253081edf54b8ad
  owner: architecture
  reason: Tier 3 boundary — validates each document entry is dict from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=6fc4cb2a3c9fe209
  owner: architecture
  reason: Tier 3 boundary — .get() on document dict to extract attackDetected
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=decde02c66d672a3
  owner: architecture
  reason: Tier 3 boundary — validates document attackDetected is bool from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R6:ExplainScreen:_load_node_state:fp=ea0af175990905a8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:load:fp=2c2f53eeaf62b1aa
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:retry:fp=aaa04b3313221b0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=efa021de94ac3b1f
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=c487c413733875f2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d83a6cacd8813583
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=561bead45d07791c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=b9a8fe28fc3a2a35
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=db3f916fb4b5df04
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f86a38f7c1fdf563
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=e0e83f67901e3bc7
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=2fe3f91f56f42b8c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=ab6e5fba4141cf4d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d1f89dde14fd37d2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=a6f1d850a7f12c4f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=4689219565e309cc
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=6eefee9df94392dd
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f40067b280807118
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a4ecc4a0cc77230c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=872b14cd5cb8103d
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=675ba5371c46f70a
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=03b59094c0a9934c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=2fe98f01ca3be04d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a105e6d08eb1e3b9
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/results.py:R5:ArtifactDescriptor:for_database:fp=58a69ae36bfd1f89
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedDatabaseUrl to prevent credentials leaking to audit trail
  safety: Raises explicit TypeError with guidance; prevents security bypass via duck-typed objects
  expires: null
- key: contracts/results.py:R5:ArtifactDescriptor:for_webhook:fp=2598c89700a4b6b1
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedWebhookUrl to prevent tokens leaking to audit trail
  safety: Raises explicit TypeError with guidance; prevents security bypass via duck-typed objects
  expires: null
- key: core/security/secret_loader.py:R6:CompositeSecretLoader:get_secret:fp=8846ddf2a85396bb
  owner: bugfix
  reason: Intentional fallback pattern - CompositeSecretLoader tries loaders in priority order
  safety: SecretNotFoundError from one loader triggers fallback to next; raises if all fail
  expires: null
- key: core/security/secret_loader.py:R6:KeyVaultSecretLoader:get_secret:fp=0c397e0294f3db17
  owner: bugfix
  reason: Sentinel class definition in except ImportError — not a runtime error handler
  safety: _get_client() raises ImportError before any Azure API call; sentinel class is never caught
  expires: null
- key: engine/executors.py:R1:GateExecutor:execute_gate:fp=4107d16f9b5cfad7
  owner: bugfix
  reason: Configuration validation - checking if route label exists in route_resolution_map (line shift from PipelineRow migration)
  safety: Returns None which is explicitly handled - raises MissingEdgeError with proper node_state completion
  expires: null
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=d653bcd4e15d02a2
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Code reviewed - legitimate pattern; else branch handles unexpected types via str() conversion
  expires: '2026-05-02'
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=e8e81319208e59ea
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Code reviewed - legitimate pattern; else branch handles unexpected types via str() conversion
  expires: '2026-05-02'
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=6da358fbc674d735
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=88448fd740364e24
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=4134c33898370a29
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=0a516787233a14be
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=1e6dc332e2ef9699
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=ecfef5a461fab47d
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=efa2d1bce6b292b8
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=858ee1fdd29fc79a
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=7c53c74396aa56f7
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=2c0f051f0c37248d
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.exists() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=e172162bc1808ed8
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.delete() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=cb8f391ad82b21df
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=6b5b01f9759184f2
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=a223631a490eb6ac
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=dfb4bbba26b7416f
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=ac644329fadcf3b7
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=e9f28518296c9c5a
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_open_file:fp=529df26a8624a42d
  owner: feature
  reason: Intentional fallback - reverse mapping may not contain all fields (transform-added)
  safety: Falls back to original field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_get_field_names_and_display:fp=688e26cbcb3aa309
  owner: feature
  reason: Intentional fallback - display mapping may not contain all fields (transform-added)
  safety: Falls back to normalized field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:validate_output_target:fp=4f8918e243e34a1a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:validate_output_target:fp=11a12d24c049f460
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:_apply_display_headers:fp=c5e1158dff11755a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: contracts/header_modes.py:R5:parse_header_mode:fp=dc93452b5432e8a4
  owner: feature
  reason: Config parsing - config value from YAML is Tier 3 external data; isinstance() distinguishes string from dict
  safety: ValueError raised for invalid config - explicit validation failure
  expires: null
- key: contracts/contract_propagation.py:R6:propagate_contract:fp=fbcdf96127213894
  owner: architecture
  reason: Type narrowing failure is silently skipped - non-primitive types aren't included in contract
  safety: Field continues in data without contract tracking - intentional behavior
  expires: null
- key: contracts/contract_propagation.py:R6:narrow_contract_to_output:fp=b2e116f9ad91bb8f
  owner: architecture
  reason: Type resolution errors are logged and field is excluded from narrowed contract
  safety: Contract narrowing continues without failed field - explicit logging
  expires: null
- key: contracts/contract_propagation.py:R1:merge_contract_with_output:fp=b77bb8f4e1cd3d1d
  owner: architecture
  reason: Optional lookup for original name - new fields from transforms may not have input mapping
  safety: Fallback to output field's original_name is correct behavior for transform-added fields
  expires: null
- key: engine/orchestrator/aggregation.py:R5:find_aggregation_transform:fp=d2da84f2bce50af4
  owner: refactor
  reason: isinstance() check required to find batch-aware transforms - protocol contract verification
  safety: RuntimeError raised if no matching transform found - explicit failure, not silent
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=76eb122944753b45
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Missing type handled by subsequent "type" in item check; falls through to error
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=ff1b7e567dcc1a55
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Filters items by type != "null"; items without type are correctly excluded
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=117a3e0e68aa409d
  owner: bugfix
  reason: JSON Schema "format" field is optional per spec - external data at trust boundary
  safety: Missing format defaults to None, falls through to plain str return - correct behavior
  expires: null
- key: engine/tokens.py:R5:TokenManager:create_quarantine_token:fp=9d7a59ec5d3f6186
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check converts PipelineRow to dict for audit trail consistency
  expires: null
- key: plugins/transforms/batch_stats.py:R5:BatchStats:process:fp=32173d2b108569cc
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check required to handle union type from batch processing
  expires: null
- key: engine/executors.py:R5:TransformExecutor:execute_transform:_to_dict:fp=6ef2582894e98372
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check converts PipelineRow to dict for transform output
  expires: null
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=3e656c030c37dc73
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - list vs single row discrimination after mypy typecheck fixes
  safety: isinstance() check handles union type from transform output
  expires: null
- key: engine/executors.py:R5:AggregationExecutor:execute_flush:_to_dict_agg:fp=6843639153ff7b09
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check converts PipelineRow to dict for aggregation output
  expires: null
- key: engine/executors.py:R5:AggregationExecutor:execute_flush:fp=a4dfab975966217a
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - list vs single row discrimination after mypy typecheck fixes
  safety: isinstance() check handles union type from aggregation output
  expires: null
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=80f4b2eb31815f95
  owner: P1-2026-02-05-schema-evolution
  reason: Internal boundary - PipelineRow vs dict discrimination for contract propagation
  safety: isinstance() converts PipelineRow to dict for propagate_contract() call
  expires: null
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=c38a7ce82fed6778
  owner: P1-2026-02-05-schema-evolution
  reason: Internal boundary - PipelineRow vs dict discrimination for token update
  safety: isinstance() converts PipelineRow to dict when creating new token
  expires: null
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=9370a8f4d789c2c1
  owner: architecture
  reason: isinstance() on float to detect NaN/Infinity in JSON - type discrimination for serialization
  safety: Rejects non-finite values that would break RFC 8785 canonicalization
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=cbbbfa89308db09a
  owner: architecture
  reason: isinstance() on dict for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=4a5b03bd164d53bf
  owner: architecture
  reason: isinstance() on list for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/transforms/web_scrape.py:R1:WebScrapeTransform:__init__:fp=6b27daeff28c2216
  owner: architecture
  reason: User YAML config boundary - http_config is parsed from pipeline settings
  safety: Defaults to 30s timeout - safe fallback for optional config field
  expires: '2026-05-02'
- key: engine/processor.py:R5:_extract_dict:fp=f5a5a4fa3692668f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=cb0249f88d0d6cda
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/checkpoint.py:R5:ResumePoint:__post_init__:fp=06723188787bab6d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/results.py:R5:_extract_dict_from_row:fp=81b80a123b326124
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:CheckpointEncoder:default:fp=72cffac7b9b4f871
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=d35d4e11d243b198
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=6bbc05c2197b1800
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=346fe02f62559967
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=69bdc2211c2b6e0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=4d05c5da68423665
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/export.py:R1:reconstruct_schema_from_json:fp=64bce9b651db0fad
  owner: bugfix
  reason: JSON Schema field access - external data at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/schema_contract.py:R1:SchemaContract:get_field:fp=7df7fefcb2213125
  owner: architecture
  reason: 'Optional lookup API: get_field() intentionally returns None for missing fields - callers use resolve_name() for strict lookup'
- key: contracts/plugin_context.py:R5:PluginContext:get:fp=76de86ac35dafae4
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R1:PluginContext:record_call:fp=5ec999dfff114a20
  owner: architecture
  reason: Optional field access at trust boundary
- key: contracts/plugin_context.py:R5:PluginContext:record_call:fp=94971df001b1532e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R4:PluginContext:record_call:fp=4e105a1207a19d87
  owner: architecture
  reason: Broad exception handling at external boundary with logging
- key: contracts/plugin_context.py:R5:PluginContext:record_validation_error:fp=27fe368832b3e2a9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R6:PluginContext:record_validation_error:fp=d20c868c67b376ce
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: plugins/validation.py:R5:PluginConfigValidator:validate_sink_config:fp=39024a41cd690457
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: plugins/validation.py:R1:PluginConfigValidator:_extract_errors:fp=76f7694624d8cfcc
  owner: architecture
  reason: Optional field access at trust boundary
- key: mcp/server.py:R5:_validate_tool_args:fp=69c3d598495199e8
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=1d4be1fd73596be4
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=b3a076df12512a98
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=0110a14d5673741b
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=7877fba47c3e1861
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=7c7262d14d75a68d
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=6a4c72ce1cfff6a7
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R4:create_server:call_tool:fp=f2fc0f3de0c0a642
  owner: architecture
  reason: Broad exception handling at external boundary with logging
- key: mcp/server.py:R6:_find_audit_databases:fp=6e1b6fb8610a9c80
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=fb3e25ee3e686cfa
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=58a72039b4c8c3f8
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=89f95e856b85e04f
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=3f32c48564ee23ba
  owner: architecture
  reason: KeyError from PayloadStore when payload purged by retention policy — expected, not corruption
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=0ccb1c8df3875bcb
  owner: architecture
  reason: KeyError from PayloadStore when payload purged by retention policy — expected, not corruption
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=9ca89eaa0e651dcf
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36c3f58b638f1aff
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=443894e5bdda8a78
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36096d44e6d8c088
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=e7368fdf9fa869f8
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=c3e2f9d2af522c9d
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=47946a8ab829df41
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=dfa86502fc245865
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=a49774aca3191658
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=e6d0c8334783f7db
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=cd7ae9f783e16f59
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=25eb43eaa792a88a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=13a240c282634e6a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_columns_to_values:fp=8a63a6b78ec0851c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/_call_recording.py:R6:CallRecordingMixin:get_call_response_data:fp=0bc9a6b3b94f93c9
  owner: architecture
  reason: Graceful handling of purged payloads - retention policy may have deleted response data
- key: plugins/clients/http.py:R1:AuditedHTTPClient:post:fp=3c0be6939b9ad68c
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=57f98d9a680c4fe0
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=8d0a8a1eebc183ff
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=de1053d26df88b2e
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=8e3c6282a014e674
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=828d933917d5becb
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=fd83274374bde4f7
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=1e64e43b98341872
  owner: architecture
  reason: httpx Client.get() method call - this is the external HTTP call with IP pinning
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=218c21461d517b71
  owner: architecture
  reason: httpx Client.get() method call - this is the external HTTP call with IP pinning
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=51570a45a72c0c87
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=5592b5008ca0c900
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=23c341af1cdd3b1e
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=4850854b4b37d852
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
