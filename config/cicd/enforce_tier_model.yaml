version: 1
defaults:
  fail_on_stale: true
  fail_on_expired: true
per_file_rules:
- pattern: contracts/schema.py
  rules:
  - R1
  - R5
  reason: SchemaConfig.from_dict() parses user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: contracts/contract_records.py
  rules:
  - R5
  reason: Violation type dispatch requires isinstance() for polymorphic serialization of ContractViolation subclasses
  expires: null
- pattern: contracts/type_normalization.py
  rules:
  - R5
  reason: Type normalization requires isinstance() for polymorphic serialization of numeric types
  expires: null
- pattern: cli.py
  rules:
  - R1
  - R3
  - R4
  - R5
  - R6
  reason: CLI handles user input, env vars, and external system checks (Tier 3)
  expires: null
- pattern: mcp/server.py
  rules:
  - R1
  reason: MCP tool arguments are external client data (Tier 3) - defensive access is correct
  expires: null
- pattern: plugins/sources/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Source plugins ingest external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/config_base.py
  rules:
  - R1
  - R5
  reason: Plugin config parsing handles user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: plugins/llm/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: LLM API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/azure/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Azure API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: telemetry/exporters/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Telemetry services are external (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: engine/expression_parser.py
  rules:
  - R5
  - R3
  reason: AST-based expression parser requires isinstance() for node type dispatch and try/except for unknown AST node types
  expires: null
- pattern: core/templates.py
  rules:
  - R5
  reason: Jinja2 template AST walker requires isinstance() for node type traversal - fundamental to field extraction
  expires: null
- pattern: core/config.py
  rules:
  - R1
  - R5
  - R6
  reason: Configuration loading parses user YAML (Tier 3) - defensive type checking and optional field access required
  expires: null
- pattern: core/security/*
  rules:
  - R1
  reason: Security utilities access optional environment variables (Tier 3) - defensive access for missing keys
  expires: null
- pattern: testing/__init__.py
  rules:
  - R5
  reason: Test factories accept dict|PipelineRow for convenience - isinstance() for input coercion, not bug masking
  expires: null
allow_hits:
- key: core/landscape/_node_state_recording.py:R5:NodeStateRecordingMixin:complete_node_state:fp=449fbf004664406f
  owner: architecture
  reason: Type narrowing after DB update - discriminated union requires isinstance to verify terminal state
  safety: Raises AuditIntegrityError if wrong state - explicit failure, not masking
  expires: null
- key: core/landscape/_error_recording.py:R6:ErrorRecordingMixin:record_validation_error:fp=4f08618bc36aa9af
  owner: architecture
  reason: Tier-3 boundary - row_data may contain NaN/Infinity which are not canonically serializable
  safety: Falls back to repr() with logging - audit trail preserved with metadata
  expires: null
- key: contracts/schema_contract_factory.py:R1:create_contract_from_config:fp=0fe7a31adc9f24b3
  owner: feature
  reason: Intentional identity fallback - fields without resolution mapping use normalized name as original name
  safety: Fallback to same value is correct behavior, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:record_accept:fp=a183521ba11a8ee6
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:should_trigger:fp=bac17c66d1886d99
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/executors.py:R4:SinkExecutor:write:fp=d34e8d03902346bb
  owner: architecture
  reason: 'Post-durability callbacks: checkpoint callback fails after durable sink write'
  safety: Logged with error - sink artifact exists but checkpoint failed, resume will replay
  expires: null
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=fb2d667d2fd74891
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/url.py:R6:SanitizedWebhookUrl:from_raw_url:fp=d1d4c7a6b6f8a842
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R6:_normalize_value:fp=8ef8fcd777ae4ddf
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=2cb2abe67276b404
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=55f64c33dbec338e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R6:AuditedHTTPClient:_filter_request_headers:fp=c5c171afc5be7b56
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/rate_limit/limiter.py:R6:RateLimiter:try_acquire:fp=b1dd92e33abe1b6f
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/metrics.py:R7:MetricsRecorder:close:fp=cae006971eb80032
  owner: architecture
  reason: Suppressing ProgrammingError on already-closed connections during shutdown
  safety: Connection objects may be closed by their owning thread before close() runs
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R6:_find_metrics_databases:fp=2bcfbfc1388cd9d8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=c5f4c4f695cabe87
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=3125065ec11fe578
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R5:RowWaiter:wait:fp=98c907e643e5e178
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:_get_batch_adapter:fp=2c5aafed0c8a4541
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:_get_batch_adapter:fp=fdc6ea9f820ae612
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:execute_transform:fp=d01ae7ebd1ac7338
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=de4d234ef7473f4a
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=8fafd96dbf45c47a
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=00b82fa85aad4751
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=0cc1786fd5b0c25b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=cd3bb2ba3e3e5dbf
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_rows:fp=e8afd34422930941
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_tokens:fp=631f6f0ece1be2d9
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=dc46811999243cd9
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=8d28359a684be7ea
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffer_count:fp=c996c21c8f20ac1e
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:fp=6abc58c94f238b78
  owner: P2-2026-02-02
  reason: Pattern is .get() followed by explicit None check raising RuntimeError
  safety: RuntimeError raised immediately if batch_id is None - explicit failure, not silent
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:fp=99345b091b9fae45
  owner: P2-2026-02-02
  reason: Version check for checkpoint format - None from missing key triggers ValueError
  safety: ValueError raised for missing or wrong version - explicit validation pattern
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_batch_id:fp=eea2736a8ccf972a
  owner: P2-2026-02-02
  reason: Testing/inspection method that needs to work with partial setups; returns None if no batch exists
  safety: Documented as "primarily for testing" - production uses checkpoint state
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_restored_state:fp=e61096326de71a28
  owner: P2-2026-02-02
  reason: Checkpoint recovery lookup - returns None if no state was restored for node
  safety: Designed API contract - None is valid return for nodes without restored state
  expires: null
- key: engine/executors.py:R5:AggregationExecutor:restore_from_checkpoint:fp=cb982c6ebef6e1c1
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=864f8798598aa264
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=3817cd2e5ac65a61
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=a300ae0fe73eeee2
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=ac3b6fcee8eeed57
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=411616af5f2ca497
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=932619974f1d8566
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/validation.py:R5:validate_route_destinations:fp=7f451dd3ea25d06c
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access correct attributes
  safety: isinstance() check selects code path for GateProtocol-specific name lookup; no bug hiding
  expires: '2026-05-02'
- key: engine/orchestrator/validation.py:R5:validate_transform_error_sinks:fp=20e3a1053033bc0b
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish for _on_error access
  safety: isinstance() check selects code path for TransformProtocol-specific attributes; no bug hiding
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_export_loop:fp=a8166fc10299a912
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:_export_loop:fp=d0ce3c8d47c10203
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_export_loop:fp=43b9fc24d17edf57
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_dispatch_to_exporters:fp=205648209571e6bf
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_dispatch_to_exporters:fp=7df5bc18c458067b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=b0eb5eeb6c39c018
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=4f85d27ac43efe91
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:flush:fp=2bd83495c312d0cc
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=2b852f9149cdfce5
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:close:fp=0fc8092d4e145c14
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R1:validate_row:fp=0f6fa60e1ef14cec
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R3:_type_name:fp=e5ac6075b25c4cd5
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R5:_is_union_type:fp=0cfbacff868ef7c0
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/transform_contract.py:R5:_is_union_type:fp=a9ba219b5d0e0a54
  owner: architecture
  reason: Type annotation introspection - required to detect Union/Optional types
  safety: Code reviewed - same pattern as data.py:_is_union_type
  expires: '2026-05-02'
- key: contracts/audit.py:R5:_validate_enum:fp=f48a15b1272c5363
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/audit.py:R5:TokenOutcome:__post_init__:fp=14670c8c83113873
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R9:_discover_in_file:fp=77f2deccecaa5aea
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:_discover_in_file:fp=f42969a5d77096b3
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:get_plugin_description:fp=0806b3aad609f380
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/base.py:R1:BaseGate:__init__:fp=d557713317a8b557
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/utils.py:R5:get_nested_field:fp=65234e1b71a7a0fc
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_source_config:fp=3bd8f6558f2b54b2
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_transform_config:fp=b60f09b21ed871b6
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/events.py:R1:EventBus:emit:fp=9291c1b6dd51107b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=735ac69d4aadbe9f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=136394dfb22a90ee
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R6:extract_jinja2_fields_with_names:fp=f6a3eb1805fd5f66
  owner: architecture
  reason: Contract resolution attempt - KeyError means field not in contract, handled as unresolved
  safety: Returns explicit resolved=False state, never silently drops - legitimate boundary handling
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=b40305f2a4c95243
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=d097732d7e19e600
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=a07e49d3a99eb425
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=d273c00e914f4675
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=25263724f0ed5aa5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=36ee3c1a855d74b5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=2eec034d080cdca1
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=2fc596ea6a6d848c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=a33b825cdbdf307b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=5d42d4dc61674323
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=848a6c78692ac91c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_for_canonical:fp=67673a677c3127f2
  owner: P1-2026-02-05-typecheck
  reason: PipelineRow type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required to convert PipelineRow to dict for RFC8785 compliance
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=6528210ee55b1344
  owner: P1-2026-02-05-typecheck
  reason: Dict type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=08b99fa8c7162ddb
  owner: P1-2026-02-05-typecheck
  reason: List/tuple type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=799383f3318c92d0
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=805b2168b55f994d
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=223134d03cb7c869
  owner: architecture
  reason: Optional HTTP header access - X-Fake-Response-Mode is an optional override header (Tier 3)
  safety: Falls back to None when absent - correct for optional headers
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=d0f2fafff977cf37
  owner: architecture
  reason: Optional HTTP header access - X-Fake-Template is an optional override header (Tier 3)
  safety: Falls back to None when absent - correct for optional headers
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=0d867cb3140ddc37
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=0725e49f88fcd8cc
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:ErrorInjectionConfig:parse_range:fp=2657656f67c463e5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:load_preset:fp=f06b9c172dbf8e15
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:_deep_merge:fp=62cd2711bdcee5fd
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/config.py:R5:_deep_merge:fp=771fcc2b1f364873
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R5:PresetBank:from_jsonl:fp=a86816a07f74c3f6
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=319727597ad71ac9
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=e27542ac4ab46102
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=0fa0eec2f5837ed3
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=d04051587b9b4e1c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=216d32a283dd211a
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=ae7b944c3352fb61
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=7032350ebd1e2d01
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=0edfa9b30664cb15
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=fb007fb57e761ed1
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=9ccb09d5a6b09cbe
  owner: architecture
  reason: External HTTP request body - messages field is optional per OpenAI spec (Tier 3)
  safety: Falls back to empty list - correct for optional request field
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=eab5668c5261146c
  owner: architecture
  reason: External HTTP request body - model field is optional per OpenAI spec (Tier 3)
  safety: Falls back to "unknown" - correct for optional request field
  expires: '2026-05-02'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=783f28b03b567ca6
  owner: architecture
  reason: External HTTP request body - model field is optional per OpenAI spec (Tier 3)
  safety: Falls back to "gpt-4" default - correct for optional request field
  expires: '2026-05-02'
- key: testing/chaosllm/cli.py:R6:_version_callback:fp=e2b51655e4d22702
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/cli.py:R6:show_config:fp=ed8499ffbc8fd80e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R1:create_server:call_tool:fp=e1b2cc34d0a57eea
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R4:create_server:call_tool:fp=e2c9b6f8afcfe19a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/_helpers.py:R5:coerce_enum:fp=7aabb8ce0df1d1fd
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=8565df78b19e294d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=a2f12ee54e9a5c94
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=defdcd762186d8cf
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=ecef37c8d956459c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=4183ff6b263eafc5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=e8f56396e9180b8a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=9ad878d6e0a07d07
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=3473fbeb60dce788
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=99034a7ce01af9db
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=2045980afb19da73
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=7323a806122add1b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/database_sink.py:R1:DatabaseSink:__init__:fp=cb728c1a23ed45e2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/json_sink.py:R5:JSONSink:validate_output_target:fp=8dc25260f8a13296
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/batch_replicate.py:R5:BatchReplicate:process:fp=82656a27217db06a
  owner: architecture
  reason: Tier 2 contract enforcement - isinstance validates copies_field type before arithmetic
  safety: Wrong types crash (upstream bug); wrong values quarantined via error result
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:process:fp=9160e4e0b95ed5e8
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=af2344f0f0f5938f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=840bd57450114a00
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=bc395c6a768847b9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=ae444b17b823e17a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/json_explode.py:R5:JSONExplode:process:fp=0bd8dc8dca329b8b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_normalization_collisions:fp=5d89837a5521627f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_mapping_collisions:fp=a1371511b3dee8c6
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=923431e7c7c800eb
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=bbe24a28f3c7d484
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_process_and_complete:fp=dc75c0a50ecb9961
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=e4406b514a797107
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=a85655eb9d5dce08
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:_release_loop:fp=eccdfd781f52ed76
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=e05a82665f12ff8a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=68ee805887eb3173
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:evict_submission:fp=9e733ee9d7f79f4f
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_filter_request_headers:fp=8c35c9e302cece59
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=5bdbfe7db9e32163
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=695415b2ec4d8fee
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R9:AzureContentSafety:_process_row:fp=b18b4272385d82ff
  owner: architecture
  reason: Cleanup/pop with default — HTTP client cleanup may race with error paths
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_process_single_with_state:fp=8404ee8567c3b226
  owner: architecture
  reason: Tier 3 boundary — validates row field is str before sending to Azure API
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=9bb006a32eb07a28
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for content scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=1617ec4ae04857b6
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for content scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R1:AzureContentSafety:_analyze_content:fp=9cbec0737e033ad0
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure API response to check unknown categories
  safety: Unknown categories logged, only mapped categories used. MalformedResponseError raised if expected categories missing.
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_analyze_content:fp=132e9c8653a9a14b
  owner: architecture
  reason: Tier 3 boundary — validates severity type from Azure API response is int
  safety: MalformedResponseError raised if type wrong, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R9:AzurePromptShield:_process_row:fp=5555041200ea3e5a
  owner: architecture
  reason: Cleanup/pop with default — HTTP client cleanup may race with error paths
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_process_single_with_state:fp=69fe83d9ba6aa6e9
  owner: architecture
  reason: Tier 3 boundary — validates row field is str before sending to Azure API
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=6756f72f855a6bcf
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=71955a9599f4811d
  owner: architecture
  reason: Tier 2 row filtering — isinstance selects str fields for scanning
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=5ebfe1bb3a77f354
  owner: architecture
  reason: Tier 3 boundary — validates Azure response structure before parsing
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=ec7bffed1b84a52f
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure API response to extract userPromptAnalysis
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=9e2efc70e9c2a9dc
  owner: architecture
  reason: Tier 3 boundary — validates userPromptAnalysis is dict from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=3b3f342da93a70a8
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure response to extract attackDetected field
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=c841d2c305e52b38
  owner: architecture
  reason: Tier 3 boundary — validates attackDetected is bool from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=40253c1ac93c9dee
  owner: architecture
  reason: Tier 3 boundary — .get() on Azure response to extract documentsAnalysis
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=f580cd433ba3ceaa
  owner: architecture
  reason: Tier 3 boundary — validates documentsAnalysis is list from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=7253081edf54b8ad
  owner: architecture
  reason: Tier 3 boundary — validates each document entry is dict from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=6fc4cb2a3c9fe209
  owner: architecture
  reason: Tier 3 boundary — .get() on document dict to extract attackDetected
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=decde02c66d672a3
  owner: architecture
  reason: Tier 3 boundary — validates document attackDetected is bool from Azure response
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R6:ExplainScreen:_load_node_state:fp=ea0af175990905a8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:load:fp=2c2f53eeaf62b1aa
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:retry:fp=aaa04b3313221b0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=efa021de94ac3b1f
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=c487c413733875f2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d83a6cacd8813583
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=561bead45d07791c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=b9a8fe28fc3a2a35
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=db3f916fb4b5df04
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f86a38f7c1fdf563
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=e0e83f67901e3bc7
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=2fe3f91f56f42b8c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=ab6e5fba4141cf4d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d1f89dde14fd37d2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=a6f1d850a7f12c4f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=4689219565e309cc
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=6eefee9df94392dd
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f40067b280807118
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a4ecc4a0cc77230c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=872b14cd5cb8103d
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=675ba5371c46f70a
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=03b59094c0a9934c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=2fe98f01ca3be04d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a105e6d08eb1e3b9
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/security/secret_loader.py:R6:CompositeSecretLoader:get_secret:fp=8846ddf2a85396bb
  owner: bugfix
  reason: Intentional fallback pattern - CompositeSecretLoader tries loaders in priority order
  safety: SecretNotFoundError from one loader triggers fallback to next; raises if all fail
  expires: null
- key: core/security/secret_loader.py:R6:KeyVaultSecretLoader:get_secret:fp=0c397e0294f3db17
  owner: bugfix
  reason: Sentinel class definition in except ImportError — not a runtime error handler
  safety: _get_client() raises ImportError before any Azure API call; sentinel class is never caught
  expires: null
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=ba5e8b50967a0614
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Code reviewed - legitimate pattern; else branch handles unexpected types via str() conversion
  expires: '2026-05-02'
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=8ffe2a2eb3655de3
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Code reviewed - legitimate pattern; else branch handles unexpected types via str() conversion
  expires: '2026-05-02'
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=6da358fbc674d735
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=88448fd740364e24
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=4134c33898370a29
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=0a516787233a14be
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=1e6dc332e2ef9699
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=ecfef5a461fab47d
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=efa2d1bce6b292b8
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=858ee1fdd29fc79a
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=7c53c74396aa56f7
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=2c0f051f0c37248d
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.exists() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=e172162bc1808ed8
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.delete() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=cb8f391ad82b21df
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=6b5b01f9759184f2
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=a223631a490eb6ac
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=dfb4bbba26b7416f
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=ac644329fadcf3b7
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=e9f28518296c9c5a
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_open_file:fp=529df26a8624a42d
  owner: feature
  reason: Intentional fallback - reverse mapping may not contain all fields (transform-added)
  safety: Falls back to original field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_get_field_names_and_display:fp=688e26cbcb3aa309
  owner: feature
  reason: Intentional fallback - display mapping may not contain all fields (transform-added)
  safety: Falls back to normalized field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:validate_output_target:fp=4f8918e243e34a1a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:validate_output_target:fp=11a12d24c049f460
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:_apply_display_headers:fp=c5e1158dff11755a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: contracts/header_modes.py:R5:parse_header_mode:fp=dc93452b5432e8a4
  owner: feature
  reason: Config parsing - config value from YAML is Tier 3 external data; isinstance() distinguishes string from dict
  safety: ValueError raised for invalid config - explicit validation failure
  expires: null
- key: contracts/contract_propagation.py:R6:propagate_contract:fp=fbcdf96127213894
  owner: architecture
  reason: Type narrowing failure is silently skipped - non-primitive types aren't included in contract
  safety: Field continues in data without contract tracking - intentional behavior
  expires: null
- key: contracts/contract_propagation.py:R6:narrow_contract_to_output:fp=b2e116f9ad91bb8f
  owner: architecture
  reason: Type resolution errors are logged and field is excluded from narrowed contract
  safety: Contract narrowing continues without failed field - explicit logging
  expires: null
- key: contracts/contract_propagation.py:R1:merge_contract_with_output:fp=b77bb8f4e1cd3d1d
  owner: architecture
  reason: Optional lookup for original name - new fields from transforms may not have input mapping
  safety: Fallback to output field's original_name is correct behavior for transform-added fields
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=76eb122944753b45
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Missing type handled by subsequent "type" in item check; falls through to error
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=ff1b7e567dcc1a55
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Filters items by type != "null"; items without type are correctly excluded
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=117a3e0e68aa409d
  owner: bugfix
  reason: JSON Schema "format" field is optional per spec - external data at trust boundary
  safety: Missing format defaults to None, falls through to plain str return - correct behavior
  expires: null
- key: engine/tokens.py:R5:TokenManager:create_quarantine_token:fp=dcd7d270154917c7
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check converts PipelineRow to dict for audit trail consistency
  expires: null
- key: plugins/transforms/batch_stats.py:R5:BatchStats:process:fp=f54b9087450d567e
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check required to handle union type from batch processing
  expires: null
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=9370a8f4d789c2c1
  owner: architecture
  reason: isinstance() on float to detect NaN/Infinity in JSON - type discrimination for serialization
  safety: Rejects non-finite values that would break RFC 8785 canonicalization
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=cbbbfa89308db09a
  owner: architecture
  reason: isinstance() on dict for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=4a5b03bd164d53bf
  owner: architecture
  reason: isinstance() on list for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/transforms/web_scrape.py:R4:WebScrapeTransform:process:fp=f36e99f2308c0272
  owner: architecture
  reason: Tier 3 boundary - response.text is external data, extract_content() can fail unpredictably
  safety: Returns TransformResult.error() for quarantine with reason, error_type, and URL
  expires: '2026-05-02'
- key: contracts/checkpoint.py:R5:ResumePoint:__post_init__:fp=06723188787bab6d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:CheckpointEncoder:default:fp=72cffac7b9b4f871
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=d35d4e11d243b198
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=6bbc05c2197b1800
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=346fe02f62559967
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=69bdc2211c2b6e0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=4d05c5da68423665
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/export.py:R1:reconstruct_schema_from_json:fp=64bce9b651db0fad
  owner: bugfix
  reason: JSON Schema field access - external data at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/schema_contract.py:R1:SchemaContract:get_field:fp=7df7fefcb2213125
  owner: architecture
  reason: 'Optional lookup API: get_field() intentionally returns None for missing fields - callers use resolve_name() for strict lookup'
- key: contracts/plugin_context.py:R5:PluginContext:get:fp=76de86ac35dafae4
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R1:PluginContext:record_call:fp=5ec999dfff114a20
  owner: architecture
  reason: Optional field access at trust boundary
- key: contracts/plugin_context.py:R5:PluginContext:record_call:fp=94971df001b1532e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R4:PluginContext:record_call:fp=4e105a1207a19d87
  owner: architecture
  reason: Broad exception handling at external boundary with logging
- key: contracts/plugin_context.py:R5:PluginContext:record_validation_error:fp=27fe368832b3e2a9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R6:PluginContext:record_validation_error:fp=d20c868c67b376ce
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: plugins/validation.py:R5:PluginConfigValidator:validate_sink_config:fp=39024a41cd690457
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: plugins/validation.py:R1:PluginConfigValidator:_extract_errors:fp=76f7694624d8cfcc
  owner: architecture
  reason: Optional field access at trust boundary
- key: mcp/server.py:R5:_validate_tool_args:fp=69c3d598495199e8
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=1d4be1fd73596be4
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=b3a076df12512a98
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=0110a14d5673741b
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=7877fba47c3e1861
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=7c7262d14d75a68d
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=6a4c72ce1cfff6a7
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R4:create_server:call_tool:fp=f2fc0f3de0c0a642
  owner: architecture
  reason: Broad exception handling at external boundary with logging
- key: mcp/server.py:R6:_find_audit_databases:fp=6e1b6fb8610a9c80
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=fb3e25ee3e686cfa
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=58a72039b4c8c3f8
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=89f95e856b85e04f
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=3f32c48564ee23ba
  owner: architecture
  reason: KeyError from PayloadStore when payload purged by retention policy — expected, not corruption
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=0ccb1c8df3875bcb
  owner: architecture
  reason: KeyError from PayloadStore when payload purged by retention policy — expected, not corruption
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=9ca89eaa0e651dcf
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36c3f58b638f1aff
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=443894e5bdda8a78
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36096d44e6d8c088
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=e7368fdf9fa869f8
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=c3e2f9d2af522c9d
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=47946a8ab829df41
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=dfa86502fc245865
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=a49774aca3191658
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=e6d0c8334783f7db
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=cd7ae9f783e16f59
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=25eb43eaa792a88a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=13a240c282634e6a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_columns_to_values:fp=8a63a6b78ec0851c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/_call_recording.py:R6:CallRecordingMixin:get_call_response_data:fp=0bc9a6b3b94f93c9
  owner: architecture
  reason: Graceful handling of purged payloads - retention policy may have deleted response data
- key: plugins/clients/http.py:R1:AuditedHTTPClient:post:fp=3c0be6939b9ad68c
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=57f98d9a680c4fe0
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=8d0a8a1eebc183ff
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=de1053d26df88b2e
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=8e3c6282a014e674
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=828d933917d5becb
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=fd83274374bde4f7
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=4ca4e2477ece4e30
  owner: architecture
  reason: httpx Client.get() method call - ephemeral client for TLS/SNI isolation
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=218c21461d517b71
  owner: architecture
  reason: httpx Client.get() method call - this is the external HTTP call with IP pinning
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=51570a45a72c0c87
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=5592b5008ca0c900
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=23c341af1cdd3b1e
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=48a4d8f531e7c27d
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
- key: contracts/results.py:R5:ArtifactDescriptor:for_database:fp=2300432a3c93d6b5
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedDatabaseUrl
  safety: TypeError raised if wrong URL type - explicit failure, not masking
  expires: null
- key: contracts/results.py:R5:ArtifactDescriptor:for_webhook:fp=e2fada7e3814d17c
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedWebhookUrl
  safety: TypeError raised if wrong URL type - explicit failure, not masking
  expires: null
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=2bf9f232eefa3b17
  owner: architecture
  reason: Retry boundary - LLMClientError exception type check for retryable classification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=19074dff15926913
  owner: architecture
  reason: Retry boundary - ConnectionError/TimeoutError/OSError type check for retryable classification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/processor.py:R5:RowProcessor:_resolve_jump_target_on_success_sink:fp=911ab3c7209a7448
  owner: architecture
  reason: Protocol dispatch while traversing jumped subchain to resolve inherited terminal sink
  safety: Traversal map invariants are enforced; raises on cycles or invalid nodes
  expires: '2026-03-10'
- key: engine/processor.py:R1:RowProcessor:_notify_coalesce_of_lost_branch:fp=e01ffdd09d8c0ff0
  owner: architecture
  reason: dict.get() correct - not all branch names have coalesce point mapping
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: engine/processor.py:R5:RowProcessor:_drain_work_queue:fp=2db828b82026d639
  owner: architecture
  reason: Type dispatch on _process_single_token return (RowResult | list[RowResult] | None)
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=ac23dfc7bde5bcb9
  owner: architecture
  reason: Protocol dispatch - isinstance for GateProtocol type routing in unified node traversal
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=b09837470f376107
  owner: architecture
  reason: Protocol dispatch - isinstance for TransformProtocol type routing in unified node traversal
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=d79935d16a26989d
  owner: architecture
  reason: Protocol dispatch - isinstance for GateSettings type routing in unified node traversal
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=6e0cfc3879ec14bc
  owner: architecture
  reason: Framework-boundary type narrowing for mixed transform and gate plugin lists
  safety: Raises on incompatible plugin behavior; no silent fallback
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=d5ffb7eabc91845d
  owner: architecture
  reason: Gate vs transform dispatch for unified node traversal
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=b1afa822e52b9ba2
  owner: architecture
  reason: Optional _output_schema_config metadata is present only on select plugins
  safety: Missing metadata is handled as None; core schema enforcement still validates edges
  expires: '2026-03-10'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=b3167081c993daeb
  owner: architecture
  reason: Optional _output_schema_config metadata is present only on select aggregation plugins
  safety: Missing metadata is handled as None; aggregation schemas still validated via contracts
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=11afdd4bd8aa7c7f
  owner: architecture
  reason: Gate plugin exclusion for terminal on_success sink wiring requires explicit type narrowing
  safety: Routing config remains validated and errors are explicit
  expires: '2026-03-10'
- key: core/dag.py:R8:ExecutionGraph:from_plugin_instances:fp=de78f7b9fe101113
  owner: architecture
  reason: setdefault used for route-label grouping while building gate continue-route diagnostics
  safety: Grouping is deterministic and validated before runtime routing
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:from_plugin_instances:fp=cf7267ebc8b07d87
  owner: architecture
  reason: Optional gate connection route label lookup for coalesce provenance wiring
  safety: Missing lookup returns None — handled explicitly by conditional check
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=d4a8dcf4b17775b6
  owner: architecture
  reason: Gate plugin exclusion for transform on_error divert-edge wiring requires explicit type narrowing
  safety: Only non-gate transforms are eligible for on_error; invalid use fails validation
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:_get_schema_config_from_node:fp=6ad33187820a4320
  owner: architecture
  reason: Optional schema access for mixed node types (source/sink/gate/coalesce)
  safety: Crashes on malformed schema payloads; None is an intentional non-schema state
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:_get_schema_config_from_node:fp=76248ffde21d80bd
  owner: architecture
  reason: Runtime shape check before coercing schema dict to SchemaConfig
  safety: Non-dict payloads are rejected and converted to explicit validation failures
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:_get_required_fields:fp=ca9d5b32e24b67a5
  owner: architecture
  reason: Optional required_input_fields key supports transforms with implicit/no required field contract
  safety: Missing key yields empty set; downstream schema checks still enforce compatibility
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:_get_required_fields:fp=91555c5ddabbdaaf
  owner: architecture
  reason: Options payload shape check at config boundary before extracting nested required_input_fields
  safety: Non-dict options are treated as no declared requirements and never silently coerced
  expires: '2026-03-10'
- key: plugins/transforms/web_scrape.py:R1:WebScrapeTransform:__init__:fp=6b27daeff28c2216
  owner: architecture
  reason: User YAML config boundary - http_config is parsed from pipeline settings
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=7c5419575b2202aa
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=4a489b468313543b
  owner: architecture
  reason: Tier 3 boundary - quarantine path handles non-dict source rows
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/core.py:R5:Orchestrator:_process_resumed_rows:fp=2d1ec064511f75a9
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/aggregation.py:R5:find_aggregation_transform:fp=b99e6bee5e64dbcf
  owner: architecture
  reason: isinstance() check required to find batch-aware transforms - protocol contract verification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
