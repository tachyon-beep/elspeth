version: 1
defaults:
  fail_on_stale: true
  fail_on_expired: true
per_file_rules:
- pattern: contracts/schema.py
  rules:
  - R1
  - R5
  reason: SchemaConfig.from_dict() parses user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: contracts/contract_records.py
  rules:
  - R5
  reason: Violation type dispatch requires isinstance() for polymorphic serialization of ContractViolation subclasses
  expires: null
- pattern: contracts/type_normalization.py
  rules:
  - R5
  reason: Type normalization requires isinstance() for polymorphic serialization of numeric types
  expires: null
- pattern: cli.py
  rules:
  - R1
  - R3
  - R4
  - R5
  - R6
  reason: CLI handles user input, env vars, and external system checks (Tier 3)
  expires: null
- pattern: cli_helpers.py
  rules:
  - R1
  reason: resolve_audit_passphrase reads env vars (Tier 3 boundary) - .get() returns None to signal absent passphrase
  expires: null
- pattern: mcp/server.py
  rules:
  - R1
  reason: MCP tool arguments are external client data (Tier 3) - defensive access is correct
  expires: null
- pattern: mcp/analyzers/*
  rules:
  - R1
  reason: Analyzer submodule functions process Tier 3 MCP data - defensive access is correct
  expires: null
- pattern: plugins/sources/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Source plugins ingest external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/config_base.py
  rules:
  - R1
  - R5
  reason: Plugin config parsing handles user YAML config (Tier 3) - defensive access for optional fields
  expires: null
- pattern: plugins/llm/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: LLM API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: plugins/azure/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Azure API responses are external data (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: telemetry/exporters/*
  rules:
  - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R9
  reason: Telemetry services are external (Tier 3) - all defensive patterns legitimate
  expires: null
- pattern: engine/expression_parser.py
  rules:
  - R5
  - R3
  reason: AST-based expression parser requires isinstance() for node type dispatch and try/except for unknown AST node types
  expires: null
- pattern: core/templates.py
  rules:
  - R5
  reason: Jinja2 template AST walker requires isinstance() for node type traversal - fundamental to field extraction
  expires: null
- pattern: core/config.py
  rules:
  - R1
  - R5
  - R6
  reason: Configuration loading parses user YAML (Tier 3) - defensive type checking and optional field access required
  expires: null
- pattern: core/security/*
  rules:
  - R1
  reason: Security utilities access optional environment variables (Tier 3) - defensive access for missing keys
  expires: null
- pattern: testing/__init__.py
  rules:
  - R5
  reason: Test factories accept dict|PipelineRow for convenience - isinstance() for input coercion, not bug masking
  expires: null
allow_hits:
- key: core/landscape/_node_state_recording.py:R5:NodeStateRecordingMixin:complete_node_state:fp=449fbf004664406f
  owner: architecture
  reason: Type narrowing after DB update - discriminated union requires isinstance to verify terminal state
  safety: Raises AuditIntegrityError if wrong state - explicit failure, not masking
  expires: null
- key: core/landscape/_error_recording.py:R6:ErrorRecordingMixin:record_validation_error:fp=4f08618bc36aa9af
  owner: architecture
  reason: Tier-3 boundary - row_data may contain NaN/Infinity which are not canonically serializable
  safety: Falls back to repr() with logging - audit trail preserved with metadata
  expires: null
- key: contracts/schema_contract_factory.py:R1:create_contract_from_config:fp=0fe7a31adc9f24b3
  owner: feature
  reason: Intentional identity fallback - fields without resolution mapping use normalized name as original name
  safety: Fallback to same value is correct behavior, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:record_accept:fp=a183521ba11a8ee6
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/triggers.py:R5:TriggerEvaluator:should_trigger:fp=bac17c66d1886d99
  owner: bugfix
  reason: Defense-in-depth - ExpressionParser returns Any; boundary validation before use
  safety: TypeError raised with expression details - explicit failure, not silent coercion
  expires: null
- key: engine/executors.py:R4:SinkExecutor:write:fp=f6af09f714ec682c
  owner: architecture
  reason: 'Post-durability callbacks: checkpoint callback fails after durable sink write'
  safety: Logged with error - sink artifact exists but checkpoint failed, resume will replay
  expires: null
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=fb2d667d2fd74891
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/url.py:R6:SanitizedWebhookUrl:from_raw_url:fp=d1d4c7a6b6f8a842
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R6:_normalize_value:fp=923db5911422d223
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=2cb2abe67276b404
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R6:BatchTransformMixin:_release_loop:fp=55f64c33dbec338e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R6:AuditedHTTPClient:_filter_request_headers:fp=c5c171afc5be7b56
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/rate_limit/limiter.py:R6:RateLimiter:try_acquire:fp=52fa4ef5a66f8245
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R6:_find_metrics_databases:fp=2bcfbfc1388cd9d8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=c5f4c4f695cabe87
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R9:RowWaiter:wait:fp=3125065ec11fe578
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/batch_adapter.py:R5:RowWaiter:wait:fp=98c907e643e5e178
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:_get_batch_adapter:fp=2c5aafed0c8a4541
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:_get_batch_adapter:fp=fdc6ea9f820ae612
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R3:TransformExecutor:execute_transform:fp=d01ae7ebd1ac7338
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=de4d234ef7473f4a
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R2:TransformExecutor:execute_transform:fp=8fafd96dbf45c47a
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R5:TransformExecutor:execute_transform:fp=00b82fa85aad4751
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_rows:fp=e8afd34422930941
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered
    yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_tokens:fp=631f6f0ece1be2d9
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered
    yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=dc46811999243cd9
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered
    yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:fp=8d28359a684be7ea
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no tokens buffered
    yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffer_count:fp=c996c21c8f20ac1e
  owner: P2-2026-02-02
  reason: After validation against aggregation_settings, .get() handles legitimate case of valid node with no rows buffered
    yet
  safety: OrchestrationInvariantError raised if node_id not in aggregation_settings
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:fp=6abc58c94f238b78
  owner: P2-2026-02-02
  reason: Pattern is .get() followed by explicit None check raising RuntimeError
  safety: RuntimeError raised immediately if batch_id is None - explicit failure, not silent
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:fp=99345b091b9fae45
  owner: P2-2026-02-02
  reason: Version check for checkpoint format - None from missing key triggers ValueError
  safety: ValueError raised for missing or wrong version - explicit validation pattern
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_batch_id:fp=eea2736a8ccf972a
  owner: P2-2026-02-02
  reason: Testing/inspection method that needs to work with partial setups; returns None if no batch exists
  safety: Documented as "primarily for testing" - production uses checkpoint state
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_restored_state:fp=e61096326de71a28
  owner: P2-2026-02-02
  reason: Checkpoint recovery lookup - returns None if no state was restored for node
  safety: Designed API contract - None is valid return for nodes without restored state
  expires: null
- key: engine/executors.py:R5:AggregationExecutor:restore_from_checkpoint:fp=cb982c6ebef6e1c1
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=864f8798598aa264
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=3817cd2e5ac65a61
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=a300ae0fe73eeee2
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=ac3b6fcee8eeed57
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=411616af5f2ca497
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: engine/orchestrator/core.py:R4:Orchestrator:_cleanup_plugins:fp=932619974f1d8566
  owner: architecture
  reason: Plugin cleanup must attempt all closures; broad catch collects errors then raises
  safety: Code reviewed - collects all cleanup errors into list, raises ExceptionGroup after all attempted
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_export_loop:fp=a8166fc10299a912
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:_export_loop:fp=d0ce3c8d47c10203
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_export_loop:fp=43b9fc24d17edf57
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:_dispatch_to_exporters:fp=205648209571e6bf
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R1:TelemetryManager:_dispatch_to_exporters:fp=7df5bc18c458067b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=b0eb5eeb6c39c018
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:handle_event:fp=4f85d27ac43efe91
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:flush:fp=2bd83495c312d0cc
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R6:TelemetryManager:close:fp=2b852f9149cdfce5
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: telemetry/manager.py:R4:TelemetryManager:close:fp=0fc8092d4e145c14
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R1:validate_row:fp=0f6fa60e1ef14cec
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R3:_type_name:fp=e5ac6075b25c4cd5
  owner: architecture
  reason: hasattr for feature detection
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/data.py:R5:_is_union_type:fp=0cfbacff868ef7c0
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/transform_contract.py:R5:_is_union_type:fp=a9ba219b5d0e0a54
  owner: architecture
  reason: Type annotation introspection - required to detect Union/Optional types
  safety: Code reviewed - same pattern as data.py:_is_union_type
  expires: '2026-05-02'
- key: contracts/audit.py:R5:_validate_enum:fp=f48a15b1272c5363
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/audit.py:R5:TokenOutcome:__post_init__:fp=14670c8c83113873
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R9:_discover_in_file:fp=77f2deccecaa5aea
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:_discover_in_file:fp=f42969a5d77096b3
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/discovery.py:R2:get_plugin_description:fp=0806b3aad609f380
  owner: architecture
  reason: getattr for optional attribute access
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/utils.py:R5:get_nested_field:fp=65234e1b71a7a0fc
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_source_config:fp=3bd8f6558f2b54b2
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/validation.py:R5:PluginConfigValidator:validate_transform_config:fp=b60f09b21ed871b6
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/events.py:R1:EventBus:emit:fp=9291c1b6dd51107b
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=735ac69d4aadbe9f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R8:extract_jinja2_fields_with_details:walk:fp=136394dfb22a90ee
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/templates.py:R6:extract_jinja2_fields_with_names:fp=f6a3eb1805fd5f66
  owner: architecture
  reason: Contract resolution attempt - KeyError means field not in contract, handled as unresolved
  safety: Returns explicit resolved=False state, never silently drops - legitimate boundary handling
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=4438a2dca309b0e4
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=b3b08971ab21da73
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=ac1eff91067e1362
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=fdbea316446915ea
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=4c37c2fbe4a1e437
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=ba832051b0f05ffa
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=5defca57b6f14588
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=6c03cfe4e1d280e2
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=7d2fa7f6ababc6e3
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=db74ac7dfb931f94
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_value:fp=9192ead0b8da55e0
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/canonical.py:R5:_normalize_for_canonical:fp=911ce3668bec91c9
  owner: P1-2026-02-05-typecheck
  reason: PipelineRow type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required to convert PipelineRow to dict for RFC8785 compliance
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=df91b2f539004403
  owner: P1-2026-02-05-typecheck
  reason: Dict type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: core/canonical.py:R5:_normalize_for_canonical:fp=99775927d0fcf089
  owner: P1-2026-02-05-typecheck
  reason: List/tuple type detection for canonical JSON serialization after mypy typecheck
  safety: isinstance() required for polymorphic serialization - fundamental to RFC8785 normalization
  expires: null
- key: testing/chaosllm/cli.py:R6:_version_callback:fp=e2b51655e4d22702
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm/cli.py:R6:show_config:fp=ed8499ffbc8fd80e
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R1:create_server:call_tool:fp=e1b2cc34d0a57eea
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: testing/chaosllm_mcp/server.py:R4:create_server:call_tool:fp=e2c9b6f8afcfe19a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/_helpers.py:R5:coerce_enum:fp=7aabb8ce0df1d1fd
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=8565df78b19e294d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=a2f12ee54e9a5c94
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=defdcd762186d8cf
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:serialize_datetime:fp=ecef37c8d956459c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=4183ff6b263eafc5
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=e8f56396e9180b8a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=9ad878d6e0a07d07
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=3473fbeb60dce788
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:dataclass_to_dict:fp=99034a7ce01af9db
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=2045980afb19da73
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/landscape/formatters.py:R5:CSVFormatter:flatten:fp=7323a806122add1b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/database_sink.py:R1:DatabaseSink:__init__:fp=2313ec3565068c68
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sinks/json_sink.py:R5:JSONSink:validate_output_target:fp=8dc25260f8a13296
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/batch_replicate.py:R5:BatchReplicate:process:fp=7d0ded8e77f9f3ac
  owner: architecture
  reason: Tier 2 contract enforcement - isinstance validates copies_field type before arithmetic
  safety: Wrong types crash (upstream bug); wrong values quarantined via error result
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:process:fp=9160e4e0b95ed5e8
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=af2344f0f0f5938f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/keyword_filter.py:R5:KeywordFilter:_get_fields_to_scan:fp=840bd57450114a00
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=bc395c6a768847b9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/truncate.py:R5:Truncate:process:fp=ae444b17b823e17a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/json_explode.py:R5:JSONExplode:process:fp=0bd8dc8dca329b8b
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_normalization_collisions:fp=5d89837a5521627f
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/sources/field_normalization.py:R8:check_mapping_collisions:fp=a1371511b3dee8c6
  owner: architecture
  reason: setdefault for lazy initialization
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=923431e7c7c800eb
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/pooling/executor.py:R5:PooledExecutor:_execute_single:fp=bbe24a28f3c7d484
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_process_and_complete:fp=dc75c0a50ecb9961
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=e4406b514a797107
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R7:BatchTransformMixin:_process_and_complete:fp=a85655eb9d5dce08
  owner: architecture
  reason: contextlib.suppress for expected exceptions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:_release_loop:fp=eccdfd781f52ed76
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=e05a82665f12ff8a
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:fp=68ee805887eb3173
  owner: architecture
  reason: Broad exception handling at external boundary with logging
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/batching/mixin.py:R9:BatchTransformMixin:evict_submission:fp=9e733ee9d7f79f4f
  owner: architecture
  reason: Cleanup/pop with default - key may not exist in race or optional scenarios
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_filter_request_headers:fp=8c35c9e302cece59
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=5bdbfe7db9e32163
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:fp=695415b2ec4d8fee
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R9:AzureContentSafety:_process_row:fp=b18b4272385d82ff
  owner: architecture
  reason: "Cleanup/pop with default \u2014 HTTP client cleanup may race with error paths"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_process_single_with_state:fp=8404ee8567c3b226
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates row field is str before sending to Azure API"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=9bb006a32eb07a28
  owner: architecture
  reason: "Tier 2 row filtering \u2014 isinstance selects str fields for content scanning"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_get_fields_to_scan:fp=1617ec4ae04857b6
  owner: architecture
  reason: "Tier 2 row filtering \u2014 isinstance selects str fields for content scanning"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R1:AzureContentSafety:_analyze_content:fp=9cbec0737e033ad0
  owner: architecture
  reason: "Tier 3 boundary \u2014 .get() on Azure API response to check unknown categories"
  safety: Unknown categories logged, only mapped categories used. MalformedResponseError raised if expected categories missing.
  expires: '2026-05-02'
- key: plugins/transforms/azure/content_safety.py:R5:AzureContentSafety:_analyze_content:fp=132e9c8653a9a14b
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates severity type from Azure API response is int"
  safety: MalformedResponseError raised if type wrong, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R9:AzurePromptShield:_process_row:fp=5555041200ea3e5a
  owner: architecture
  reason: "Cleanup/pop with default \u2014 HTTP client cleanup may race with error paths"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_process_single_with_state:fp=69fe83d9ba6aa6e9
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates row field is str before sending to Azure API"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=6756f72f855a6bcf
  owner: architecture
  reason: "Tier 2 row filtering \u2014 isinstance selects str fields for scanning"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_get_fields_to_scan:fp=71955a9599f4811d
  owner: architecture
  reason: "Tier 2 row filtering \u2014 isinstance selects str fields for scanning"
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=5ebfe1bb3a77f354
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates Azure response structure before parsing"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=ec7bffed1b84a52f
  owner: architecture
  reason: "Tier 3 boundary \u2014 .get() on Azure API response to extract userPromptAnalysis"
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=9e2efc70e9c2a9dc
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates userPromptAnalysis is dict from Azure response"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=3b3f342da93a70a8
  owner: architecture
  reason: "Tier 3 boundary \u2014 .get() on Azure response to extract attackDetected field"
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=c841d2c305e52b38
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates attackDetected is bool from Azure response"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=40253c1ac93c9dee
  owner: architecture
  reason: "Tier 3 boundary \u2014 .get() on Azure response to extract documentsAnalysis"
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=f580cd433ba3ceaa
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates documentsAnalysis is list from Azure response"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=7253081edf54b8ad
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates each document entry is dict from Azure response"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R1:AzurePromptShield:_analyze_prompt:fp=6fc4cb2a3c9fe209
  owner: architecture
  reason: "Tier 3 boundary \u2014 .get() on document dict to extract attackDetected"
  safety: MalformedResponseError raised if field missing or wrong type
  expires: '2026-05-02'
- key: plugins/transforms/azure/prompt_shield.py:R5:AzurePromptShield:_analyze_prompt:fp=decde02c66d672a3
  owner: architecture
  reason: "Tier 3 boundary \u2014 validates document attackDetected is bool from Azure response"
  safety: MalformedResponseError raised on wrong type, caught as non-retryable error
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R6:ExplainScreen:_load_node_state:fp=ea0af175990905a8
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:load:fp=2c2f53eeaf62b1aa
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/screens/explain_screen.py:R5:ExplainScreen:retry:fp=aaa04b3313221b0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=efa021de94ac3b1f
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=c487c413733875f2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d83a6cacd8813583
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=561bead45d07791c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=b9a8fe28fc3a2a35
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=db3f916fb4b5df04
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f86a38f7c1fdf563
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=e0e83f67901e3bc7
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=2fe3f91f56f42b8c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=ab6e5fba4141cf4d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=d1f89dde14fd37d2
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=a6f1d850a7f12c4f
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=4689219565e309cc
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=6eefee9df94392dd
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=f40067b280807118
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a4ecc4a0cc77230c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=872b14cd5cb8103d
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=675ba5371c46f70a
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=03b59094c0a9934c
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R5:NodeDetailPanel:render_content:fp=2fe98f01ca3be04d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:fp=a105e6d08eb1e3b9
  owner: architecture
  reason: Optional field access at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/security/secret_loader.py:R6:CompositeSecretLoader:get_secret:fp=8846ddf2a85396bb
  owner: bugfix
  reason: Intentional fallback pattern - CompositeSecretLoader tries loaders in priority order
  safety: SecretNotFoundError from one loader triggers fallback to next; raises if all fail
  expires: null
- key: core/security/secret_loader.py:R6:KeyVaultSecretLoader:get_secret:fp=0c397e0294f3db17
  owner: bugfix
  reason: "Sentinel class definition in except ImportError \u2014 not a runtime error handler"
  safety: _get_client() raises ImportError before any Azure API call; sentinel class is never caught
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=6da358fbc674d735
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=88448fd740364e24
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=4134c33898370a29
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_int_field:fp=0a516787233a14be
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=1e6dc332e2ef9699
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=ecfef5a461fab47d
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=efa2d1bce6b292b8
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=858ee1fdd29fc79a
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: contracts/config/runtime.py:R5:_validate_float_field:fp=7c53c74396aa56f7
  owner: bugfix
  reason: Tier-3 boundary - from_policy() validates plugin config (user YAML) before conversion
  safety: Raises ValueError with clear field name and value - no silent recovery
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=2c0f051f0c37248d
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.exists() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: core/retention/purge.py:R6:PurgeManager:purge_payloads:fp=e172162bc1808ed8
  owner: bugfix
  reason: Tier-3 boundary - PayloadStore.delete() is external I/O (filesystem/blob storage)
  safety: Exception caught, ref added to failed_refs, loop continues - explicit failure tracking
  expires: null
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=cb8f391ad82b21df
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: plugins/clients/llm.py:R4:AuditedLLMClient:chat_completion:fp=6b5b01f9759184f2
  owner: architecture
  reason: Telemetry emission failure - must not crash main LLM call flow
  safety: Logged and continues - telemetry is non-critical to LLM processing
  expires: '2026-05-02'
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=a223631a490eb6ac
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=dfb4bbba26b7416f
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=ac644329fadcf3b7
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: core/landscape/_run_recording.py:R5:RunRecordingMixin:get_source_field_resolution:fp=e9f28518296c9c5a
  owner: feature
  reason: Tier 1 trust validation - crash on corruption from our own audit database
  safety: ValueError raised on corrupt data - explicit failure, not silent coercion
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_open_file:fp=529df26a8624a42d
  owner: feature
  reason: Intentional fallback - reverse mapping may not contain all fields (transform-added)
  safety: Falls back to original field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:_get_field_names_and_display:fp=688e26cbcb3aa309
  owner: feature
  reason: Intentional fallback - display mapping may not contain all fields (transform-added)
  safety: Falls back to normalized field name - correct behavior for fields not in source
  expires: null
- key: plugins/sinks/csv_sink.py:R1:CSVSink:validate_output_target:fp=4f8918e243e34a1a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:validate_output_target:fp=11a12d24c049f460
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: plugins/sinks/json_sink.py:R1:JSONSink:_apply_display_headers:fp=c5e1158dff11755a
  owner: feature
  reason: Display header mapping - fields not in map keep original name (transform-added fields)
  safety: Intentional fallback to original field name, not bug hiding
  expires: null
- key: contracts/header_modes.py:R5:parse_header_mode:fp=dc93452b5432e8a4
  owner: feature
  reason: Config parsing - config value from YAML is Tier 3 external data; isinstance() distinguishes string from dict
  safety: ValueError raised for invalid config - explicit validation failure
  expires: null
- key: contracts/contract_propagation.py:R6:propagate_contract:fp=fbcdf96127213894
  owner: architecture
  reason: Type narrowing failure is silently skipped - non-primitive types aren't included in contract
  safety: Field continues in data without contract tracking - intentional behavior
  expires: null
- key: contracts/contract_propagation.py:R6:narrow_contract_to_output:fp=b2e116f9ad91bb8f
  owner: architecture
  reason: Type resolution errors are logged and field is excluded from narrowed contract
  safety: Contract narrowing continues without failed field - explicit logging
  expires: null
- key: contracts/contract_propagation.py:R1:merge_contract_with_output:fp=b77bb8f4e1cd3d1d
  owner: architecture
  reason: Optional lookup for original name - new fields from transforms may not have input mapping
  safety: Fallback to output field's original_name is correct behavior for transform-added fields
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=76eb122944753b45
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Missing type handled by subsequent "type" in item check; falls through to error
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=ff1b7e567dcc1a55
  owner: bugfix
  reason: JSON Schema items may not have "type" key - external data at trust boundary
  safety: Filters items by type != "null"; items without type are correctly excluded
  expires: null
- key: engine/orchestrator/export.py:R1:_json_schema_to_python_type:fp=117a3e0e68aa409d
  owner: bugfix
  reason: JSON Schema "format" field is optional per spec - external data at trust boundary
  safety: Missing format defaults to None, falls through to plain str return - correct behavior
  expires: null
- key: engine/tokens.py:R5:TokenManager:create_quarantine_token:fp=dcd7d270154917c7
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check converts PipelineRow to dict for audit trail consistency
  expires: null
- key: plugins/transforms/batch_stats.py:R5:BatchStats:process:fp=f54b9087450d567e
  owner: P1-2026-02-05-typecheck
  reason: Internal boundary - PipelineRow vs dict discrimination after mypy typecheck fixes
  safety: isinstance() check required to handle union type from batch processing
  expires: null
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=9370a8f4d789c2c1
  owner: architecture
  reason: isinstance() on float to detect NaN/Infinity in JSON - type discrimination for serialization
  safety: Rejects non-finite values that would break RFC 8785 canonicalization
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=cbbbfa89308db09a
  owner: architecture
  reason: isinstance() on dict for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/clients/http.py:R5:_contains_non_finite:fp=4a5b03bd164d53bf
  owner: architecture
  reason: isinstance() on list for recursive NaN/Infinity scan - type discrimination for serialization
  safety: Traverses JSON structure to find non-finite floats before audit recording
  expires: '2026-05-02'
- key: plugins/transforms/web_scrape.py:R4:WebScrapeTransform:process:fp=ba13e0d9177595d6
  owner: architecture
  reason: Tier 3 boundary - response.text is external data, extract_content() can fail unpredictably
  safety: Returns TransformResult.error() for quarantine with reason, error_type, and URL
  expires: '2026-05-02'
- key: contracts/checkpoint.py:R5:ResumePoint:__post_init__:fp=06723188787bab6d
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:CheckpointEncoder:default:fp=72cffac7b9b4f871
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=d35d4e11d243b198
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=6bbc05c2197b1800
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_reject_nan_infinity:fp=346fe02f62559967
  owner: bugfix
  reason: Tier-3 boundary validation - rejects NaN/Infinity for audit integrity
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=69bdc2211c2b6e0e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=4d05c5da68423665
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: engine/orchestrator/export.py:R1:reconstruct_schema_from_json:fp=64bce9b651db0fad
  owner: bugfix
  reason: JSON Schema field access - external data at trust boundary
  safety: Code reviewed - legitimate pattern
  expires: '2026-05-02'
- key: contracts/schema_contract.py:R1:SchemaContract:get_field:fp=7df7fefcb2213125
  owner: architecture
  reason: 'Optional lookup API: get_field() intentionally returns None for missing fields - callers use resolve_name() for
    strict lookup'
- key: contracts/plugin_context.py:R5:PluginContext:get:fp=76de86ac35dafae4
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R1:PluginContext:record_call:fp=5ec999dfff114a20
  owner: architecture
  reason: Optional field access at trust boundary
- key: contracts/plugin_context.py:R5:PluginContext:record_call:fp=94971df001b1532e
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R4:PluginContext:record_call:fp=4e105a1207a19d87
  owner: architecture
  reason: Broad exception handling at external boundary with logging
- key: contracts/plugin_context.py:R5:PluginContext:record_validation_error:fp=27fe368832b3e2a9
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: contracts/plugin_context.py:R6:PluginContext:record_validation_error:fp=d20c868c67b376ce
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: plugins/validation.py:R5:PluginConfigValidator:validate_sink_config:fp=39024a41cd690457
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: plugins/validation.py:R1:PluginConfigValidator:_extract_errors:fp=76f7694624d8cfcc
  owner: architecture
  reason: Optional field access at trust boundary
- key: mcp/server.py:R5:_validate_tool_args:fp=f4181517feee6c11
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=cbdeed2f422db866
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=c8ac5223101ffbc2
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=4bb05783ddeb348b
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=8c9a782a5cb9799f
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=127b6543a22bb7e2
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R5:_validate_tool_args:fp=42166080acd3ead9
  owner: architecture
  reason: MCP tool argument validation - Tier 3 external protocol boundary
  safety: Invalid arguments raise ValueError with descriptive message
  expires: '2026-05-02'
- key: mcp/server.py:R6:_find_audit_databases:fp=fccf4fac39739e52
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=a8b3ff484b45e25e
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=a39509c48dbe6078
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: mcp/server.py:R6:_prompt_for_database:fp=e071114879cbebc5
  owner: architecture
  reason: Silent recovery with explicit error handling path
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=3f32c48564ee23ba
  owner: architecture
  reason: "KeyError from PayloadStore when payload purged by retention policy \u2014 expected, not corruption"
- key: core/landscape/_query_methods.py:R6:QueryMethodsMixin:explain_row:fp=0ccb1c8df3875bcb
  owner: architecture
  reason: "KeyError from PayloadStore when payload purged by retention policy \u2014 expected, not corruption"
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=9ca89eaa0e651dcf
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36c3f58b638f1aff
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=443894e5bdda8a78
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=36096d44e6d8c088
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=e7368fdf9fa869f8
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=c3e2f9d2af522c9d
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R5:LandscapeExporter:_iter_records:fp=47946a8ab829df41
  owner: P2-2026-02-02-76r
  reason: Discriminated union - NodeState is union of Open/Pending/Completed/Failed with different fields
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=dfa86502fc245865
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=a49774aca3191658
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/exporter.py:R1:LandscapeExporter:_iter_records:fp=e6d0c8334783f7db
  owner: P2-2026-02-02-76r
  reason: Sparse lookup - not all rows have tokens (batch export uses pre-loaded dicts)
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=cd7ae9f783e16f59
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=25eb43eaa792a88a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_normalize_parameters:fp=13a240c282634e6a
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/journal.py:R5:LandscapeJournal:_columns_to_values:fp=8a63a6b78ec0851c
  owner: architecture
  reason: AST/type checking - required for safe parsing or discriminated unions
- key: core/landscape/_call_recording.py:R6:CallRecordingMixin:get_call_response_data:fp=0bc9a6b3b94f93c9
  owner: architecture
  reason: Graceful handling of purged payloads - retention policy may have deleted response data
- key: plugins/clients/http.py:R1:AuditedHTTPClient:post:fp=3c0be6939b9ad68c
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=57f98d9a680c4fe0
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:post:fp=8d0a8a1eebc183ff
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=de1053d26df88b2e
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get:fp=8e3c6282a014e674
  owner: architecture
  reason: HTTP response headers - external system boundary, content-type may be missing
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=828d933917d5becb
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get:fp=fd83274374bde4f7
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=4ca4e2477ece4e30
  owner: architecture
  reason: httpx Client.get() method call - ephemeral client for TLS/SNI isolation
- key: plugins/clients/http.py:R1:AuditedHTTPClient:get_ssrf_safe:fp=218c21461d517b71
  owner: architecture
  reason: httpx Client.get() method call - this is the external HTTP call with IP pinning
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=51570a45a72c0c87
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R4:AuditedHTTPClient:get_ssrf_safe:fp=5592b5008ca0c900
  owner: architecture
  reason: Telemetry emission failure - must not crash main request flow
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=23c341af1cdd3b1e
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
- key: plugins/clients/http.py:R1:AuditedHTTPClient:_follow_redirects_safe:fp=48a4d8f531e7c27d
  owner: architecture
  reason: HTTP redirect Location header - external system boundary, header may be absent
- key: contracts/results.py:R5:ArtifactDescriptor:for_database:fp=2300432a3c93d6b5
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedDatabaseUrl
  safety: TypeError raised if wrong URL type - explicit failure, not masking
  expires: null
- key: contracts/results.py:R5:ArtifactDescriptor:for_webhook:fp=e2fada7e3814d17c
  owner: bugfix
  reason: Tier-3 boundary validation - external URL objects must be verified as SanitizedWebhookUrl
  safety: TypeError raised if wrong URL type - explicit failure, not masking
  expires: null
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=7f5948e29583a6c2
  owner: architecture
  reason: Retry boundary - LLMClientError exception type check for retryable classification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/processor.py:R5:RowProcessor:_execute_transform_with_retry:is_retryable:fp=bd040cba51f112ec
  owner: architecture
  reason: Retry boundary - ConnectionError/TimeoutError/OSError type check for retryable classification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/processor.py:R5:RowProcessor:_resolve_jump_target_on_success_sink:fp=c8930ec890458ee9
  owner: architecture
  reason: Protocol dispatch to detect transforms with on_success during jump-target sink resolution
  safety: Traversal map invariants are enforced; raises on cycles or when no sink and no gate found
  expires: '2026-03-10'
- key: engine/processor.py:R1:RowProcessor:_notify_coalesce_of_lost_branch:fp=d6d89baabae99abd
  owner: architecture
  reason: dict.get() correct - not all branch names have coalesce point mapping
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: engine/processor.py:R5:RowProcessor:_drain_work_queue:fp=5e6c1ee5159312dd
  owner: architecture
  reason: Type dispatch on _process_single_token return (RowResult | list[RowResult] | None)
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=b795c79c66a24d96
  owner: architecture
  reason: Optional _output_schema_config metadata is present only on select plugins
  safety: Missing metadata is handled as None; core schema enforcement still validates edges
  expires: '2026-03-10'
- key: core/dag.py:R2:ExecutionGraph:from_plugin_instances:fp=040094058493eebb
  owner: architecture
  reason: Optional _output_schema_config metadata is present only on select aggregation plugins
  safety: Missing metadata is handled as None; aggregation schemas still validated via contracts
  expires: '2026-03-10'
- key: core/dag.py:R8:ExecutionGraph:from_plugin_instances:fp=becc0a6bb10d141f
  owner: architecture
  reason: setdefault used for route-label grouping while building gate continue-route diagnostics
  safety: Grouping is deterministic and validated before runtime routing
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:from_plugin_instances:fp=c2c848d2204e52cc
  owner: architecture
  reason: Optional gate connection route label lookup for coalesce provenance wiring
  safety: "Missing lookup returns None \u2014 handled explicitly by conditional check"
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:from_plugin_instances:fp=2d3bbc75e801fef6
  owner: architecture
  reason: Gate default-continue target lookup during fallthrough edge wiring
  safety: "Missing target is handled explicitly \u2014 ambiguous gates are skipped"
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:from_plugin_instances:fp=c5f0c5799f15aa20
  owner: architecture
  reason: isinstance check for dict vs NodeConfig on config field during schema population
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:_get_schema_config_from_node:fp=459cacc5e745dc40
  owner: architecture
  reason: Optional schema access for mixed node types (source/sink/gate/coalesce)
  safety: Crashes on malformed schema payloads; None is an intentional non-schema state
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:_get_schema_config_from_node:fp=5b43b3da169508c7
  owner: architecture
  reason: Runtime shape check before coercing schema dict to SchemaConfig
  safety: Non-dict payloads are rejected and converted to explicit validation failures
  expires: '2026-03-10'
- key: core/dag.py:R1:ExecutionGraph:_get_required_fields:fp=a0709616baa7dc8e
  owner: architecture
  reason: Optional required_input_fields key supports transforms with implicit/no required field contract
  safety: Missing key yields empty set; downstream schema checks still enforce compatibility
  expires: '2026-03-10'
- key: core/dag.py:R5:ExecutionGraph:_get_required_fields:fp=a861fff774b8c58b
  owner: architecture
  reason: Options payload shape check at config boundary before extracting nested required_input_fields
  safety: Non-dict options are treated as no declared requirements and never silently coerced
  expires: '2026-03-10'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=7c5419575b2202aa
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/core.py:R5:Orchestrator:_execute_run:fp=4a489b468313543b
  owner: architecture
  reason: Tier 3 boundary - quarantine path handles non-dict source rows
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/core.py:R5:Orchestrator:_process_resumed_rows:fp=2d1ec064511f75a9
  owner: architecture
  reason: Type dispatch - RowPlugin is union of TransformProtocol|GateProtocol, must distinguish to access is_batch_aware
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: engine/orchestrator/aggregation.py:R5:find_aggregation_transform:fp=3be2315780c311dd
  owner: architecture
  reason: isinstance() check required to find batch-aware transforms - protocol contract verification
  safety: Crashes on type mismatch - no silent fallback
  expires: '2026-03-09'
- key: core/checkpoint/serialization.py:R5:_restore_types:fp=4af58e44b9e1dded
  owner: architecture
  reason: "Tier 1 type restoration \u2014 isinstance on our own serialized checkpoint format to detect datetime type tags"
  safety: "Non-str values fall through without coercion \u2014 no silent wrong behavior"
  expires: '2026-03-13'
- key: testing/chaosweb/content_generator.py:R5:PresetBank:from_jsonl:fp=9b96b4652eaaa630
  owner: architecture
  reason: Tier 3 boundary - isinstance validates JSONL line is dict before constructing preset entry
  safety: Non-dict lines are skipped with warning - no silent data loss
  expires: '2026-05-13'
- key: testing/chaosweb/content_generator.py:R1:PresetBank:from_jsonl:fp=0817f8db37beaf7c
  owner: architecture
  reason: Tier 3 boundary - .get() on parsed JSONL object for optional url field
  safety: Missing url defaults to empty string - correct for optional preset metadata
  expires: '2026-05-13'
- key: testing/chaosweb/content_generator.py:R1:PresetBank:from_jsonl:fp=42bd4603bea783bd
  owner: architecture
  reason: Tier 3 boundary - .get() on parsed JSONL object for optional content_type field
  safety: Missing content_type defaults to text/html - correct for HTML preset pages
  expires: '2026-05-13'
- key: testing/chaosweb/content_generator.py:R1:ContentGenerator:_generate_preset_html:fp=f14d5eed4882098d
  owner: architecture
  reason: Tier 3 boundary - .get() on preset page dict for optional content_type override
  safety: Falls back to config default_content_type - preset pages may omit content_type
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R1:ChaosWebServer:_page_endpoint:fp=b1a7475ca2ec6ad8
  owner: architecture
  reason: Tier 3 boundary - .get() on Starlette path_params dict (HTTP request data)
  safety: Missing path defaults to empty string - correct for catch-all route
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R1:ChaosWebServer:_page_endpoint:fp=356e4e65a64206cd
  owner: architecture
  reason: Tier 3 boundary - .get() on HTTP request headers (optional header override)
  safety: Missing header defaults to None - no override applied
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R5:ChaosWebServer:_handle_connection_error:fp=e84a303908b0e6ad
  owner: architecture
  reason: isinstance check on content generator output (str vs bytes) for encoding
  safety: Both branches produce valid bytes for HTTP response body
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R1:ChaosWebServer:_handle_http_error:fp=b4ed75053835fcaa
  owner: architecture
  reason: .get() on error message mapping - fallback for error types not in mapping
  safety: Falls back to generic status code message - never swallows errors
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R5:ChaosWebServer:_handle_malformed_content:fp=762539baa0bade9f
  owner: architecture
  reason: isinstance check on WebResponse.content (str|bytes) to extract str for corruption helpers
  safety: Bytes decoded with replace - corruption helpers always receive valid str input
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R5:ChaosWebServer:_handle_malformed_content:fp=6031dd683d80b200
  owner: architecture
  reason: isinstance check on content (str vs bytes) for wrong_content_type HTTP response encoding
  safety: Both branches produce valid bytes for Response body
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R5:ChaosWebServer:_handle_success:fp=85671d97e81fc16d
  owner: architecture
  reason: isinstance check on content generator output (str vs bytes) for HTTP response encoding
  safety: Both branches produce valid bytes for Response body
  expires: '2026-05-13'
- key: testing/chaosweb/server.py:R4:ChaosWebServer:_record_request:fp=f02bc49b98ba1487
  owner: architecture
  reason: Metrics isolation - recording is best-effort side-effect that must not crash HTTP responses
  safety: Exception logged via structlog with request_id and exc_info; intended chaos response always served
  expires: '2026-05-13'
- key: testing/chaosweb/cli.py:R6:_version_callback:fp=86387baacbcfc9ec
  owner: architecture
  reason: Silent recovery with explicit error handling path
  safety: Falls back to 'version unknown' on ImportError - correct for optional version detection
  expires: '2026-05-13'
- key: testing/chaosweb/cli.py:R6:show_config:fp=ed8499ffbc8fd80e
  owner: architecture
  reason: Silent recovery with explicit error handling path - YAML optional fallback to JSON
  safety: Falls back to JSON format if yaml module unavailable - data still displayed
  expires: '2026-05-13'
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=4c2151c04e745b11
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Explicit isinstance branching for AST eval result types
  expires: '2026-05-13'
- key: engine/executors.py:R5:GateExecutor:execute_config_gate:fp=db330ed83b1d185b
  owner: architecture
  reason: AST/type checking - ExpressionParser returns Any; must distinguish bool/str for route label conversion
  safety: Explicit isinstance branching for AST eval result types
  expires: '2026-05-13'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=6f906b66bee82f87
  owner: architecture
  reason: Optional edge_id lookup - edge map may not have all node combinations during routing
  safety: Falls back to generating edge_id when not in prebuilt map
  expires: '2026-05-13'
- key: engine/executors.py:R1:GateExecutor:_record_routing:fp=f85d85215d3e8828
  owner: architecture
  reason: Optional edge_id lookup - edge map may not have all node combinations during routing
  safety: Falls back to generating edge_id when not in prebuilt map
  expires: '2026-05-13'
- key: engine/processor.py:R5:RowProcessor:_resolve_jump_target_on_success_sink:fp=14c6ab0bb0a21592
  owner: architecture
  reason: Protocol dispatch to detect self-routing gates during jump-target sink resolution
  safety: isinstance for NodeType discrimination in unified node processing
  expires: '2026-05-13'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=ebd4d3689544a4d8
  owner: architecture
  reason: Protocol dispatch - isinstance for plugin type routing in unified node traversal
  safety: isinstance for NodeType discrimination - TransformProtocol vs GateSettings
  expires: '2026-05-13'
- key: engine/processor.py:R5:RowProcessor:_process_single_token:fp=70519330cd97fa26
  owner: architecture
  reason: Protocol dispatch - isinstance for plugin type routing in unified node traversal
  safety: isinstance for NodeType discrimination - TransformProtocol vs GateSettings
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=99aa4256034d0404
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional fields from external HTTP clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=40d716b87ce5675c
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional fields from external HTTP clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=21a073b8bdc2c154
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional fields from external HTTP clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_completion_request:fp=684c59dc629d693e
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional fields from external HTTP clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=8ccabe4dfc512dc8
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional response fields from external clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R1:ChaosLLMServer:_handle_success_response:fp=9b9ba02d9dfdb908
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get with defaults for optional response fields from external clients
  expires: '2026-05-13'
- key: testing/chaosllm/server.py:R4:ChaosLLMServer:_record_request:fp=16ec1dd670ebe4e1
  owner: architecture
  reason: Metrics isolation - recording is best-effort side-effect that must not crash HTTP responses
  safety: Exception logged via structlog with request_id and exc_info; intended chaos response always served
  expires: '2026-05-13'
- key: testing/chaosllm/config.py:R5:ErrorInjectionConfig:parse_range:fp=9d09ec61470d8455
  owner: architecture
  reason: Pydantic before-validator - isinstance checks raw YAML value type for range coercion
  safety: Validates Tier 3 YAML input before Pydantic model creation
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R5:PresetBank:from_jsonl:fp=c14f6a959a0385a0
  owner: architecture
  reason: Tier 3 boundary - isinstance validates parsed JSONL line is dict
  safety: Validates external file content structure
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=6ff12e014ac3cbd7
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_template_response:fp=8bcf17d15986431d
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=d2a90a0c04d1f1b0
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=68fb557610a08852
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=cfdb493affb7fb83
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_generate_echo_response:fp=fa01d45bd87c173d
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in OpenAI-compatible request body
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=af838a83c3fbd3d2
  owner: architecture
  reason: External HTTP request body - messages array traversal per OpenAI spec (Tier 3)
  safety: dict.get for optional content field in message objects
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=95e0276c1540d59b
  owner: architecture
  reason: External HTTP request body - messages array traversal per OpenAI spec (Tier 3)
  safety: dict.get for optional content field in message objects
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:_extract_prompt_text:fp=028bad60809f8671
  owner: architecture
  reason: External HTTP request body - messages array traversal per OpenAI spec (Tier 3)
  safety: dict.get for optional content field in message objects
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=658faf2e31f47380
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in request body from external clients
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=0c97355ecc79a154
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in request body from external clients
  expires: '2026-05-13'
- key: testing/chaosllm/response_generator.py:R1:ResponseGenerator:generate:fp=0931b20c21d4268d
  owner: architecture
  reason: External HTTP request body - optional fields per OpenAI spec (Tier 3)
  safety: dict.get for optional fields in request body from external clients
  expires: '2026-05-13'
- key: testing/chaosengine/metrics_store.py:R7:MetricsStore:close:fp=0c670d81190e126c
  owner: architecture
  reason: contextlib.suppress on ProgrammingError during connection cleanup
  safety: Only suppresses error for already-closed connections during teardown
  expires: '2026-05-13'
- key: testing/chaosengine/config_loader.py:R5:deep_merge:fp=d90637e14460de3a
  owner: architecture
  reason: Type dispatch for recursive merge - isinstance(dict) for nested structure
  safety: Recursive merge must distinguish dict from leaf values
  expires: '2026-05-13'
- key: testing/chaosengine/config_loader.py:R5:deep_merge:fp=8b73206ee5e565c4
  owner: architecture
  reason: Type dispatch for recursive merge - isinstance(dict) for nested structure
  safety: Recursive merge must distinguish dict from leaf values
  expires: '2026-05-13'
- key: testing/chaosengine/config_loader.py:R5:load_preset:fp=3103a5332f99a196
  owner: architecture
  reason: Tier 3 boundary - isinstance validates parsed YAML is dict before Pydantic
  safety: Validates external file content structure type
  expires: '2026-05-13'
- key: testing/chaosweb/config.py:R5:WebErrorInjectionConfig:parse_range:fp=9c20553e8b6645d7
  owner: architecture
  reason: Pydantic before-validator - isinstance checks raw YAML value type for range coercion
  safety: Validates Tier 3 YAML input before Pydantic model creation
  expires: '2026-05-13'
