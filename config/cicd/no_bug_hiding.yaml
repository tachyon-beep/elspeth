version: 1
defaults:
  fail_on_stale: true
  fail_on_expired: true
allow_hits:
- key: tui/screens/explain_screen.py:R4:ExplainScreen:_load_pipeline_structure:line=165
  owner: architecture
  reason: 'Trust boundary: loading pipeline structure that may fail for corrupt/incomplete runs'
  safety: Errors logged with exc_info; returns LoadingFailedState with error message
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=56
  owner: architecture
  reason: 'Optional field: state_id may be missing before execution'
  safety: Graceful degradation to 'N/A' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=59
  owner: architecture
  reason: 'Optional field: token_id may be missing before execution'
  safety: Graceful degradation to 'N/A' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=64
  owner: architecture
  reason: 'Optional field: status may be missing before execution'
  safety: Graceful degradation to 'N/A' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=67
  owner: architecture
  reason: 'Optional field: started_at may be missing before execution'
  safety: Graceful degradation to 'N/A' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=69
  owner: architecture
  reason: 'Optional field: completed_at may be missing before execution'
  safety: Graceful degradation to 'N/A' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=71
  owner: architecture
  reason: 'Optional field: duration_ms may be missing before execution'
  safety: Graceful degradation - conditionally displayed
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=78
  owner: architecture
  reason: 'Optional field: input_hash may be missing before execution'
  safety: Graceful degradation to '(none)' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=79
  owner: architecture
  reason: 'Optional field: output_hash may be missing before execution'
  safety: Graceful degradation to '(none)' - user sees partial data
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=86
  owner: architecture
  reason: 'Optional field: error_json may be missing'
  safety: Graceful degradation - error section conditionally shown
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=98
  owner: architecture
  reason: 'Trust boundary: displaying error type from JSON that may be malformed'
  safety: Graceful degradation to 'unknown' - user sees partial error info
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=99
  owner: architecture
  reason: 'Trust boundary: displaying error message from JSON that may be malformed'
  safety: Graceful degradation to 'unknown' - user sees partial error info
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=110
  owner: architecture
  reason: 'Trust boundary: state_id lookup for logging context'
  safety: None is safe - just means unknown state_id in log message
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=119
  owner: architecture
  reason: 'Optional field: artifact may be missing for non-sink nodes'
  safety: Graceful degradation - artifact section conditionally shown
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=125
  owner: architecture
  reason: 'Trust boundary: displaying artifact_id that may be malformed'
  safety: Graceful degradation to 'N/A' - user sees partial artifact info
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=126
  owner: architecture
  reason: 'Trust boundary: displaying path_or_uri that may be malformed'
  safety: Graceful degradation to 'N/A' - user sees partial artifact info
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=127
  owner: architecture
  reason: 'Trust boundary: displaying content_hash that may be malformed'
  safety: Graceful degradation to 'N/A' - user sees partial artifact info
  expires: null
- key: tui/widgets/node_detail.py:R1:NodeDetailPanel:render_content:line=131
  owner: architecture
  reason: 'Trust boundary: displaying size_bytes that may be malformed'
  safety: Graceful degradation - conditionally displayed
  expires: null
- key: plugins/manager.py:R3:_schema_hash:line=50
  owner: architecture
  reason: 'Trust boundary: checking if plugin class has Pydantic model_fields'
  safety: Raises TypeError if not Pydantic - fails fast on protocol violation
  expires: null
- key: plugins/manager.py:R2:PluginSpec:from_plugin:line=94
  owner: architecture
  reason: 'Polymorphic: sources don''t have input_schema, sinks don''t have output_schema'
  safety: Legitimate Optional return - None means 'accepts any schema'
  expires: null
- key: plugins/manager.py:R2:PluginSpec:from_plugin:line=95
  owner: architecture
  reason: 'Polymorphic: sources don''t have input_schema, sinks don''t have output_schema'
  safety: Legitimate Optional return - None means 'accepts any schema'
  expires: null
- key: contracts/data.py:R1:validate_row:line=101
  owner: architecture
  reason: 'Trust boundary: Pydantic error dict may not have ''input'' key'
  safety: Graceful handling - validation error message still produced
  expires: null
- key: contracts/schema.py:R1:SchemaConfig:from_dict:line=199
  owner: architecture
  reason: 'Round-trip serialization: to_dict() outputs mode=''dynamic'', from_dict() must accept it'
  safety: Explicit check for serialized form before standard parsing - enables audit trail storage
  expires: null
- key: contracts/data.py:R3:_type_name:line=199
  owner: architecture
  reason: 'Type introspection: not all types have __name__ attribute'
  safety: Graceful fallback to str() - error message still produced
  expires: null
- key: engine/retry.py:R1:RetryConfig:from_policy:line=80
  owner: architecture
  reason: 'Trust boundary: external policy dict may have invalid/missing values'
  safety: max() ensures minimum valid value, docstring documents this behavior
  expires: null
- key: engine/retry.py:R1:RetryConfig:from_policy:line=81
  owner: architecture
  reason: 'Trust boundary: external policy dict may have invalid/missing values'
  safety: max() ensures minimum valid value, docstring documents this behavior
  expires: null
- key: engine/retry.py:R1:RetryConfig:from_policy:line=82
  owner: architecture
  reason: 'Trust boundary: external policy dict may have invalid/missing values'
  safety: max() ensures minimum valid value, docstring documents this behavior
  expires: null
- key: engine/retry.py:R1:RetryConfig:from_policy:line=83
  owner: architecture
  reason: 'Trust boundary: external policy dict may have invalid/missing values'
  safety: max() ensures minimum valid value, docstring documents this behavior
  expires: null
- key: core/config.py:R1:_expand_env_vars:_expand_string:replacer:line=787
  owner: architecture
  reason: 'Trust boundary: environment variables are external input that may not exist'
  safety: Explicit None check follows; falls back to default or keeps original for later error
  expires: null
- key: core/config.py:R1:_fingerprint_config_for_audit:line=1052
  owner: architecture
  reason: 'Optional env var: ELSPETH_ALLOW_RAW_SECRETS is not required in production'
  safety: Missing env var = empty string = False = production mode (fail-closed)
  expires: null
- key: plugins/sinks/database_sink.py:R1:DatabaseSink:__init__:line=93
  owner: architecture
  reason: 'Trust boundary: ELSPETH_ALLOW_RAW_SECRETS is optional env var (not required in production)'
  safety: Missing env var = empty string = False = production mode (fail-closed), consistent with config.py:992
  expires: null
- key: plugins/clients/llm.py:R1:LLMResponse:total_tokens:line=45
  owner: architecture
  reason: 'Trust boundary: LLM API usage dict may not include all token counts'
  safety: Graceful default to 0 - total_tokens is convenience property, not critical
  expires: null
- key: plugins/clients/llm.py:R3:AuditedLLMClient:chat_completion:line=316
  owner: architecture
  reason: 'SDK version compatibility: older OpenAI SDK versions lack model_dump()'
  safety: None is safe for raw_response - only used for debugging, not audit
  expires: null
- key: plugins/clients/http.py:R1:AuditedHTTPClient:post:line=166
  owner: architecture
  reason: 'Trust boundary: HTTP response headers from external server may lack content-type'
  safety: Graceful default to empty string - treats as non-JSON, still records body
  expires: null
- key: plugins/llm/azure_batch.py:R3:AzureBatchLLMTransform:_get_checkpoint:line=284
  owner: architecture
  reason: 'Capability check: verify checkpoint API exists before using it'
  safety: Raises RuntimeError if method doesn't exist - fail-fast, not silent degradation
  expires: null
- key: plugins/llm/azure_batch.py:R3:AzureBatchLLMTransform:_update_checkpoint:line=301
  owner: architecture
  reason: 'Capability check: verify checkpoint API exists before using it'
  safety: Raises RuntimeError if method doesn't exist - fail-fast, not silent degradation
  expires: null
- key: plugins/llm/azure_batch.py:R3:AzureBatchLLMTransform:_clear_checkpoint:line=317
  owner: architecture
  reason: 'Capability check: verify checkpoint API exists before using it'
  safety: Raises RuntimeError if method doesn't exist - fail-fast, not silent degradation
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_process_batch:line=265
  owner: architecture
  reason: Checkpoint may be None or empty dict - checking for batch_id existence
  safety: None/missing batch_id means PHASE 1 (fresh submit), explicit logic follows
  expires: null
- key: plugins/llm/azure_batch.py:R4:AzureBatchLLMTransform:_submit_batch:line=415
  owner: architecture
  reason: 'Trust boundary: Azure files.create API call (external system boundary)'
  safety: Caught, recorded via ctx.record_call(ERROR), returns TransformResult.error(retryable=True)
  expires: null
- key: plugins/llm/azure_batch.py:R4:AzureBatchLLMTransform:_submit_batch:line=454
  owner: architecture
  reason: 'Trust boundary: Azure batches.create API call (external system boundary)'
  safety: Caught, recorded via ctx.record_call(ERROR), returns TransformResult.error(retryable=True)
  expires: null
- key: plugins/llm/azure_batch.py:R4:AzureBatchLLMTransform:_check_batch_status:line=534
  owner: architecture
  reason: 'Trust boundary: Azure batches.retrieve API call (external system boundary)'
  safety: Caught, recorded via ctx.record_call(ERROR), returns TransformResult.error(retryable=True)
  expires: null
- key: plugins/llm/azure_batch.py:R4:AzureBatchLLMTransform:_download_results:line=662
  owner: architecture
  reason: 'Trust boundary: Azure files.content API call (external system boundary)'
  safety: Caught, recorded via ctx.record_call(ERROR), returns TransformResult.error(retryable=True)
  expires: null
- key: plugins/llm/azure_batch.py:R2:AzureBatchLLMTransform:_check_batch_status:line=530
  owner: architecture
  reason: 'Trust boundary: Azure batch.output_file_id only exists on completed batches'
  safety: Recorded as None in audit trail - field is informational only
  expires: null
- key: plugins/llm/azure_batch.py:R3:AzureBatchLLMTransform:_check_batch_status:line=566
  owner: architecture
  reason: 'Trust boundary: Azure batch.errors may not exist on all batch statuses'
  safety: Graceful handling - error info still returned without detailed errors
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_check_batch_status:line=594
  owner: architecture
  reason: submitted_at may not exist in old checkpoint format
  safety: Missing submitted_at skips timeout check - graceful degradation
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=639
  owner: architecture
  reason: row_mapping may not exist in corrupted checkpoint
  safety: Empty dict default allows graceful recovery - rows return with error
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=640
  owner: architecture
  reason: template_errors may not exist in old checkpoint format
  safety: Empty list default means no template errors tracked - graceful degradation
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=698
  owner: architecture
  reason: 'Trust boundary: Azure JSONL result custom_id field validated as external data'
  safety: None check follows on next line - returns error row if missing
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=740
  owner: architecture
  reason: 'Intentional Optional API: rows with template errors aren''t in mapping'
  safety: None is checked explicitly on next line with 'if custom_id is None'
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=756
  owner: architecture
  reason: 'Trust boundary: Azure batch result ''error'' field is optional'
  safety: Graceful handling - checks for error before extracting response
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=768
  owner: architecture
  reason: 'Trust boundary: Azure batch result ''response'' field structure varies'
  safety: Graceful default to {} - handles missing/malformed responses
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=769
  owner: architecture
  reason: 'Trust boundary: Azure batch response ''body'' field may be missing'
  safety: Graceful default to {} - handles missing/malformed responses
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=770
  owner: architecture
  reason: 'Trust boundary: Azure batch response ''choices'' field may be missing'
  safety: Graceful default to [] - explicit check for empty choices follows
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=773
  owner: architecture
  reason: 'Trust boundary: Azure choice message.content structure may vary'
  safety: Graceful default to empty string - empty content is valid for audit trail
  expires: null
- key: plugins/llm/azure_batch.py:R1:AzureBatchLLMTransform:_download_results:line=774
  owner: architecture
  reason: 'Trust boundary: Azure response usage field is optional'
  safety: Graceful default to {} - usage is metadata, not critical
  expires: null
- key: plugins/discovery.py:R2:_discover_in_file:line=125
  owner: architecture
  reason: 'Trust boundary: scanning arbitrary classes that may or may not have ''name'' attribute'
  safety: Classes without valid name are skipped with warning log - discovery continues
  expires: null
- key: plugins/discovery.py:R2:get_plugin_description:line=232
  owner: architecture
  reason: 'UI display fallback: generating human-readable description for classes without ''name'' attr'
  safety: Falls back to class __name__ for display - no control flow or audit impact
  expires: null
- key: cli.py:R1:_execute_pipeline:_format_run_completed:line=578
  owner: architecture
  reason: 'Intentional Optional API: status_symbols lookup with default for unknown statuses'
  safety: Default '?' symbol for unrecognized statuses - output still produced
  expires: null
- key: cli.py:R1:_execute_pipeline_with_instances:_format_run_completed:line=790
  owner: architecture
  reason: 'Intentional Optional API: status_symbols lookup with default for unknown statuses'
  safety: Default '?' symbol for unrecognized statuses - output still produced
  expires: null
- key: cli.py:R1:_execute_resume_with_instances:_format_run_completed:line=1220
  owner: architecture
  reason: 'Intentional Optional API: status_symbols lookup with default for unknown statuses'
  safety: Default '?' symbol for unrecognized statuses - output still produced
  expires: null
- key: core/events.py:R1:EventBus:emit:line=83
  owner: architecture
  reason: 'Intentional Optional API: checking subscription presence, not hiding missing keys'
  safety: Empty list default means 'no subscribers' - documented behavior, events are decoupled
  expires: null
- key: core/security/fingerprint.py:R1:get_fingerprint_key:line=77
  owner: architecture
  reason: 'Trust boundary: ELSPETH_FINGERPRINT_KEY is optional external input (dev mode)'
  safety: 'Explicit check: if not set, falls through to Key Vault check or raises ValueError'
  expires: null
- key: core/security/fingerprint.py:R1:get_fingerprint_key:line=82
  owner: architecture
  reason: 'Trust boundary: ELSPETH_KEYVAULT_URL is optional external input (production mode)'
  safety: 'Explicit check: if not set, raises ValueError with guidance on configuration'
  expires: null
- key: core/security/fingerprint.py:R1:get_fingerprint_key:line=84
  owner: architecture
  reason: 'Trust boundary: ELSPETH_KEYVAULT_SECRET_NAME is optional with sensible default'
  safety: Default 'elspeth-fingerprint-key' used when not set - documented behavior
  expires: null
- key: contracts/results.py:R3:ArtifactDescriptor:for_database:line=239
  owner: architecture
  reason: 'Security boundary: enforce SanitizedDatabaseUrl to prevent credentials in audit trail'
  safety: Raises TypeError with guidance to use SanitizedDatabaseUrl.from_raw_url()
  expires: null
- key: contracts/results.py:R3:ArtifactDescriptor:for_webhook:line=270
  owner: architecture
  reason: 'Security boundary: enforce SanitizedWebhookUrl to prevent tokens in audit trail'
  safety: Raises TypeError with guidance to use SanitizedWebhookUrl.from_raw_url()
  expires: null
- key: plugins/validation.py:R4:PluginConfigValidator:validate_schema_config:line=229
  owner: architecture
  reason: 'Trust boundary: SchemaConfig.from_dict may raise ValueError or other exceptions from field
    parsing'
  safety: Converts to structured ValidationError - unexpected errors still reported to caller
  expires: null
- key: plugins/validation.py:R1:PluginConfigValidator:_extract_errors:line=349
  owner: architecture
  reason: 'Trust boundary: Pydantic error dict structure from external library - ''input'' field is optional'
  safety: Graceful default to '<unknown>' - error message still produced with field and message
  expires: null
- key: cli.py:R1:health:line=1584
  owner: architecture
  reason: 'Trust boundary: environment variable GIT_COMMIT_SHA is optional external input'
  safety: Empty string default is safe - commit SHA is informational only
  expires: null
- key: cli.py:R4:health:line=1596
  owner: architecture
  reason: 'Trust boundary: git subprocess may fail for many reasons (not installed, not a repo, etc.)'
  safety: Graceful fallback to 'unknown' - health check reports git as unavailable
  expires: null
- key: cli.py:R1:health:line=1612
  owner: architecture
  reason: 'Trust boundary: environment variable DATABASE_URL is optional external input'
  safety: Empty string default triggers skip logic - database check only runs if configured
  expires: null
- key: cli.py:R4:health:line=1624
  owner: architecture
  reason: 'Trust boundary: database connection may fail for many reasons (network, auth, etc.)'
  safety: Error recorded in checks dict with status='error' - health check reports DB as unhealthy
  expires: null
- key: cli.py:R4:health:line=1688
  owner: architecture
  reason: 'Trust boundary: plugin manager initialization may fail due to misconfiguration'
  safety: Error recorded in checks dict with status='error' - health check reports plugins as unhealthy
  expires: null
- key: plugins/azure/blob_source.py:R4:AzureBlobSource:_load_csv:line=383
  owner: architecture
  reason: 'Trust boundary: CSV parsing can fail in many ways (encoding, malformed data, etc.)'
  safety: Logged and row quarantined with full error details
  expires: null
- key: engine/orchestrator.py:R4:Orchestrator:_cleanup_transforms:line=232
  owner: architecture
  reason: 'Cleanup path exception: best-effort plugin close() in finally block - crash would prevent other
    plugins from cleanup'
  safety: Errors logged with full details, then raised after all cleanups attempted
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_validate_route_destinations:line=274
  owner: architecture
  reason: Building lookup for gate names - only gates (not transforms) are in map
  safety: None means not a gate at this sequence - correctly skipped
  expires: null
- key: engine/orchestrator.py:R2:Orchestrator:_validate_source_quarantine_destination:line=370
  owner: architecture
  reason: Optional protocol extension - _on_validation_failure only on sources with SourceDataConfig
  safety: None default means source doesn't support quarantine routing - validation skipped
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_execute_run:line=709
  owner: architecture
  reason: Optional schema config with explicit default - not all nodes define schemas
  safety: 'Default value is well-defined: dynamic fields'
  expires: null
- key: core/dag.py:R1:ExecutionGraph:_get_missing_required_fields:line=1015
  owner: architecture
  reason: 'Trust boundary: Pydantic model_config may not have ''extra'' key (defaults to ''forbid'')'
  safety: Checking for dynamic schema marker - missing 'extra' key means not dynamic
  expires: null
- key: core/dag.py:R1:ExecutionGraph:_get_missing_required_fields:line=1016
  owner: architecture
  reason: 'Trust boundary: Pydantic model_config may not have ''extra'' key (defaults to ''forbid'')'
  safety: Checking for dynamic schema marker - missing 'extra' key means not dynamic
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_validate_route_destinations:line=281
  owner: architecture
  reason: Building lookup for config gate names - only config gates are in map
  safety: None means not a config gate - correctly skipped
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_validate_route_destinations:line=297
  owner: architecture
  reason: Fallback for error message - use node_id if gate name not found
  safety: Error message still produced with node_id as fallback
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_reconstruct_schema_from_json:line=1366
  owner: architecture
  reason: 'Trust boundary: JSON schema properties field is optional'
  safety: None check with explicit fallback to empty schema
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_reconstruct_schema_from_json:line=1379
  owner: architecture
  reason: 'Trust boundary: JSON schema required field is optional'
  safety: Empty list default is safe
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_json_schema_to_python_type:line=1420
  owner: architecture
  reason: 'Trust boundary: JSON schema type/format fields may be missing'
  safety: None check with type-specific handling
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_json_schema_to_python_type:line=1428
  owner: architecture
  reason: 'Trust boundary: JSON schema anyOf items may not have type field'
  safety: None filtered out in set comprehension
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_json_schema_to_python_type:line=1433
  owner: architecture
  reason: 'Trust boundary: JSON schema type field may be missing'
  safety: Returns Any for unknown types
  expires: null
- key: engine/orchestrator.py:R1:Orchestrator:_json_schema_to_python_type:line=1443
  owner: architecture
  reason: 'Trust boundary: JSON schema items field for arrays may be missing'
  safety: Returns list[Any] for untyped arrays
  expires: null
- key: engine/executors.py:R3:TransformExecutor:_get_batch_adapter:line=154
  owner: architecture
  reason: 'Optional protocol extension: checking if transform supports batch adapter pattern'
  safety: Fallback to non-batch processing if attribute missing
  expires: null
- key: engine/executors.py:R2:TransformExecutor:_get_batch_adapter:line=160
  owner: architecture
  reason: 'Optional protocol extension: pool_size is optional on batch-aware transforms'
  safety: Default value 30 is safe - used for concurrency limiting
  expires: null
- key: engine/executors.py:R3:TransformExecutor:execute_transform:line=231
  owner: architecture
  reason: 'Optional protocol extension: checking if transform has accept() method'
  safety: Non-batch transforms use process() instead - documented fallback
  expires: null
- key: engine/executors.py:R2:TransformExecutor:execute_transform:line=231
  owner: architecture
  reason: 'Optional protocol extension: accept method check paired with hasattr'
  safety: Callable check ensures method is usable if present
  expires: null
- key: engine/executors.py:R2:TransformExecutor:execute_transform:line=272
  owner: architecture
  reason: 'Optional protocol extension: batch_wait_timeout is optional on transforms'
  safety: Default 3600.0 seconds is generous timeout for batch results
  expires: null
- key: engine/executors.py:R2:TransformExecutor:execute_transform:line=302
  owner: architecture
  reason: 'Optional protocol extension: evict_submission is optional on batch transforms'
  safety: None means transform doesn't support submission eviction - gracefully skipped
  expires: null
- key: engine/executors.py:R4:TransformExecutor:execute_transform:line=306
  owner: architecture
  reason: 'Best-effort cleanup: evict_submission failure should not block timeout handling'
  safety: Logged with warning - original timeout error still raised
  expires: null
- key: plugins/llm/openrouter_multi_query.py:R1:OpenRouterMultiQueryLLMTransform:_process_single_query:line=420
  owner: architecture
  reason: 'Trust boundary (Tier 3): OpenRouter API may return different model than requested'
  safety: Graceful fallback to requested model - audit captures actual
  expires: null
- key: plugins/llm/openrouter_multi_query.py:R1:OpenRouterMultiQueryLLMTransform:_process_single_query:line=450
  owner: architecture
  reason: 'Trust boundary (Tier 3): OpenRouter API model field is optional'
  safety: Graceful fallback to configured model - audit captures actual
  expires: null
- key: plugins/llm/openrouter_multi_query.py:R1:OpenRouterMultiQueryLLMTransform:_process_single_query:line=504
  owner: architecture
  reason: 'Trust boundary (Tier 3): OpenRouter API may return different model than requested'
  safety: Graceful fallback to configured model - audit captures actual
  expires: null
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_process_and_complete:line=231
  owner: architecture
  reason: 'Trust boundary: batch processing can fail for many reasons (API errors, timeouts)'
  safety: Caught, logged, and result emitted with error status for audit trail
  expires: null
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:line=288
  owner: architecture
  reason: 'Background thread cleanup: iteration failure should not crash release loop'
  safety: Logged with error, loop continues to process remaining results
  expires: null
- key: plugins/batching/mixin.py:R4:BatchTransformMixin:_release_loop:line=301
  owner: architecture
  reason: 'Background thread emit: emit failure should not crash release loop'
  safety: Logged with error, loop continues - waiter will timeout if emit fails
  expires: null
- key: core/landscape/database.py:R1:LandscapeDB:_validate_schema:line=137
  owner: architecture
  reason: 'Trust boundary: SQLAlchemy inspector FK dict structure from external library'
  safety: Graceful handling of missing fields in FK metadata
  expires: null
- key: engine/executors.py:R1:GateExecutor:execute_gate:line=537
  owner: architecture
  reason: Lookup with explicit None check - raises MissingEdgeError if not found
  safety: Raises immediately with node_id and label for debugging
  expires: null
- key: engine/executors.py:R1:GateExecutor:_record_routing:line=814
  owner: architecture
  reason: Lookup with explicit None check - raises MissingEdgeError if not found
  safety: Raises immediately with node_id and label for debugging
  expires: null
- key: engine/executors.py:R1:GateExecutor:_record_routing:line=828
  owner: architecture
  reason: Lookup with explicit None check - raises MissingEdgeError if not found
  safety: Raises immediately with node_id and label for debugging
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:buffer_row:line=915
  owner: architecture
  reason: Checking if batch exists to decide whether to create one
  safety: None means create new batch - explicit conditional logic follows
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:buffer_row:line=940
  owner: architecture
  reason: Optional trigger evaluator lookup - not all aggregations have config
  safety: None means no trigger config - correctly skipped
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_rows:line=953
  owner: architecture
  reason: 'Intentional Optional API: returns empty list for unknown node_id'
  safety: Empty list is safe default - no rows buffered yet
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffered_tokens:line=964
  owner: architecture
  reason: 'Intentional Optional API: returns empty list for unknown node_id'
  safety: Empty list is safe default - no tokens buffered yet
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:line=979
  owner: architecture
  reason: 'Intentional Optional API: returns empty list for unknown node_id'
  safety: Empty list is safe default - no rows buffered
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_get_buffered_data:line=980
  owner: architecture
  reason: 'Intentional Optional API: returns empty list for unknown node_id'
  safety: Empty list is safe default - no tokens buffered
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:line=1014
  owner: architecture
  reason: 'Explicit existence check: raises RuntimeError if batch_id is None'
  safety: Raises immediately with node_id for debugging
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:line=1019
  owner: architecture
  reason: Existence check paired with explicit RuntimeError if empty
  safety: Raises immediately if buffer is empty
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:line=1020
  owner: architecture
  reason: Token buffer lookup matches row buffer lookup pattern
  safety: Empty list default paired with row buffer check
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_batch_id:line=1402
  owner: architecture
  reason: 'Intentional Optional API: returns None if no batch exists for node_id'
  safety: None return is expected API behavior
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:should_flush:line=1413
  owner: architecture
  reason: 'Intentional Optional API: returns False if no evaluator exists for node_id'
  safety: False return is safe default - no flush needed
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_trigger_type:line=1427
  owner: architecture
  reason: 'Intentional Optional API: returns None if no evaluator exists for node_id'
  safety: None return is expected API behavior
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_restored_state:line=1456
  owner: architecture
  reason: 'Intentional Optional API: returns None if no state was restored for node_id'
  safety: None return is expected API behavior
  expires: null
- key: engine/executors.py:R4:SinkExecutor:write:line=1681
  owner: architecture
  reason: 'Post-durability callbacks: checkpoint callback fails after durable sink write'
  safety: Logged with error - sink artifact exists but checkpoint failed, resume will replay
  expires: null
- key: plugins/llm/openrouter.py:R1:OpenRouterLLMTransform:_process_row:line=301
  owner: architecture
  reason: 'Trust boundary (Tier 3): HTTP response headers may not include content-type'
  safety: Graceful default to 'unknown' - used for error reporting only
  expires: null
- key: plugins/llm/openrouter.py:R1:OpenRouterLLMTransform:_process_row:line=326
  owner: architecture
  reason: 'Trust boundary (Tier 3): OpenRouter API usage field is optional in response'
  safety: Graceful default to {} - usage is metadata, not critical for processing
  expires: null
- key: plugins/llm/openrouter.py:R1:OpenRouterLLMTransform:_process_row:line=338
  owner: architecture
  reason: 'Trust boundary (Tier 3): OpenRouter API may return different model than requested'
  safety: Graceful fallback to requested model - audit still captures actual value
  expires: null
- key: tui/screens/explain_screen.py:R4:ExplainScreen:_load_node_state:line=266
  owner: architecture
  reason: 'Trust boundary: loading node state that may fail for incomplete audit trails'
  safety: Errors logged with exc_info; returns None to detail panel
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:execute_flush:line=1189
  owner: architecture
  reason: Optional trigger evaluator lookup - not all aggregations have trigger config
  safety: None means no trigger config - correctly skipped
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:_reset_batch_state:line=1201
  owner: architecture
  reason: 'Idempotent cleanup: batch_id may not exist if already reset'
  safety: None means already cleaned up or never existed - correctly skipped
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_buffer_count:line=1216
  owner: architecture
  reason: 'Intentional Optional API: returns 0 for unknown node_id'
  safety: 0 is safe default - no rows buffered
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_checkpoint_state:line=1256
  owner: architecture
  reason: Optional trigger evaluator lookup for elapsed time - not all aggregations have trigger config
  safety: None means no trigger config - elapsed_age_seconds defaults to 0.0
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:get_checkpoint_state:line=1270
  owner: architecture
  reason: 'Intentional Optional API: batch_id lookup for node_id'
  safety: None is safe - means no batch exists yet, recorded as null in checkpoint
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:line=1318
  owner: architecture
  reason: 'Optional field: _version in checkpoint state for migration compatibility'
  safety: None check with explicit fallback to legacy format
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:line=1367
  owner: architecture
  reason: 'Optional field: branch_name in TokenInfo is None by default (not forked)'
  safety: None default handled by dataclass
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:line=1376
  owner: architecture
  reason: 'Optional field: batch_id may not exist in checkpoint (fresh buffer)'
  safety: None check with explicit handling
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:line=1382
  owner: architecture
  reason: Optional trigger evaluator lookup - node may not have trigger config
  safety: None check with conditional elapsed time restoration
  expires: null
- key: engine/executors.py:R1:AggregationExecutor:restore_from_checkpoint:line=1392
  owner: architecture
  reason: 'Optional field: elapsed_age_seconds for Bug #6 timeout preservation (backward compat)'
  safety: Default 0.0 if missing - safe for fresh checkpoints
  expires: null
- key: plugins/base.py:R1:BaseGate:__init__:line=161
  owner: architecture
  reason: 'Optional field: fork_to validated by GateSettings schema - None when gate does not fork'
  safety: Schema validation guarantees valid type; .get() appropriate for optional field
  expires: null
- key: core/dag.py:R1:ExecutionGraph:_get_missing_required_fields:line=1019
  owner: architecture
  reason: 'Pydantic model_config: extra key is optional in Pydantic ConfigDict'
  safety: Returns None when extra not set (Pydantic default behavior)
  expires: null
- key: core/dag.py:R1:ExecutionGraph:_get_missing_required_fields:line=1020
  owner: architecture
  reason: 'Pydantic model_config: extra key is optional in Pydantic ConfigDict'
  safety: Returns None when extra not set (Pydantic default behavior)
  expires: null
