
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Extensible Layered Secure Pipeline Engine for Transformation and Handling - Security-first orchestration with Bell-LaPadula MLS enforcement">
      
      
        <meta name="author" content="Elspeth Contributors">
      
      
        <link rel="canonical" href="https://elspeth.readthedocs.io/architecture/security-policy/">
      
      
        <link rel="prev" href="../execution-flow/">
      
      
        <link rel="next" href="../adrs/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Security Policy - Elspeth Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elspeth-security-policy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Elspeth Documentation" class="md-header__button md-logo" aria-label="Elspeth Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elspeth Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Security Policy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/johnm-dta/elspeth" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    johnm-dta/elspeth
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/security-model/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../plugins/overview/" class="md-tabs__link">
          
  
  
    
  
  Plugins

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  
    
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api-reference/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Elspeth Documentation" class="md-nav__button md-logo" aria-label="Elspeth Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Elspeth Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/johnm-dta/elspeth" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    johnm-dta/elspeth
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/first-experiment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First Experiment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/security-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/security-controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Execution Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Security Policy
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Security Policy
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#executive-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Executive Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Executive Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-security-guarantees" class="md-nav__link">
    <span class="md-ellipsis">
      Core Security Guarantees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applicable-security-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Applicable Security Levels
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-1-multi-level-security-mls-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 1: Multi-Level Security (MLS) Enforcement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 1: Multi-Level Security (MLS) Enforcement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-bell-lapadula-access-control-model" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Bell-LaPadula Access Control Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.1 Bell-LaPadula Access Control Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rule-1-simple-security-property-no-read-up" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 1: Simple Security Property ("No Read Up")
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-2-star-property-no-write-down" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 2: Star Property ("No Write Down")
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-operating-level-computation" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Operating Level Computation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-bell-lapadula-directionality-data-vs-plugin-operations" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Bell-LaPadula Directionality: Data vs Plugin Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-2-trusted-container-model" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 2: Trusted Container Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 2: Trusted Container Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-classifieddataframe-immutability" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 ClassifiedDataFrame Immutability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-container-creation-rules" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Container Creation Rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Container Creation Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rule-1-datasource-only-factory-method" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 1: Datasource-Only Factory Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-2-transform-classification-preservation" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 2: Transform Classification Preservation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-3-explicit-uplift-only" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 3: Explicit Uplift Only
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-attack-scenario-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Attack Scenario Prevention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-3-immutable-security-policy-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 3: Immutable Security Policy Metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 3: Immutable Security Policy Metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-author-owned-security-policy" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Author-Owned Security Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 Author-Owned Security Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rule-1-immutable-policy-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 1: Immutable Policy Fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-2-registry-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 2: Registry Enforcement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-3-signature-attestation" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 3: Signature Attestation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-frozen-vs-trusted-downgrade-selection" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Frozen vs Trusted Downgrade Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-attack-scenario-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Attack Scenario Prevention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-4-plugin-security-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 4: Plugin Security Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 4: Plugin Security Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-mandatory-baseplugin-inheritance-security-bones" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Mandatory BasePlugin Inheritance ("Security Bones")
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Mandatory BasePlugin Inheritance (&#34;Security Bones&#34;)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rule-1-nominal-typing-requirement" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 1: Nominal Typing Requirement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-2-central-plugin-type-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Rule 2: Central Plugin Type Registry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-defense-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Defense Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-5-frozen-plugin-capability" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 5: Frozen Plugin Capability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 5: Frozen Plugin Capability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-trusted-downgrade-vs-frozen-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Trusted Downgrade vs Frozen Plugins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-trusted-downgrade-pattern-allow_downgradetrue" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Trusted Downgrade Pattern (allow_downgrade=True)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-frozen-plugin-pattern-allow_downgradefalse" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Frozen Plugin Pattern (allow_downgrade=False)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-6-security-critical-exception-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Policy 6: Security-Critical Exception Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy 6: Security-Critical Exception Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-dual-exception-model" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Dual-Exception Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-securityvalidationerror-expected-boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 SecurityValidationError (Expected Boundaries)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-securitycriticalerror-invariant-violations" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 SecurityCriticalError (Invariant Violations)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-emergency-logging" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 Emergency Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-policy-enforcement-layers" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 Policy Enforcement Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#66-compliance-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      6.6 Compliance Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-enforcement-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Policy Enforcement Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Policy Enforcement Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defense-in-depth-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Defense-in-Depth Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-trail-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Trail Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Mapping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Mapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regulatory-framework-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      Regulatory Framework Alignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certification-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Certification Checklist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Related Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Related Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-decision-records-adrs" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Decision Records (ADRs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-guides" class="md-nav__link">
    <span class="md-ellipsis">
      User Guides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#development-guides" class="md-nav__link">
    <span class="md-ellipsis">
      Development Guides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-documents-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Documents (Repository)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Document Metadata
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADR Catalogue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api-reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/core/base-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasePlugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/core/classified-dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ClassifiedDataFrame
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/core/security-level/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SecurityLevel
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Registries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Registries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/registries/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugin Registry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-datasources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-transforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-middlewares/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Middleware
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-sinks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sinks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-aggregators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aggregators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/plugins/generated-baselines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baselines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/pipeline/artifact-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Artifact Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="elspeth-security-policy">Elspeth Security Policy<a class="headerlink" href="#elspeth-security-policy" title="Anchor link to this section">&para;</a></h1>
<p><strong>Document Version</strong>: 1.0
<strong>Last Updated</strong>: 2025-10-26
<strong>Status</strong>: Active
<strong>Classification</strong>: OFFICIAL</p>
<hr />
<h2 id="executive-summary">Executive Summary<a class="headerlink" href="#executive-summary" title="Anchor link to this section">&para;</a></h2>
<p>Elspeth implements a <strong>defense-in-depth security architecture</strong> based on Bell-LaPadula Multi-Level Security (MLS) principles. This policy consolidates 7 Architecture Decision Records (ADRs 002, 002a, 002b, 003, 004, 005, 006) into a cohesive security framework for protecting classified data ranging from UNOFFICIAL to SECRET.</p>
<h3 id="core-security-guarantees">Core Security Guarantees<a class="headerlink" href="#core-security-guarantees" title="Anchor link to this section">&para;</a></h3>
<ol>
<li><strong>Mandatory Access Control (MAC)</strong>: Pipeline-wide security level enforcement based on minimum clearance principle</li>
<li><strong>Immutable Classification</strong>: Data classifications cannot be downgraded once assigned (high water mark)</li>
<li><strong>Plugin Validation</strong>: All plugins undergo security clearance validation before data retrieval</li>
<li><strong>Fail-Fast Enforcement</strong>: Security violations abort pipelines before data access</li>
<li><strong>Fail-Loud Invariants</strong>: Critical security violations trigger emergency logging and platform termination</li>
<li><strong>Defense in Depth</strong>: Multiple independent security layers (type system, runtime checks, policy enforcement, testing)</li>
</ol>
<h3 id="applicable-security-levels">Applicable Security Levels<a class="headerlink" href="#applicable-security-levels" title="Anchor link to this section">&para;</a></h3>
<p>Elspeth uses Australian Protective Security Policy Framework (PSPF) classifications:</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Numeric</th>
<th>Description</th>
<th>Example Use Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>UNOFFICIAL</strong></td>
<td>0</td>
<td>Publicly releasable information</td>
<td>Public datasets, test data, marketing content</td>
</tr>
<tr>
<td><strong>OFFICIAL</strong></td>
<td>1</td>
<td>Government/business information requiring basic protection</td>
<td>Internal reports, business analytics, operational data</td>
</tr>
<tr>
<td><strong>OFFICIAL SENSITIVE</strong></td>
<td>2</td>
<td>Information requiring additional safeguards</td>
<td>Personnel records, procurement data, sensitive research</td>
</tr>
<tr>
<td><strong>PROTECTED</strong></td>
<td>3</td>
<td>High-impact information requiring strong protection</td>
<td>Security assessments, commercial-in-confidence, privacy data</td>
</tr>
<tr>
<td><strong>SECRET</strong></td>
<td>4</td>
<td>Very high-impact information, substantial damage if disclosed</td>
<td>National security, classified research, intelligence data</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="policy-1-multi-level-security-mls-enforcement">Policy 1: Multi-Level Security (MLS) Enforcement<a class="headerlink" href="#policy-1-multi-level-security-mls-enforcement" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-002
<strong>Status</strong>: Mandatory
<strong>Enforcement</strong>: Compile-time (MyPy) + Runtime (suite_runner.py) + Test (CI)</p>
<h3 id="11-bell-lapadula-access-control-model">1.1 Bell-LaPadula Access Control Model<a class="headerlink" href="#11-bell-lapadula-access-control-model" title="Anchor link to this section">&para;</a></h3>
<p>Elspeth implements the <strong>Bell-LaPadula "no read up, no write down"</strong> security model with the following rules:</p>
<h4 id="rule-1-simple-security-property-no-read-up">Rule 1: Simple Security Property ("No Read Up")<a class="headerlink" href="#rule-1-simple-security-property-no-read-up" title="Anchor link to this section">&para;</a></h4>
<blockquote>
<p>A subject (plugin) at a given security level cannot READ information classified at a HIGHER level.</p>
</blockquote>
<p><strong>Implementation</strong>: Plugins with LOWER clearance cannot operate in pipelines with HIGHER operating levels.</p>
<p><strong>Example (REJECTION)</strong>:
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># ❌ ABORTS: UNOFFICIAL datasource cannot operate in SECRET pipeline</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">csv_local</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UNOFFICIAL</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">transform</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_openai</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SECRET</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Operating level = min(UNOFFICIAL, SECRET) = UNOFFICIAL</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># Transform validation: UNOFFICIAL &lt; SECRET → REJECT (insufficient clearance)</span>
</span></code></pre></div></p>
<p><strong>Example (SUCCESS)</strong>:
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># ✅ SUCCESS: SECRET datasource can operate in UNOFFICIAL pipeline (trusted downgrade)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_blob</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SECRET</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nt">allow_downgrade</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Explicit opt-in for trusted downgrade</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="nt">transform</span><span class="p">:</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mock_llm</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UNOFFICIAL</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># Operating level = min(SECRET, UNOFFICIAL) = UNOFFICIAL</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c1"># Datasource validation: UNOFFICIAL &lt; SECRET and allow_downgrade=true → ALLOW (filters data)</span>
</span></code></pre></div></p>
<h4 id="rule-2-star-property-no-write-down">Rule 2: Star Property ("No Write Down")<a class="headerlink" href="#rule-2-star-property-no-write-down" title="Anchor link to this section">&para;</a></h4>
<blockquote>
<p>A subject (plugin) at a given security level cannot WRITE information to a LOWER classification level without explicit authorization.</p>
</blockquote>
<p><strong>Implementation</strong>: Data classifications can only INCREASE via explicit <code>with_uplifted_classification()</code> calls. Downgrade attempts raise <code>SecurityCriticalError</code>.</p>
<p><strong>Example (REJECTION)</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># ❌ CRITICAL ERROR: Classification downgrade violates invariant</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">secret_frame</span> <span class="o">=</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">secret_frame</span><span class="o">.</span><span class="n">with_uplifted_classification</span><span class="p">(</span><span class="n">SecurityLevel</span><span class="o">.</span><span class="n">UNOFFICIAL</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># → Raises SecurityCriticalError! Platform terminates immediately.</span>
</span></code></pre></div></p>
<p><strong>Example (SUCCESS)</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># ✅ SUCCESS: Classification uplift is allowed (high water mark)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">unofficial_frame</span> <span class="o">=</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">UNOFFICIAL</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">unofficial_frame</span><span class="o">.</span><span class="n">with_uplifted_classification</span><span class="p">(</span><span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># → Returns new frame with SECRET classification</span>
</span></code></pre></div></p>
<h3 id="12-operating-level-computation">1.2 Operating Level Computation<a class="headerlink" href="#12-operating-level-computation" title="Anchor link to this section">&para;</a></h3>
<p>The <strong>operating level</strong> is the minimum security level across ALL pipeline components:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">operating_level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">datasource</span><span class="o">.</span><span class="n">security_level</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">transform</span><span class="o">.</span><span class="n">security_level</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">sink1</span><span class="o">.</span><span class="n">security_level</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">sink2</span><span class="o">.</span><span class="n">security_level</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="c1"># ... all other plugins</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Validation Sequence</strong>:</p>
<ol>
<li><strong>Pre-Execution Validation</strong> (fail-fast, before data retrieval):</li>
<li>Collect all plugin security levels</li>
<li>Compute operating level as minimum</li>
<li>Validate each plugin can operate at computed level</li>
<li>
<p>ABORT pipeline if any validation fails</p>
</li>
<li>
<p><strong>Runtime Classification Checks</strong>:</p>
</li>
<li>Datasource creates <code>ClassifiedDataFrame</code> with declared level</li>
<li>Transforms preserve or uplift classification (never downgrade)</li>
<li>
<p>Sinks verify input classification matches expectations</p>
</li>
<li>
<p><strong>Sink Chaining Validation</strong>:</p>
</li>
<li>Each sink validates it can accept the output classification</li>
<li>Chained sinks (artifact pipeline) validate dependency classification compatibility</li>
</ol>
<h3 id="13-bell-lapadula-directionality-data-vs-plugin-operations">1.3 Bell-LaPadula Directionality: Data vs Plugin Operations<a class="headerlink" href="#13-bell-lapadula-directionality-data-vs-plugin-operations" title="Anchor link to this section">&para;</a></h3>
<p><strong>CRITICAL DISTINCTION</strong>: Data classifications and plugin operations move in OPPOSITE directions:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Direction</th>
<th>Enforcement</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Classifications</strong></td>
<td>Can only INCREASE</td>
<td><code>with_uplifted_classification()</code></td>
<td>UNOFFICIAL → OFFICIAL → SECRET</td>
</tr>
<tr>
<td><strong>Plugin Operations</strong></td>
<td>Can only DECREASE</td>
<td><code>allow_downgrade=True</code></td>
<td>SECRET → OFFICIAL → UNOFFICIAL</td>
</tr>
</tbody>
</table>
<p><strong>Forbidden Operations</strong>:
- ❌ UNOFFICIAL plugin operating at SECRET level (insufficient clearance)
- ❌ SECRET data downgrading to UNOFFICIAL (no write down)
- ❌ Frozen plugin (allow_downgrade=False) operating below declared level</p>
<p><strong>Allowed Operations</strong>:
- ✅ SECRET plugin operating at UNOFFICIAL level (if allow_downgrade=True - trusted to filter)
- ✅ UNOFFICIAL data uplifted to SECRET (explicit via with_uplifted_classification())
- ✅ Frozen plugin operating at EXACT declared level only</p>
<h3 id="14-compliance-requirements">1.4 Compliance Requirements<a class="headerlink" href="#14-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] All plugins MUST declare <code>security_level</code> parameter
- [x] All plugins MUST declare <code>allow_downgrade</code> parameter (no default)
- [x] Operating level computed BEFORE data retrieval
- [x] Validation failures ABORT pipeline with <code>SecurityValidationError</code>
- [x] All components validated via <code>validate_can_operate_at_level()</code>
- [x] Pipeline execution logs include security level in audit trail</p>
<p><strong>Audit Evidence</strong>:
- Security level computation: <code>src/elspeth/core/experiments/suite_runner.py:_compute_operating_level()</code>
- Validation enforcement: <code>src/elspeth/core/experiments/suite_runner.py:_validate_component_clearances()</code>
- Test coverage: <code>tests/test_adr002_*.py</code> (Bell-LaPadula scenarios)</p>
<hr />
<h2 id="policy-2-trusted-container-model">Policy 2: Trusted Container Model<a class="headerlink" href="#policy-2-trusted-container-model" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-002a
<strong>Status</strong>: Mandatory
<strong>Enforcement</strong>: Compile-time (frozen dataclass) + Runtime (factory method) + Test (CI)</p>
<h3 id="21-classifieddataframe-immutability">2.1 ClassifiedDataFrame Immutability<a class="headerlink" href="#21-classifieddataframe-immutability" title="Anchor link to this section">&para;</a></h3>
<p>All classified data MUST be encapsulated in <code>ClassifiedDataFrame</code> containers with the following guarantees:</p>
<ol>
<li><strong>Immutable Classification</strong>: Security metadata cannot be modified after creation</li>
<li><strong>Datasource-Only Creation</strong>: Only datasources can create fresh containers (prevents laundering)</li>
<li><strong>Content Mutability</strong>: Data content CAN be modified (e.g., adding columns, filtering rows)</li>
<li><strong>Classification Propagation</strong>: Transformations create new containers preserving/uplifting classification</li>
</ol>
<h3 id="22-container-creation-rules">2.2 Container Creation Rules<a class="headerlink" href="#22-container-creation-rules" title="Anchor link to this section">&para;</a></h3>
<h4 id="rule-1-datasource-only-factory-method">Rule 1: Datasource-Only Factory Method<a class="headerlink" href="#rule-1-datasource-only-factory-method" title="Anchor link to this section">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># ✅ ALLOWED: Datasource creating ClassifiedDataFrame</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">classification</span><span class="p">:</span> <span class="n">SecurityLevel</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="nd">@classmethod</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_from_datasource</span><span class="p">(</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="n">classification</span><span class="p">:</span> <span class="n">SecurityLevel</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ClassifiedDataFrame&quot;</span><span class="p">:</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Factory method - ONLY datasources may call this.&quot;&quot;&quot;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">classification</span><span class="o">=</span><span class="n">classification</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Enforcement</strong>: Code review + convention (future: decorator validation)</p>
<h4 id="rule-2-transform-classification-preservation">Rule 2: Transform Classification Preservation<a class="headerlink" href="#rule-2-transform-classification-preservation" title="Anchor link to this section">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># ✅ ALLOWED: Transform preserving classification</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">ClassifiedDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">processed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="c1"># New container, SAME or HIGHER classification</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="k">return</span> <span class="n">ClassifiedDataFrame</span><span class="p">(</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>        <span class="n">data</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        <span class="n">classification</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">classification</span>  <span class="c1"># Preserved</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="p">)</span>
</span></code></pre></div>
<h4 id="rule-3-explicit-uplift-only">Rule 3: Explicit Uplift Only<a class="headerlink" href="#rule-3-explicit-uplift-only" title="Anchor link to this section">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># ✅ ALLOWED: Explicit classification uplift</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">ClassifiedDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="n">processed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">plugin_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_security_level</span><span class="p">()</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">target_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">classification</span><span class="p">,</span> <span class="n">plugin_level</span><span class="p">)</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="k">return</span> <span class="n">frame</span><span class="o">.</span><span class="n">with_uplifted_classification</span><span class="p">(</span><span class="n">target_level</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="23-attack-scenario-prevention">2.3 Attack Scenario Prevention<a class="headerlink" href="#23-attack-scenario-prevention" title="Anchor link to this section">&para;</a></h3>
<p><strong>Threat</strong>: Classification Laundering Attack</p>
<p>A malicious plugin creates a "fresh" ClassifiedDataFrame with LOWER classification to bypass MLS controls:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># ❌ PREVENTED: Malicious plugin laundering SECRET data as UNOFFICIAL</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">MaliciousTransform</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">ClassifiedDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        <span class="c1"># Received SECRET frame</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>        <span class="k">assert</span> <span class="n">frame</span><span class="o">.</span><span class="n">classification</span> <span class="o">==</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>        <span class="c1"># ATTACK: Create &quot;fresh&quot; frame with UNOFFICIAL classification</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>        <span class="c1"># This would allow SECRET data to reach UNOFFICIAL sinks!</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        <span class="n">laundered</span> <span class="o">=</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>            <span class="n">frame</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>  <span class="c1"># SECRET data</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>            <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">UNOFFICIAL</span>  <span class="c1"># ❌ Laundered classification</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>        <span class="p">)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="k">return</span> <span class="n">laundered</span>
</span></code></pre></div>
<p><strong>Defense</strong>:
- Factory method convention: ONLY datasources create containers
- Code review: Grep for <code>create_from_datasource</code> in transform code
- Future enhancement: Decorator validation or capability-based security</p>
<h3 id="24-compliance-requirements">2.4 Compliance Requirements<a class="headerlink" href="#24-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] ClassifiedDataFrame is a frozen dataclass (immutable fields)
- [x] Only datasources use <code>create_from_datasource()</code>
- [x] Transforms use existing containers or <code>with_uplifted_classification()</code>
- [x] No direct ClassifiedDataFrame() constructor calls outside core
- [x] Audit trail logs classification at each pipeline stage</p>
<p><strong>Audit Evidence</strong>:
- Container implementation: <code>src/elspeth/core/security/classified_data.py</code>
- Test coverage: <code>tests/test_classified_dataframe.py</code>
- Code review checklist: No <code>create_from_datasource()</code> in <code>src/elspeth/plugins/nodes/transforms/</code></p>
<hr />
<h2 id="policy-3-immutable-security-policy-metadata">Policy 3: Immutable Security Policy Metadata<a class="headerlink" href="#policy-3-immutable-security-policy-metadata" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-002b
<strong>Status</strong>: Mandatory
<strong>Enforcement</strong>: Compile-time (code review) + Registry (schema validation) + CI (lint rules)</p>
<h3 id="31-author-owned-security-policy">3.1 Author-Owned Security Policy<a class="headerlink" href="#31-author-owned-security-policy" title="Anchor link to this section">&para;</a></h3>
<p>Security policy metadata is <strong>immutable, author-owned, and signed</strong>. Operators cannot override security policy through configuration, environment variables, or runtime hooks.</p>
<h4 id="rule-1-immutable-policy-fields">Rule 1: Immutable Policy Fields<a class="headerlink" href="#rule-1-immutable-policy-fields" title="Anchor link to this section">&para;</a></h4>
<p>The following fields are defined <strong>solely in plugin code</strong> by the author:
- <code>security_level</code>: Plugin's security clearance
- <code>allow_downgrade</code>: Whether plugin can operate at lower levels
- Future policy fields: <code>max_operating_level</code>, compliance tags, etc.</p>
<p><strong>Forbidden</strong>: Configuration-driven policy overrides</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># ❌ FORBIDDEN: Cannot override security policy via config</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_blob</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PROTECTED</span><span class="w">  </span><span class="c1"># ❌ REJECTED by registry</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nt">allow_downgrade</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">     </span><span class="c1"># ❌ REJECTED by registry</span>
</span></code></pre></div>
<p><strong>Correct</strong>: Policy defined in code only</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># ✅ CORRECT: Policy hard-coded by plugin author</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">AzureBlobDatasource</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        <span class="c1"># Policy is hard-coded, NOT configurable</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>            <span class="n">security_level</span><span class="o">=</span><span class="n">SecurityLevel</span><span class="o">.</span><span class="n">PROTECTED</span><span class="p">,</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>            <span class="n">allow_downgrade</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Author&#39;s decision</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="p">)</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>        <span class="c1"># ... rest of initialization</span>
</span></code></pre></div>
<h4 id="rule-2-registry-enforcement">Rule 2: Registry Enforcement<a class="headerlink" href="#rule-2-registry-enforcement" title="Anchor link to this section">&para;</a></h4>
<p>Plugin registries <strong>reject registration schemas</strong> that expose policy fields as configurable parameters.</p>
<p><strong>Factory Implementation</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_azure_blob_datasource</span><span class="p">(</span><span class="n">opts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">PluginContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AzureBlobDatasource</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory ignores security policy fields from config.&quot;&quot;&quot;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="c1"># Strip security policy fields if present (defensive)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="n">safe_opts</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">opts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>                 <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;security_level&quot;</span><span class="p">,</span> <span class="s2">&quot;allow_downgrade&quot;</span><span class="p">)}</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="c1"># Plugin sets policy internally</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="k">return</span> <span class="n">AzureBlobDatasource</span><span class="p">(</span><span class="o">**</span><span class="n">safe_opts</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Registry Schema</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">AZURE_BLOB_SCHEMA</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>        <span class="s2">&quot;config_path&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>        <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>        <span class="c1"># ❌ NO security_level or allow_downgrade properties</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="p">},</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;config_path&quot;</span><span class="p">,</span> <span class="s2">&quot;profile&quot;</span><span class="p">]</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="p">}</span>
</span></code></pre></div></p>
<h4 id="rule-3-signature-attestation">Rule 3: Signature Attestation<a class="headerlink" href="#rule-3-signature-attestation" title="Anchor link to this section">&para;</a></h4>
<p>Published plugins include policy metadata in the signing manifest. Security review verifies the implementation matches declared policy prior to signing.</p>
<p><strong>Signing Manifest</strong>:
<div class="language-json highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nt">&quot;plugin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AzureBlobDatasource&quot;</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.2.0&quot;</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="nt">&quot;security_policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="nt">&quot;security_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PROTECTED&quot;</span><span class="p">,</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nt">&quot;allow_downgrade&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="nt">&quot;policy_hash&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sha256:abc123...&quot;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">  </span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="p">}</span>
</span></code></pre></div></p>
<p><strong>Verification Process</strong>:
1. Security team reviews plugin code
2. Extracts declared policy (<code>security_level</code>, <code>allow_downgrade</code>)
3. Verifies policy matches security requirements
4. Signs plugin with attested policy metadata
5. Runtime validates signature matches running code</p>
<h3 id="32-frozen-vs-trusted-downgrade-selection">3.2 Frozen vs Trusted Downgrade Selection<a class="headerlink" href="#32-frozen-vs-trusted-downgrade-selection" title="Anchor link to this section">&para;</a></h3>
<p>Authors choose security policy <strong>explicitly at development time</strong>, not configuration time:</p>
<table>
<thead>
<tr>
<th>Author Choice</th>
<th>Policy Declaration</th>
<th>Operator Selection</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Trusted Downgrade</strong></td>
<td><code>allow_downgrade=True</code> in code</td>
<td>Use this plugin for mixed-classification workflows</td>
</tr>
<tr>
<td><strong>Frozen</strong></td>
<td><code>allow_downgrade=False</code> in code</td>
<td>Use this plugin ONLY for dedicated classification domains</td>
</tr>
</tbody>
</table>
<p><strong>Operator Workflow</strong>:
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Operator selects the RIGHT PLUGIN, not the right configuration</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_blob_trusted</span><span class="w">  </span><span class="c1"># allow_downgrade=True (hard-coded)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># OR</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_blob_frozen</span><span class="w">   </span><span class="c1"># allow_downgrade=False (hard-coded)</span>
</span></code></pre></div></p>
<h3 id="33-attack-scenario-prevention">3.3 Attack Scenario Prevention<a class="headerlink" href="#33-attack-scenario-prevention" title="Anchor link to this section">&para;</a></h3>
<p><strong>Threat</strong>: Configuration-driven security downgrade</p>
<p>An operator (malicious or misconfigured) attempts to override security policy via YAML:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># ATTACK: Try to override frozen plugin to allow downgrade</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nt">datasource</span><span class="p">:</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dedicated_secret_source</span><span class="w">  </span><span class="c1"># Author set allow_downgrade=False</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">  </span><span class="nt">allow_downgrade</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">          </span><span class="c1"># ❌ ATTACKER attempts override</span>
</span></code></pre></div>
<p><strong>Defense</strong>:
1. <strong>Registry</strong>: Rejects schema with policy fields → Plugin won't register
2. <strong>Factory</strong>: Strips policy fields from opts → Override ignored
3. <strong>Plugin</strong>: Hard-coded policy in <code>__init__</code> → Immutable
4. <strong>CI Lint</strong>: Detects policy fields in YAML → Build fails</p>
<p><strong>Result</strong>: Attack prevented at 4 independent layers.</p>
<h3 id="34-compliance-requirements">3.4 Compliance Requirements<a class="headerlink" href="#34-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] All plugins define policy in <code>__init__</code>, not from parameters
- [x] Registry schemas exclude <code>security_level</code> and <code>allow_downgrade</code>
- [x] Factory functions strip policy fields from configuration
- [x] CI lint rules detect policy fields in YAML configs
- [x] Signing manifests include attested policy metadata
- [x] Security review process validates policy before signing</p>
<p><strong>Audit Evidence</strong>:
- Plugin implementation: Hard-coded policy in <code>super().__init__()</code>
- Registry schemas: No policy fields in JSON schemas
- CI lint: <code>.github/workflows/config-lint.yml</code>
- Signing manifest: <code>manifests/plugins/*.json</code></p>
<hr />
<h2 id="policy-4-plugin-security-architecture">Policy 4: Plugin Security Architecture<a class="headerlink" href="#policy-4-plugin-security-architecture" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-003, ADR-004
<strong>Status</strong>: Mandatory
<strong>Enforcement</strong>: Compile-time (ABC inheritance, MyPy) + Runtime (registry, isinstance()) + Test (CI)</p>
<h3 id="41-mandatory-baseplugin-inheritance-security-bones">4.1 Mandatory BasePlugin Inheritance ("Security Bones")<a class="headerlink" href="#41-mandatory-baseplugin-inheritance-security-bones" title="Anchor link to this section">&para;</a></h3>
<p>All plugins MUST explicitly inherit from <code>BasePlugin</code> ABC to participate in security validation.</p>
<h4 id="rule-1-nominal-typing-requirement">Rule 1: Nominal Typing Requirement<a class="headerlink" href="#rule-1-nominal-typing-requirement" title="Anchor link to this section">&para;</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">BasePlugin</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class with concrete security enforcement (&quot;security bones&quot;).&quot;&quot;&quot;</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>        <span class="n">security_level</span><span class="p">:</span> <span class="n">SecurityLevel</span><span class="p">,</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>        <span class="n">allow_downgrade</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># MANDATORY, no default</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>    <span class="p">):</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize plugin with security parameters.</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="sd">        Args:</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="sd">            security_level: Plugin&#39;s security clearance (MANDATORY).</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="sd">            allow_downgrade: Whether plugin can operate at lower levels (MANDATORY).</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="sd">                - True: Trusted downgrade (can filter to lower levels)</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="sd">                - False: Frozen plugin (exact level matching only)</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="sd">        Raises:</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="sd">            TypeError: If allow_downgrade not provided (no default).</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="sd">            ValueError: If security_level is None.</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>        <span class="k">if</span> <span class="n">security_level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;security_level cannot be None (ADR-004)&quot;</span><span class="p">)</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span> <span class="o">=</span> <span class="n">security_level</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_allow_downgrade</span> <span class="o">=</span> <span class="n">allow_downgrade</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>    <span class="nd">@property</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">security_level</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SecurityLevel</span><span class="p">:</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read-only security level property.&quot;&quot;&quot;</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>    <span class="nd">@property</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">allow_downgrade</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read-only downgrade permission property.&quot;&quot;&quot;</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allow_downgrade</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>    <span class="nd">@final</span>  <span class="c1"># Cannot be overridden - sealed for security</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_can_operate_at_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operating_level</span><span class="p">:</span> <span class="n">SecurityLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate plugin can operate at pipeline level (SEALED - security enforcement).</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a><span class="sd">        Raises:</span>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a><span class="sd">            SecurityValidationError: If plugin cannot operate at given level.</span>
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>        <span class="c1"># Check 1: Insufficient clearance (Bell-LaPadula &quot;no read up&quot;)</span>
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a>        <span class="k">if</span> <span class="n">operating_level</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span><span class="p">:</span>
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>            <span class="k">raise</span> <span class="n">SecurityValidationError</span><span class="p">(</span>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has clearance </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>                <span class="sa">f</span><span class="s2">&quot;but pipeline requires </span><span class="si">{</span><span class="n">operating_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. Insufficient clearance.&quot;</span>
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>            <span class="p">)</span>
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>        <span class="c1"># Check 2: Frozen plugin downgrade rejection</span>
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>        <span class="k">if</span> <span class="n">operating_level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allow_downgrade</span><span class="p">:</span>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>            <span class="k">raise</span> <span class="n">SecurityValidationError</span><span class="p">(</span>
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is frozen at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_security_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="__span-16-60"><a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a>                <span class="sa">f</span><span class="s2">&quot;(allow_downgrade=False). Cannot operate at lower level </span><span class="si">{</span><span class="n">operating_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="__span-16-61"><a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a>            <span class="p">)</span>
</span><span id="__span-16-62"><a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a>
</span><span id="__span-16-63"><a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a>        <span class="c1"># Check 3: Valid operation (exact match or trusted downgrade)</span>
</span></code></pre></div>
<p><strong>Why Sealed Methods (@final)?</strong></p>
<p>Preventing override attacks:
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># ❌ PREVENTED: Malicious override bypassing security</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">MaliciousPlugin</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="c1"># This override will FAIL due to @final + __init_subclass__ enforcement</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_can_operate_at_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operating_level</span><span class="p">:</span> <span class="n">SecurityLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        <span class="k">pass</span>  <span class="c1"># ❌ Bypass attempt - blocked by @final decorator</span>
</span></code></pre></div></p>
<h4 id="rule-2-central-plugin-type-registry">Rule 2: Central Plugin Type Registry<a class="headerlink" href="#rule-2-central-plugin-type-registry" title="Anchor link to this section">&para;</a></h4>
<p>All plugin types MUST be registered in <code>PLUGIN_TYPE_REGISTRY</code> to ensure security validation coverage.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># src/elspeth/core/base/plugin_types.py</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">PLUGIN_TYPE_REGISTRY</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="s2">&quot;llm_client&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;singleton&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;LLMClient&quot;</span><span class="p">},</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="s2">&quot;llm_middlewares&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;LLMMiddleware&quot;</span><span class="p">},</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="s2">&quot;row_plugins&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;RowExperimentPlugin&quot;</span><span class="p">},</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="s2">&quot;aggregator_plugins&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;AggregationExperimentPlugin&quot;</span><span class="p">},</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="s2">&quot;validation_plugins&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;ValidationPlugin&quot;</span><span class="p">},</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="s2">&quot;early_stop_plugins&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;EarlyStopPlugin&quot;</span><span class="p">},</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="p">}</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">collect_all_plugins</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">BasePlugin</span><span class="p">]:</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Collect all plugins using registry (ensures completeness).&quot;&quot;&quot;</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>    <span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">PLUGIN_TYPE_REGISTRY</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>        <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>        <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            <span class="k">continue</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>        <span class="k">if</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;singleton&quot;</span><span class="p">:</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">BasePlugin</span><span class="p">):</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>                <span class="n">plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>        <span class="k">elif</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>            <span class="n">plugins</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">attr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">BasePlugin</span><span class="p">)])</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>    <span class="k">return</span> <span class="n">plugins</span>
</span></code></pre></div>
<p><strong>Registry Completeness Test</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_plugin_registry_complete</span><span class="p">():</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;SECURITY: Verify all plugin types registered.&quot;&quot;&quot;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="n">runner_attrs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>        <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ExperimentRunner</span><span class="p">)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_plugins&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">a</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_middlewares&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">a</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_client&#39;</span><span class="p">))</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>        <span class="ow">and</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="p">]</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>    <span class="n">registered</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">PLUGIN_TYPE_REGISTRY</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">runner_attrs</span><span class="p">)</span> <span class="o">-</span> <span class="n">registered</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="k">assert</span> <span class="ow">not</span> <span class="n">missing</span><span class="p">,</span> <span class="p">(</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>        <span class="sa">f</span><span class="s2">&quot;SECURITY: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> exist in ExperimentRunner but NOT in registry. &quot;</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>        <span class="sa">f</span><span class="s2">&quot;Will bypass ADR-002 validation!&quot;</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>    <span class="p">)</span>
</span></code></pre></div></p>
<h3 id="42-defense-matrix">4.2 Defense Matrix<a class="headerlink" href="#42-defense-matrix" title="Anchor link to this section">&para;</a></h3>
<table>
<thead>
<tr>
<th>Failure Mode</th>
<th>Layer 1 (ABC)</th>
<th>Layer 2 (Registry)</th>
<th>Layer 3 (Test)</th>
<th>Outcome</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accidental class with matching methods</td>
<td>✅ <strong>CATCHES</strong></td>
<td>-</td>
<td>-</td>
<td>Rejected (no inheritance)</td>
</tr>
<tr>
<td>New plugin type, forgot to register</td>
<td>-</td>
<td>❌ Misses</td>
<td>✅ <strong>CATCHES</strong></td>
<td>Test fails</td>
</tr>
<tr>
<td>New plugin type, forgot both</td>
<td>✅ <strong>CATCHES</strong></td>
<td>❌ Misses</td>
<td>✅ <strong>CATCHES</strong></td>
<td>Test fails + rejected</td>
</tr>
<tr>
<td>Malicious override of sealed method</td>
<td>✅ <strong>CATCHES</strong></td>
<td>-</td>
<td>-</td>
<td><code>@final</code> blocks override</td>
</tr>
<tr>
<td>Correct implementation</td>
<td>✅ Passes</td>
<td>✅ Passes</td>
<td>✅ Passes</td>
<td>Works ✅</td>
</tr>
</tbody>
</table>
<p><strong>Result</strong>: No single point of failure. Multiple independent defenses.</p>
<h3 id="43-compliance-requirements">4.3 Compliance Requirements<a class="headerlink" href="#43-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] All plugins inherit from BasePlugin ABC
- [x] All plugins call <code>super().__init__(security_level=..., allow_downgrade=...)</code>
- [x] No plugins override <code>validate_can_operate_at_level()</code> (sealed)
- [x] All plugin types registered in PLUGIN_TYPE_REGISTRY
- [x] Registry completeness test passes in CI</p>
<p><strong>Audit Evidence</strong>:
- ABC definition: <code>src/elspeth/core/base/plugin.py</code>
- Registry: <code>src/elspeth/core/base/plugin_types.py</code>
- Test coverage: <code>tests/test_plugin_registry.py::test_plugin_registry_complete</code></p>
<hr />
<h2 id="policy-5-frozen-plugin-capability">Policy 5: Frozen Plugin Capability<a class="headerlink" href="#policy-5-frozen-plugin-capability" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-005
<strong>Status</strong>: Mandatory (Explicit Choice Required)
<strong>Enforcement</strong>: Compile-time (no default parameter) + Runtime (validation) + Test (CI)</p>
<h3 id="51-trusted-downgrade-vs-frozen-plugins">5.1 Trusted Downgrade vs Frozen Plugins<a class="headerlink" href="#51-trusted-downgrade-vs-frozen-plugins" title="Anchor link to this section">&para;</a></h3>
<p>Elspeth supports two security postures via the <code>allow_downgrade</code> parameter:</p>
<table>
<thead>
<tr>
<th>Posture</th>
<th><code>allow_downgrade</code></th>
<th>Behavior</th>
<th>Use Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Trusted Downgrade</strong></td>
<td><code>True</code></td>
<td>Plugin can operate at SAME or LOWER levels</td>
<td>General-purpose plugins, cloud environments, mixed-classification workflows</td>
</tr>
<tr>
<td><strong>Frozen Plugin</strong></td>
<td><code>False</code></td>
<td>Plugin can ONLY operate at EXACT declared level</td>
<td>Dedicated classification domains, regulatory compliance, air-gapped networks</td>
</tr>
</tbody>
</table>
<p>⚠️ <strong>BREAKING CHANGE</strong>: <code>allow_downgrade</code> has NO default value. All plugins MUST explicitly declare their security posture.</p>
<h3 id="52-trusted-downgrade-pattern-allow_downgradetrue">5.2 Trusted Downgrade Pattern (allow_downgrade=True)<a class="headerlink" href="#52-trusted-downgrade-pattern-allow_downgradetrue" title="Anchor link to this section">&para;</a></h3>
<p><strong>Scenario</strong>: Cloud-based datasource handles data at multiple classification levels</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AzureBlobDataSource</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">,</span> <span class="n">DataSource</span><span class="p">):</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">security_level</span><span class="p">:</span> <span class="n">SecurityLevel</span> <span class="o">=</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">):</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>        <span class="c1"># Explicit allow_downgrade=True → trusted downgrade enabled</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">security_level</span><span class="o">=</span><span class="n">security_level</span><span class="p">,</span> <span class="n">allow_downgrade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">PluginContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>        <span class="c1"># Can operate at OFFICIAL, UNOFFICIAL if pipeline requires</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>        <span class="c1"># Responsible for filtering SECRET-tagged blobs appropriately</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>        <span class="n">operating_level</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">security_level</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        <span class="k">if</span> <span class="n">operating_level</span> <span class="o">&lt;</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">:</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>            <span class="c1"># Filter blobs to only include data at operating_level or below</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>            <span class="n">filtered_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_by_classification</span><span class="p">(</span><span class="n">operating_level</span><span class="p">)</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>            <span class="c1"># Load all data (including SECRET)</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>            <span class="n">filtered_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_all_data</span><span class="p">()</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>        <span class="k">return</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>            <span class="n">filtered_data</span><span class="p">,</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>            <span class="n">operating_level</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>        <span class="p">)</span>
</span></code></pre></div>
<p><strong>Validation</strong>:
- ✅ Operates at SECRET level: <code>validate_can_operate_at_level(SECRET)</code> → PASS
- ✅ Operates at OFFICIAL level: <code>validate_can_operate_at_level(OFFICIAL)</code> → PASS (trusted downgrade)
- ✅ Operates at UNOFFICIAL level: <code>validate_can_operate_at_level(UNOFFICIAL)</code> → PASS (trusted downgrade)
- ❌ Operates at higher level: Not possible (SECRET is highest)</p>
<h3 id="53-frozen-plugin-pattern-allow_downgradefalse">5.3 Frozen Plugin Pattern (allow_downgrade=False)<a class="headerlink" href="#53-frozen-plugin-pattern-allow_downgradefalse" title="Anchor link to this section">&para;</a></h3>
<p><strong>Scenario</strong>: Dedicated SECRET-only infrastructure (air-gapped, regulatory compliance)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DedicatedSecretDataSource</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">,</span> <span class="n">DataSource</span><span class="p">):</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>        <span class="c1"># Explicit allow_downgrade=False → frozen at SECRET level</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>            <span class="n">security_level</span><span class="o">=</span><span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>            <span class="n">allow_downgrade</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>        <span class="p">)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">PluginContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>        <span class="c1"># Will ONLY operate in SECRET pipelines</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>        <span class="c1"># Pipeline construction fails if configured with lower-clearance components</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>        <span class="k">return</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_load_secret_data</span><span class="p">(),</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>            <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>        <span class="p">)</span>
</span></code></pre></div>
<p><strong>Validation</strong>:
- ✅ Operates at SECRET level: <code>validate_can_operate_at_level(SECRET)</code> → PASS (exact match)
- ❌ Operates at OFFICIAL level: <code>validate_can_operate_at_level(OFFICIAL)</code> → FAIL (frozen, cannot downgrade)
- ❌ Operates at UNOFFICIAL level: <code>validate_can_operate_at_level(UNOFFICIAL)</code> → FAIL (frozen, cannot downgrade)</p>
<p><strong>Error Message</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>SecurityValidationError: DedicatedSecretDataSource is frozen at SECRET
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>(allow_downgrade=False). Cannot operate at lower level OFFICIAL.
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>This plugin requires exact level matching and does not support trusted downgrade.
</span></code></pre></div></p>
<h3 id="54-compliance-requirements">5.4 Compliance Requirements<a class="headerlink" href="#54-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] All plugins explicitly set <code>allow_downgrade=True</code> or <code>allow_downgrade=False</code>
- [x] No plugins rely on default value (TypeError if omitted)
- [x] Frozen plugins documented in deployment guide
- [x] Infrastructure supports exact level matching for frozen plugins</p>
<p><strong>Audit Evidence</strong>:
- Validation logic: <code>src/elspeth/core/base/plugin.py:validate_can_operate_at_level()</code>
- Test coverage: <code>tests/test_baseplugin_frozen.py</code>
- Configuration examples: <code>docs/user-guide/configuration.md</code></p>
<hr />
<h2 id="policy-6-security-critical-exception-policy">Policy 6: Security-Critical Exception Policy<a class="headerlink" href="#policy-6-security-critical-exception-policy" title="Anchor link to this section">&para;</a></h2>
<p><strong>Source</strong>: ADR-006
<strong>Status</strong>: Mandatory
<strong>Enforcement</strong>: Static Analysis (Ruff, MyPy) + Pre-Commit (AST parsing) + CI (grep-based) + Code Review</p>
<h3 id="61-dual-exception-model">6.1 Dual-Exception Model<a class="headerlink" href="#61-dual-exception-model" title="Anchor link to this section">&para;</a></h3>
<p>Elspeth distinguishes between <strong>expected security boundaries</strong> and <strong>impossible security invariant violations</strong>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>Exception
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>├── SecurityValidationError  ✅ Catchable - Expected boundaries
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>└── SecurityCriticalError    🚨 Policy-forbidden - Invariant violations
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Exception</th>
<th>Purpose</th>
<th>Catchability</th>
<th>Use Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SecurityValidationError</strong></td>
<td>Expected security boundaries</td>
<td>✅ May be caught in production</td>
<td>Start-time validation failures, clearance mismatches, permission denied</td>
</tr>
<tr>
<td><strong>SecurityCriticalError</strong></td>
<td>Impossible invariant violations</td>
<td>❌ MUST NOT be caught in production (tests only)*</td>
<td>Classification downgrades, metadata tampering, container boundary violations</td>
</tr>
</tbody>
</table>
<p>* <strong>Allowable scope</strong>: Only unit/integration tests (under <code>tests/</code>) or generated scaffolding specifically tagged for auditing may catch this exception. All first-party production modules (<code>src/</code>) are linted to reject catches, and glue code (e.g., orchestration notebooks, Airflow DAGs) must either live under <code>tests/</code> or opt into the same lint rule set to guarantee enforcement.</p>
<h3 id="62-securityvalidationerror-expected-boundaries">6.2 SecurityValidationError (Expected Boundaries)<a class="headerlink" href="#62-securityvalidationerror-expected-boundaries" title="Anchor link to this section">&para;</a></h3>
<p><strong>Use for expected security validation failures</strong> where graceful error handling is appropriate:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># Expected validation failure - user misconfigured pipeline</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">_validate_component_clearances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operating_level</span><span class="p">:</span> <span class="n">SecurityLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate all components can operate at computed level.&quot;&quot;&quot;</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">datasource</span><span class="o">.</span><span class="n">validate_can_operate_at_level</span><span class="p">(</span><span class="n">operating_level</span><span class="p">)</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>        <span class="k">raise</span> <span class="n">SecurityValidationError</span><span class="p">(</span>  <span class="c1"># ✅ Expected, catchable</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>            <span class="sa">f</span><span class="s2">&quot;ADR-002 Start-Time Validation Failed: Datasource cannot operate &quot;</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>            <span class="sa">f</span><span class="s2">&quot;at </span><span class="si">{</span><span class="n">operating_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> level: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span></code></pre></div>
<p><strong>Production code MAY catch this</strong>:
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>    <span class="n">suite</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="k">except</span> <span class="n">SecurityValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pipeline validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>    <span class="n">notify_admin</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid pipeline configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    <span class="c1"># Graceful degradation, notify user, etc.</span>
</span></code></pre></div></p>
<h3 id="63-securitycriticalerror-invariant-violations">6.3 SecurityCriticalError (Invariant Violations)<a class="headerlink" href="#63-securitycriticalerror-invariant-violations" title="Anchor link to this section">&para;</a></h3>
<p><strong>Use for "should never happen" scenarios</strong> indicating bugs or attacks:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">with_uplifted_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_level</span><span class="p">:</span> <span class="n">SecurityLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassifiedDataFrame</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Uplift classification (high water mark principle).</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="sd">    Raises:</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="sd">        SecurityCriticalError: If downgrade attempted (CRITICAL - platform terminates).</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>    <span class="k">if</span> <span class="n">new_level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">classification</span><span class="p">:</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>        <span class="c1"># This should NEVER happen - indicates bug or attack</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>        <span class="k">raise</span> <span class="n">SecurityCriticalError</span><span class="p">(</span>  <span class="c1"># 🚨 Platform terminates</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>            <span class="sa">f</span><span class="s2">&quot;CRITICAL: Classification downgrade from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>            <span class="sa">f</span><span class="s2">&quot;to </span><span class="si">{</span><span class="n">new_level</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> violates high water mark invariant (ADR-002-A)&quot;</span><span class="p">,</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>            <span class="n">evidence</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>                <span class="s2">&quot;current_level&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>                <span class="s2">&quot;attempted_level&quot;</span><span class="p">:</span> <span class="n">new_level</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>                <span class="s2">&quot;data_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>            <span class="p">},</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>            <span class="n">cve_id</span><span class="o">=</span><span class="s2">&quot;CVE-ADR-002-A-004&quot;</span><span class="p">,</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>            <span class="n">classification_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">classification</span><span class="p">,</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>        <span class="p">)</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>    <span class="k">return</span> <span class="n">ClassifiedDataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">new_level</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Production code MUST NOT catch this</strong> (policy-enforced):
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># ❌ FORBIDDEN in production code (src/)</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">classified</span><span class="o">.</span><span class="n">with_uplifted_classification</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="k">except</span> <span class="n">SecurityCriticalError</span><span class="p">:</span>  <span class="c1"># ❌ Policy violation - blocked by CI</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    <span class="k">pass</span>  <span class="c1"># ❌ Execution continues with compromised state</span>
</span></code></pre></div></p>
<p><strong>Tests MAY catch this</strong> (verification):
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># ✅ ALLOWED in tests (tests/)</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_classification_downgrade_raises_critical_error</span><span class="p">():</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify downgrade attempts raise SecurityCriticalError.&quot;&quot;&quot;</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    <span class="n">classified</span> <span class="o">=</span> <span class="n">ClassifiedDataFrame</span><span class="o">.</span><span class="n">create_from_datasource</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SecurityLevel</span><span class="o">.</span><span class="n">SECRET</span><span class="p">)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">SecurityCriticalError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>        <span class="n">classified</span><span class="o">.</span><span class="n">with_uplifted_classification</span><span class="p">(</span><span class="n">SecurityLevel</span><span class="o">.</span><span class="n">UNOFFICIAL</span><span class="p">)</span>  <span class="c1"># Downgrade!</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>    <span class="k">assert</span> <span class="s2">&quot;downgrade&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>    <span class="k">assert</span> <span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">cve_id</span> <span class="o">==</span> <span class="s2">&quot;CVE-ADR-002-A-004&quot;</span>
</span></code></pre></div></p>
<h3 id="64-emergency-logging">6.4 Emergency Logging<a class="headerlink" href="#64-emergency-logging" title="Anchor link to this section">&para;</a></h3>
<p><code>SecurityCriticalError</code> automatically logs to multiple channels BEFORE propagating:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecurityCriticalError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">evidence</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">cve_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">evidence</span> <span class="o">=</span> <span class="n">evidence</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cve_id</span> <span class="o">=</span> <span class="n">cve_id</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>        <span class="c1"># Emergency logging BEFORE exception propagates</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log_critical_security_event</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">cve_id</span><span class="p">)</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_log_critical_security_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Log to multiple channels for redundancy.&quot;&quot;&quot;</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>        <span class="c1"># 1. stderr - always visible (container logs)</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚨 CRITICAL SECURITY ERROR - PLATFORM TERMINATING 🚨&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>        <span class="c1"># 2. Audit logger (structured JSON for SIEM)</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">))</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>        <span class="c1"># 3. Security event stream (Azure Monitor, Splunk, etc.)</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>        <span class="c1"># ...</span>
</span></code></pre></div>
<p><strong>Audit Event Structure</strong>:
<div class="language-json highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="p">{</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-10-26T10:30:15.123456+00:00&quot;</span><span class="p">,</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">  </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">  </span><span class="nt">&quot;event_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SECURITY_CRITICAL_ERROR&quot;</span><span class="p">,</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">  </span><span class="nt">&quot;event_class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVARIANT_VIOLATION&quot;</span><span class="p">,</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">  </span><span class="nt">&quot;cve_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CVE-ADR-002-A-004&quot;</span><span class="p">,</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">  </span><span class="nt">&quot;classification_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SECRET&quot;</span><span class="p">,</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CRITICAL: Classification downgrade from SECRET to UNOFFICIAL...&quot;</span><span class="p">,</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">  </span><span class="nt">&quot;evidence&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">    </span><span class="nt">&quot;current_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SECRET&quot;</span><span class="p">,</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">    </span><span class="nt">&quot;attempted_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNOFFICIAL&quot;</span><span class="p">,</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w">    </span><span class="nt">&quot;data_shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w">  </span><span class="nt">&quot;process_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">  </span><span class="nt">&quot;traceback&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="p">}</span>
</span></code></pre></div></p>
<h3 id="65-policy-enforcement-layers">6.5 Policy Enforcement Layers<a class="headerlink" href="#65-policy-enforcement-layers" title="Anchor link to this section">&para;</a></h3>
<p><strong>Layer 1: Ruff Linting (Fast Feedback)</strong></p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># pyproject.toml</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="k">[tool.ruff.lint]</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">extend-select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;TRY&quot;</span><span class="p">]</span><span class="w">  </span><span class="c1"># Exception handling best practices</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="k">[tool.ruff.lint.per-file-ignores]</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="s2">&quot;tests/**&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;TRY302&quot;</span><span class="p">]</span><span class="w">  </span><span class="c1"># Allow catching SecurityCriticalError in tests</span>
</span></code></pre></div>
<p><strong>Layer 2: Pre-Commit Hook (Prevents Commits)</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1"># .pre-commit-config.yaml runs AST-based script</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>python<span class="w"> </span>scripts/check_security_exception_policy.py<span class="w"> </span>src/**/*.py
</span></code></pre></div>
<p>Script detects:
- Direct catches: <code>except SecurityCriticalError:</code>
- Aliased catches: <code>except SCE:</code> (where SCE is imported)
- Tuple catches: <code>except (ValueError, SecurityCriticalError):</code>
- Warns on broad catches: <code>except Exception:</code>, <code>except:</code></p>
<p><strong>Layer 3: CI/CD (Blocks Merges)</strong></p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># .github/workflows/security-policy.yml</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for forbidden SecurityCriticalError catches</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="no">VIOLATIONS=$(grep -rn &quot;except.*SecurityCriticalError&quot; src/ || true)</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">    </span><span class="no">if [ -n &quot;$VIOLATIONS&quot; ]; then</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">      </span><span class="no">echo &quot;❌ POLICY VIOLATION: SecurityCriticalError caught in production!&quot;</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">      </span><span class="no">exit 1</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">    </span><span class="no">fi</span>
</span></code></pre></div>
<p><strong>Layer 4: Code Review (Human Verification)</strong></p>
<p>Pull request checklist:
- [ ] No <code>SecurityCriticalError</code> catches in production code (src/)
- [ ] Test code properly validates invariant violations
- [ ] Security-critical paths have defensive checks</p>
<h3 id="66-compliance-requirements">6.6 Compliance Requirements<a class="headerlink" href="#66-compliance-requirements" title="Anchor link to this section">&para;</a></h3>
<p><strong>Implementation Checklist</strong>:
- [x] <code>SecurityCriticalError</code> defined with emergency logging
- [x] Production code (src/) contains zero SecurityCriticalError catches
- [x] Test code (tests/) validates invariant violations raise SecurityCriticalError
- [x] Pre-commit hook blocks forbidden catches
- [x] CI enforces policy on all branches</p>
<p><strong>Audit Evidence</strong>:
- Exception definition: <code>src/elspeth/core/security/exceptions.py</code>
- Policy script: <code>scripts/check_security_exception_policy.py</code>
- CI workflow: <code>.github/workflows/security-policy.yml</code>
- Test coverage: <code>tests/test_security_critical_exceptions.py</code></p>
<hr />
<h2 id="policy-enforcement-summary">Policy Enforcement Summary<a class="headerlink" href="#policy-enforcement-summary" title="Anchor link to this section">&para;</a></h2>
<h3 id="defense-in-depth-layers">Defense-in-Depth Layers<a class="headerlink" href="#defense-in-depth-layers" title="Anchor link to this section">&para;</a></h3>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Technology</th>
<th>Enforcement Point</th>
<th>Prevents</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Type System</strong></td>
<td>MyPy, ABC inheritance</td>
<td>Compile-time (IDE, CI)</td>
<td>Accidental protocol compliance, type errors</td>
</tr>
<tr>
<td><strong>Runtime Checks</strong></td>
<td><code>isinstance()</code>, sealed methods</td>
<td>Execution-time</td>
<td>Bypass via duck typing, malicious overrides</td>
</tr>
<tr>
<td><strong>Registry</strong></td>
<td>PLUGIN_TYPE_REGISTRY</td>
<td>Pipeline construction</td>
<td>Missing plugin types in validation</td>
</tr>
<tr>
<td><strong>Testing</strong></td>
<td>pytest, assertions</td>
<td>CI (merge gate)</td>
<td>Registry incompleteness, missing test coverage</td>
</tr>
<tr>
<td><strong>Static Analysis</strong></td>
<td>Ruff, custom AST parsers</td>
<td>Pre-commit, CI</td>
<td>Policy violations, broad exception catches</td>
</tr>
<tr>
<td><strong>Code Review</strong></td>
<td>Human review, checklists</td>
<td>PR approval</td>
<td>Logic errors, subtle security issues</td>
</tr>
</tbody>
</table>
<h3 id="audit-trail-requirements">Audit Trail Requirements<a class="headerlink" href="#audit-trail-requirements" title="Anchor link to this section">&para;</a></h3>
<p>All security-relevant events MUST be logged to structured audit logs (<code>logs/run_*.jsonl</code>):</p>
<p><strong>Logged Events</strong>:
1. Security level computation for each pipeline
2. Component clearance validation results (pass/fail)
3. Classification uplift operations (<code>with_uplifted_classification</code> calls)
4. Security validation failures (SecurityValidationError)
5. <strong>CRITICAL</strong>: Security invariant violations (SecurityCriticalError - emergency logging)
6. Plugin instantiation with security parameters
7. <strong>Reproducibility bundle creation</strong> (ADR-014 - tamper-evident archives for audit)</p>
<p><strong>Audit Log Format</strong>:
<div class="language-json highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-10-26T10:30:15.123456+00:00&quot;</span><span class="p">,</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">  </span><span class="nt">&quot;run_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123...&quot;</span><span class="p">,</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">  </span><span class="nt">&quot;event_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SECURITY_VALIDATION&quot;</span><span class="p">,</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">  </span><span class="nt">&quot;security_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OFFICIAL&quot;</span><span class="p">,</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">  </span><span class="nt">&quot;component&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AzureBlobDataSource&quot;</span><span class="p">,</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">  </span><span class="nt">&quot;validation_result&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PASS&quot;</span><span class="p">,</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">  </span><span class="nt">&quot;details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="p">}</span>
</span></code></pre></div></p>
<hr />
<h2 id="compliance-mapping">Compliance Mapping<a class="headerlink" href="#compliance-mapping" title="Anchor link to this section">&para;</a></h2>
<h3 id="regulatory-framework-alignment">Regulatory Framework Alignment<a class="headerlink" href="#regulatory-framework-alignment" title="Anchor link to this section">&para;</a></h3>
<table>
<thead>
<tr>
<th>Framework</th>
<th>Requirement</th>
<th>Elspeth Control</th>
<th>Evidence</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PSPF (Australia)</strong></td>
<td>Classification-based access control</td>
<td>Bell-LaPadula MLS (Policy 1)</td>
<td>ADR-002, suite_runner.py</td>
</tr>
<tr>
<td><strong>NIST SP 800-53</strong></td>
<td>AC-3 Access Enforcement</td>
<td>Mandatory plugin validation (Policy 3)</td>
<td>ADR-003, plugin_types.py</td>
</tr>
<tr>
<td><strong>ISO 27001</strong></td>
<td>A.9.4.1 Information access restriction</td>
<td>Operating level computation (Policy 1.2)</td>
<td>suite_runner.py:_compute_operating_level()</td>
</tr>
<tr>
<td><strong>Common Criteria</strong></td>
<td>FDP_IFC.1 Subset information flow control</td>
<td>Immutable classification (Policy 2)</td>
<td>ADR-002a, classified_data.py</td>
</tr>
<tr>
<td><strong>GDPR</strong></td>
<td>Article 32 Security of processing</td>
<td>Defense-in-depth (All Policies)</td>
<td>Full ADR suite (002-006)</td>
</tr>
<tr>
<td><strong>HIPAA</strong></td>
<td>§164.312(b) Audit controls</td>
<td>Reproducibility bundles with tamper-evident signatures</td>
<td>ADR-014, reproducibility_bundle.py</td>
</tr>
<tr>
<td><strong>PCI-DSS</strong></td>
<td>Requirement 10.2 Audit trail for security events</td>
<td>JSONL audit logs + signed reproducibility archives</td>
<td>ADR-014, logs/run_*.jsonl</td>
</tr>
<tr>
<td><strong>PSPF (Australia)</strong></td>
<td>Recordkeeping and audit</td>
<td>Mandatory reproducibility bundle in production mode</td>
<td>ADR-014, config/templates/production_suite.yaml</td>
</tr>
</tbody>
</table>
<h3 id="certification-checklist">Certification Checklist<a class="headerlink" href="#certification-checklist" title="Anchor link to this section">&para;</a></h3>
<p>For security certification/accreditation, verify:</p>
<p><strong>Policy 1: MLS Enforcement</strong>
- [ ] Operating level computed as min(all components)
- [ ] Validation performed BEFORE data retrieval
- [ ] All Bell-LaPadula rules enforced (no read up, no write down)
- [ ] Test coverage includes all SecurityLevel combinations</p>
<p><strong>Policy 2: Trusted Container</strong>
- [ ] ClassifiedDataFrame is frozen dataclass
- [ ] Only datasources use <code>create_from_datasource()</code>
- [ ] Code review confirms no classification laundering
- [ ] Test coverage validates immutability</p>
<p><strong>Policy 3: Plugin Security</strong>
- [ ] All plugins inherit BasePlugin ABC
- [ ] Plugin registry complete (test passes)
- [ ] Sealed methods cannot be overridden (@final)
- [ ] MyPy strict mode enforced</p>
<p><strong>Policy 4: Frozen Plugins</strong>
- [ ] All plugins explicitly declare <code>allow_downgrade</code>
- [ ] Frozen plugins documented in deployment guide
- [ ] Infrastructure supports exact level matching
- [ ] Test coverage includes frozen scenarios</p>
<p><strong>Policy 5: Exception Policy</strong>
- [ ] SecurityCriticalError defined with emergency logging
- [ ] Production code has zero forbidden catches (CI enforced)
- [ ] Pre-commit hook blocks policy violations
- [ ] Test coverage validates invariant violations</p>
<hr />
<h2 id="related-documentation">Related Documentation<a class="headerlink" href="#related-documentation" title="Anchor link to this section">&para;</a></h2>
<h3 id="architecture-decision-records-adrs">Architecture Decision Records (ADRs)<a class="headerlink" href="#architecture-decision-records-adrs" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong><a href="../adrs/#adr-001-design-philosophy">ADR-001: Design Philosophy</a></strong> - Security-first principles, fail-closed approach</li>
<li><strong><a href="../adrs/#adr-002-multi-level-security-enforcement">ADR-002: Multi-Level Security</a></strong> - Bell-LaPadula MLS model (full text)</li>
<li><strong><a href="../adrs/#adr-002a-trusted-container-model">ADR-002a: Trusted Container Model</a></strong> - ClassifiedDataFrame immutability</li>
<li><strong><a href="../adrs/#adr-002b-immutable-security-policy-metadata">ADR-002b: Immutable Security Policy Metadata</a></strong> - Author-owned policy, no config overrides</li>
<li><strong><a href="../adrs/#adr-003-plugin-type-registry">ADR-003: Plugin Type Registry</a></strong> - Central registry for validation coverage</li>
<li><strong><a href="../adrs/#adr-004-mandatory-baseplugin-inheritance">ADR-004: Mandatory BasePlugin Inheritance</a></strong> - Security bones design</li>
<li><strong><a href="../adrs/#adr-005-frozen-plugin-protection">ADR-005: Frozen Plugin Capability</a></strong> - Strict level enforcement</li>
<li><strong><a href="../adrs/#adr-006-security-critical-exception-policy">ADR-006: Security-Critical Exception Policy</a></strong> - Fail-loud invariants</li>
<li><strong><a href="../adrs/#adr-014-tamper-evident-reproducibility-bundle">ADR-014: Tamper-Evident Reproducibility Bundle</a></strong> - Audit trail and compliance</li>
</ul>
<h3 id="user-guides">User Guides<a class="headerlink" href="#user-guides" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong><a href="../../user-guide/security-model/">Security Model</a></strong> - Practical guide with worked examples</li>
<li><strong><a href="../../user-guide/configuration/">Configuration</a></strong> - Security parameter reference</li>
</ul>
<h3 id="development-guides">Development Guides<a class="headerlink" href="#development-guides" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong><a href="../overview/">Architecture Overview</a></strong> - System architecture with security components</li>
<li><strong><a href="../execution-flow/">Execution Flow</a></strong> - Security checkpoint mapping</li>
</ul>
<h3 id="compliance-documents-repository">Compliance Documents (Repository)<a class="headerlink" href="#compliance-documents-repository" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><code>docs/compliance/incident-response.md</code> - Security incident response procedures</li>
<li><code>docs/compliance/CONTROL_INVENTORY.md</code> - Security control traceability</li>
<li><code>docs/compliance/TRACEABILITY_MATRIX.md</code> - Requirement-to-control mapping</li>
</ul>
<hr />
<h2 id="document-metadata">Document Metadata<a class="headerlink" href="#document-metadata" title="Anchor link to this section">&para;</a></h2>
<p><strong>Effective Date</strong>: 2025-10-26
<strong>Review Cycle</strong>: Quarterly
<strong>Next Review</strong>: 2026-01-26
<strong>Document Owner</strong>: Security Team
<strong>Approvers</strong>: Architecture Team, Security Team
<strong>Classification</strong>: OFFICIAL</p>
<p><strong>Change History</strong>:
- 2025-10-26: Initial consolidated policy (v1.0) - Combined ADRs 002, 002a, 003, 004, 005, 006
- 2025-10-26: Added Policy 3 (ADR-002b) - Immutable Security Policy Metadata (v1.1)
- 2025-10-26: Added ADR-014 compliance mapping - Reproducibility bundles for audit (v1.2)</p>
<hr />
<p><strong>🔒 This policy is MANDATORY for all Elspeth deployments handling classified data.</strong></p>
<p>For questions or clarifications, consult the <a href="../adrs/">ADR Catalogue</a> or contact the Security Team.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../execution-flow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Execution Flow">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Execution Flow
              </div>
            </div>
          </a>
        
        
          
          <a href="../adrs/" class="md-footer__link md-footer__link--next" aria-label="Next: ADR Catalogue">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ADR Catalogue
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Elspeth Contributors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/johnm-dta/elspeth" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/johnm-dta/elspeth/issues" target="_blank" rel="noopener" title="Report an Issue" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 96c0-53 43-96 96-96s96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H220.5c-15.7 0-28.4-12.7-28.4-28.4V96zm345.6 12.8c10.6 14.1 7.7 34.2-6.4 44.8l-97.8 73.3c5.3 8.9 9.3 18.7 11.8 29.1H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-96v32c0 2.6-.1 5.3-.2 7.9l83.4 62.5c14.1 10.6 17 30.7 6.4 44.8s-30.7 17-44.8 6.4l-63.1-47.3c-23.2 44.2-66.5 76.2-117.7 83.9V280c0-13.3-10.7-24-24-24s-24 10.7-24 24v230.2c-51.2-7.7-94.5-39.7-117.7-83.9l-63.1 47.3c-14.1 10.6-34.2 7.7-44.8-6.4s-7.7-34.2 6.4-44.8l83.4-62.5c-.1-2.6-.2-5.2-.2-7.9v-32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h98.8c2.5-10.4 6.5-20.2 11.8-29.1l-97.8-73.3c-14.1-10.6-17-30.7-6.4-44.8s30.7-17 44.8-6.4L192 184c12.3-5.1 25.8-8 40-8h112c14.2 0 27.7 2.8 40 8l108.8-81.6c14.1-10.6 34.2-7.7 44.8 6.4"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.path", "navigation.indexes", "navigation.footer", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>